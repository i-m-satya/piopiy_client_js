var PIOPIY = function ( e ) { var t = {}; function n ( r ) { if ( t[r] ) return t[r].exports; var i = t[r] = { i: r, l: !1, exports: {} }; return e[r].call( i.exports, i, i.exports, n ), i.l = !0, i.exports } return n.m = e, n.c = t, n.d = function ( e, t, r ) { n.o( e, t ) || Object.defineProperty( e, t, { enumerable: !0, get: r } ) }, n.r = function ( e ) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty( e, Symbol.toStringTag, { value: "Module" } ), Object.defineProperty( e, "__esModule", { value: !0 } ) }, n.t = function ( e, t ) { if ( 1 & t && ( e = n( e ) ), 8 & t ) return e; if ( 4 & t && "object" == typeof e && e && e.__esModule ) return e; var r = Object.create( null ); if ( n.r( r ), Object.defineProperty( r, "default", { enumerable: !0, value: e } ), 2 & t && "string" != typeof e ) for ( var i in e ) n.d( r, i, function ( t ) { return e[t] }.bind( null, i ) ); return r }, n.n = function ( e ) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d( t, "a", t ), t }, n.o = function ( e, t ) { return Object.prototype.hasOwnProperty.call( e, t ) }, n.p = "", n( n.s = 27 ) }( [function ( e, t, n ) {
    ( function ( e, r ) {
        var i;

        ( function () { var o = "Expected a function", u = "__lodash_placeholder__", s = [["ary", 128], ["bind", 1], ["bindKey", 2], ["curry", 8], ["curryRight", 16], ["flip", 512], ["partial", 32], ["partialRight", 64], ["rearg", 256]], l = "[object Arguments]", a = "[object Array]", c = "[object Boolean]", f = "[object Date]", h = "[object Error]", d = "[object Function]", _ = "[object GeneratorFunction]", p = "[object Map]", v = "[object Number]", m = "[object Object]", g = "[object RegExp]", y = "[object Set]", b = "[object String]", T = "[object Symbol]", S = "[object WeakMap]", C = "[object ArrayBuffer]", E = "[object DataView]", A = "[object Float32Array]", w = "[object Float64Array]", R = "[object Int8Array]", I = "[object Int16Array]", O = "[object Int32Array]", k = "[object Uint8Array]", N = "[object Uint16Array]", x = "[object Uint32Array]", D = /\b__p \+= '';/g, P = /\b(__p \+=) '' \+/g, U = /(__e\(.*?\)|\b__t\)) \+\n'';/g, j = /&(?:amp|lt|gt|quot|#39);/g, M = /[&<>"']/g, q = RegExp( j.source ), L = RegExp( M.source ), F = /<%-([\s\S]+?)%>/g, H = /<%([\s\S]+?)%>/g, W = /<%=([\s\S]+?)%>/g, G = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, B = /^\w*$/, z = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, V = /[\\^$.*+?()[\]{}|]/g, $ = RegExp( V.source ), K = /^\s+|\s+$/g, Y = /^\s+/, J = /\s+$/, X = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, Q = /\{\n\/\* \[wrapped with (.+)\] \*/, Z = /,? & /, ee = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, te = /\\(\\)?/g, ne = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, re = /\w*$/, ie = /^[-+]0x[0-9a-f]+$/i, oe = /^0b[01]+$/i, ue = /^\[object .+?Constructor\]$/, se = /^0o[0-7]+$/i, le = /^(?:0|[1-9]\d*)$/, ae = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, ce = /($^)/, fe = /['\n\r\u2028\u2029\\]/g, he = "\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff", de = "\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", _e = "[\\ud800-\\udfff]", pe = "[" + de + "]", ve = "[" + he + "]", me = "\\d+", ge = "[\\u2700-\\u27bf]", ye = "[a-z\\xdf-\\xf6\\xf8-\\xff]", be = "[^\\ud800-\\udfff" + de + me + "\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]", Te = "\\ud83c[\\udffb-\\udfff]", Se = "[^\\ud800-\\udfff]", Ce = "(?:\\ud83c[\\udde6-\\uddff]){2}", Ee = "[\\ud800-\\udbff][\\udc00-\\udfff]", Ae = "[A-Z\\xc0-\\xd6\\xd8-\\xde]", we = "(?:" + ye + "|" + be + ")", Re = "(?:" + Ae + "|" + be + ")", Ie = "(?:" + ve + "|" + Te + ")" + "?", Oe = "[\\ufe0e\\ufe0f]?" + Ie + ( "(?:\\u200d(?:" + [Se, Ce, Ee].join( "|" ) + ")[\\ufe0e\\ufe0f]?" + Ie + ")*" ), ke = "(?:" + [ge, Ce, Ee].join( "|" ) + ")" + Oe, Ne = "(?:" + [Se + ve + "?", ve, Ce, Ee, _e].join( "|" ) + ")", xe = RegExp( "['’]", "g" ), De = RegExp( ve, "g" ), Pe = RegExp( Te + "(?=" + Te + ")|" + Ne + Oe, "g" ), Ue = RegExp( [Ae + "?" + ye + "+(?:['’](?:d|ll|m|re|s|t|ve))?(?=" + [pe, Ae, "$"].join( "|" ) + ")", Re + "+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=" + [pe, Ae + we, "$"].join( "|" ) + ")", Ae + "?" + we + "+(?:['’](?:d|ll|m|re|s|t|ve))?", Ae + "+(?:['’](?:D|LL|M|RE|S|T|VE))?", "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", me, ke].join( "|" ), "g" ), je = RegExp( "[\\u200d\\ud800-\\udfff" + he + "\\ufe0e\\ufe0f]" ), Me = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, qe = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"], Le = -1, Fe = {}; Fe[A] = Fe[w] = Fe[R] = Fe[I] = Fe[O] = Fe[k] = Fe["[object Uint8ClampedArray]"] = Fe[N] = Fe[x] = !0, Fe[l] = Fe[a] = Fe[C] = Fe[c] = Fe[E] = Fe[f] = Fe[h] = Fe[d] = Fe[p] = Fe[v] = Fe[m] = Fe[g] = Fe[y] = Fe[b] = Fe[S] = !1; var He = {}; He[l] = He[a] = He[C] = He[E] = He[c] = He[f] = He[A] = He[w] = He[R] = He[I] = He[O] = He[p] = He[v] = He[m] = He[g] = He[y] = He[b] = He[T] = He[k] = He["[object Uint8ClampedArray]"] = He[N] = He[x] = !0, He[h] = He[d] = He[S] = !1; var We = { "\\": "\\", "'": "'", "\n": "n", "\r": "r", "\u2028": "u2028", "\u2029": "u2029" }, Ge = parseFloat, Be = parseInt, ze = "object" == typeof e && e && e.Object === Object && e, Ve = "object" == typeof self && self && self.Object === Object && self, $e = ze || Ve || Function( "return this" )(), Ke = t && !t.nodeType && t, Ye = Ke && "object" == typeof r && r && !r.nodeType && r, Je = Ye && Ye.exports === Ke, Xe = Je && ze.process, Qe = function () { try { var e = Ye && Ye.require && Ye.require( "util" ).types; return e || Xe && Xe.binding && Xe.binding( "util" ) } catch ( e ) { } }(), Ze = Qe && Qe.isArrayBuffer, et = Qe && Qe.isDate, tt = Qe && Qe.isMap, nt = Qe && Qe.isRegExp, rt = Qe && Qe.isSet, it = Qe && Qe.isTypedArray; function ot ( e, t, n ) { switch ( n.length ) { case 0: return e.call( t ); case 1: return e.call( t, n[0] ); case 2: return e.call( t, n[0], n[1] ); case 3: return e.call( t, n[0], n[1], n[2] ) }return e.apply( t, n ) } function ut ( e, t, n, r ) { for ( var i = -1, o = null == e ? 0 : e.length; ++i < o; ) { var u = e[i]; t( r, u, n( u ), e ) } return r } function st ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r && !1 !== t( e[n], n, e ); ); return e } function lt ( e, t ) { for ( var n = null == e ? 0 : e.length; n-- && !1 !== t( e[n], n, e ); ); return e } function at ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r; )if ( !t( e[n], n, e ) ) return !1; return !0 } function ct ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length, i = 0, o = []; ++n < r; ) { var u = e[n]; t( u, n, e ) && ( o[i++] = u ) } return o } function ft ( e, t ) { return !!( null == e ? 0 : e.length ) && Tt( e, t, 0 ) > -1 } function ht ( e, t, n ) { for ( var r = -1, i = null == e ? 0 : e.length; ++r < i; )if ( n( t, e[r] ) ) return !0; return !1 } function dt ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length, i = Array( r ); ++n < r; )i[n] = t( e[n], n, e ); return i } function _t ( e, t ) { for ( var n = -1, r = t.length, i = e.length; ++n < r; )e[i + n] = t[n]; return e } function pt ( e, t, n, r ) { var i = -1, o = null == e ? 0 : e.length; for ( r && o && ( n = e[++i] ); ++i < o; )n = t( n, e[i], i, e ); return n } function vt ( e, t, n, r ) { var i = null == e ? 0 : e.length; for ( r && i && ( n = e[--i] ); i--; )n = t( n, e[i], i, e ); return n } function mt ( e, t ) { for ( var n = -1, r = null == e ? 0 : e.length; ++n < r; )if ( t( e[n], n, e ) ) return !0; return !1 } var gt = At( "length" ); function yt ( e, t, n ) { var r; return n( e, ( function ( e, n, i ) { if ( t( e, n, i ) ) return r = n, !1 } ) ), r } function bt ( e, t, n, r ) { for ( var i = e.length, o = n + ( r ? 1 : -1 ); r ? o-- : ++o < i; )if ( t( e[o], o, e ) ) return o; return -1 } function Tt ( e, t, n ) { return t == t ? function ( e, t, n ) { var r = n - 1, i = e.length; for ( ; ++r < i; )if ( e[r] === t ) return r; return -1 }( e, t, n ) : bt( e, Ct, n ) } function St ( e, t, n, r ) { for ( var i = n - 1, o = e.length; ++i < o; )if ( r( e[i], t ) ) return i; return -1 } function Ct ( e ) { return e != e } function Et ( e, t ) { var n = null == e ? 0 : e.length; return n ? It( e, t ) / n : NaN } function At ( e ) { return function ( t ) { return null == t ? void 0 : t[e] } } function wt ( e ) { return function ( t ) { return null == e ? void 0 : e[t] } } function Rt ( e, t, n, r, i ) { return i( e, ( function ( e, i, o ) { n = r ? ( r = !1, e ) : t( n, e, i, o ) } ) ), n } function It ( e, t ) { for ( var n, r = -1, i = e.length; ++r < i; ) { var o = t( e[r] ); void 0 !== o && ( n = void 0 === n ? o : n + o ) } return n } function Ot ( e, t ) { for ( var n = -1, r = Array( e ); ++n < e; )r[n] = t( n ); return r } function kt ( e ) { return function ( t ) { return e( t ) } } function Nt ( e, t ) { return dt( t, ( function ( t ) { return e[t] } ) ) } function xt ( e, t ) { return e.has( t ) } function Dt ( e, t ) { for ( var n = -1, r = e.length; ++n < r && Tt( t, e[n], 0 ) > -1; ); return n } function Pt ( e, t ) { for ( var n = e.length; n-- && Tt( t, e[n], 0 ) > -1; ); return n } function Ut ( e, t ) { for ( var n = e.length, r = 0; n--; )e[n] === t && ++r; return r } var jt = wt( { "À": "A", "Á": "A", "Â": "A", "Ã": "A", "Ä": "A", "Å": "A", "à": "a", "á": "a", "â": "a", "ã": "a", "ä": "a", "å": "a", "Ç": "C", "ç": "c", "Ð": "D", "ð": "d", "È": "E", "É": "E", "Ê": "E", "Ë": "E", "è": "e", "é": "e", "ê": "e", "ë": "e", "Ì": "I", "Í": "I", "Î": "I", "Ï": "I", "ì": "i", "í": "i", "î": "i", "ï": "i", "Ñ": "N", "ñ": "n", "Ò": "O", "Ó": "O", "Ô": "O", "Õ": "O", "Ö": "O", "Ø": "O", "ò": "o", "ó": "o", "ô": "o", "õ": "o", "ö": "o", "ø": "o", "Ù": "U", "Ú": "U", "Û": "U", "Ü": "U", "ù": "u", "ú": "u", "û": "u", "ü": "u", "Ý": "Y", "ý": "y", "ÿ": "y", "Æ": "Ae", "æ": "ae", "Þ": "Th", "þ": "th", "ß": "ss", "Ā": "A", "Ă": "A", "Ą": "A", "ā": "a", "ă": "a", "ą": "a", "Ć": "C", "Ĉ": "C", "Ċ": "C", "Č": "C", "ć": "c", "ĉ": "c", "ċ": "c", "č": "c", "Ď": "D", "Đ": "D", "ď": "d", "đ": "d", "Ē": "E", "Ĕ": "E", "Ė": "E", "Ę": "E", "Ě": "E", "ē": "e", "ĕ": "e", "ė": "e", "ę": "e", "ě": "e", "Ĝ": "G", "Ğ": "G", "Ġ": "G", "Ģ": "G", "ĝ": "g", "ğ": "g", "ġ": "g", "ģ": "g", "Ĥ": "H", "Ħ": "H", "ĥ": "h", "ħ": "h", "Ĩ": "I", "Ī": "I", "Ĭ": "I", "Į": "I", "İ": "I", "ĩ": "i", "ī": "i", "ĭ": "i", "į": "i", "ı": "i", "Ĵ": "J", "ĵ": "j", "Ķ": "K", "ķ": "k", "ĸ": "k", "Ĺ": "L", "Ļ": "L", "Ľ": "L", "Ŀ": "L", "Ł": "L", "ĺ": "l", "ļ": "l", "ľ": "l", "ŀ": "l", "ł": "l", "Ń": "N", "Ņ": "N", "Ň": "N", "Ŋ": "N", "ń": "n", "ņ": "n", "ň": "n", "ŋ": "n", "Ō": "O", "Ŏ": "O", "Ő": "O", "ō": "o", "ŏ": "o", "ő": "o", "Ŕ": "R", "Ŗ": "R", "Ř": "R", "ŕ": "r", "ŗ": "r", "ř": "r", "Ś": "S", "Ŝ": "S", "Ş": "S", "Š": "S", "ś": "s", "ŝ": "s", "ş": "s", "š": "s", "Ţ": "T", "Ť": "T", "Ŧ": "T", "ţ": "t", "ť": "t", "ŧ": "t", "Ũ": "U", "Ū": "U", "Ŭ": "U", "Ů": "U", "Ű": "U", "Ų": "U", "ũ": "u", "ū": "u", "ŭ": "u", "ů": "u", "ű": "u", "ų": "u", "Ŵ": "W", "ŵ": "w", "Ŷ": "Y", "ŷ": "y", "Ÿ": "Y", "Ź": "Z", "Ż": "Z", "Ž": "Z", "ź": "z", "ż": "z", "ž": "z", "Ĳ": "IJ", "ĳ": "ij", "Œ": "Oe", "œ": "oe", "ŉ": "'n", "ſ": "s" } ), Mt = wt( { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" } ); function qt ( e ) { return "\\" + We[e] } function Lt ( e ) { return je.test( e ) } function Ft ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e, r ) { n[++t] = [r, e] } ) ), n } function Ht ( e, t ) { return function ( n ) { return e( t( n ) ) } } function Wt ( e, t ) { for ( var n = -1, r = e.length, i = 0, o = []; ++n < r; ) { var s = e[n]; s !== t && s !== u || ( e[n] = u, o[i++] = n ) } return o } function Gt ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e ) { n[++t] = e } ) ), n } function Bt ( e ) { var t = -1, n = Array( e.size ); return e.forEach( ( function ( e ) { n[++t] = [e, e] } ) ), n } function zt ( e ) { return Lt( e ) ? function ( e ) { var t = Pe.lastIndex = 0; for ( ; Pe.test( e ); )++t; return t }( e ) : gt( e ) } function Vt ( e ) { return Lt( e ) ? function ( e ) { return e.match( Pe ) || [] }( e ) : function ( e ) { return e.split( "" ) }( e ) } var $t = wt( { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'" } ); var Kt = function e ( t ) { var n, r = ( t = null == t ? $e : Kt.defaults( $e.Object(), t, Kt.pick( $e, qe ) ) ).Array, i = t.Date, he = t.Error, de = t.Function, _e = t.Math, pe = t.Object, ve = t.RegExp, me = t.String, ge = t.TypeError, ye = r.prototype, be = de.prototype, Te = pe.prototype, Se = t["__core-js_shared__"], Ce = be.toString, Ee = Te.hasOwnProperty, Ae = 0, we = ( n = /[^.]+$/.exec( Se && Se.keys && Se.keys.IE_PROTO || "" ) ) ? "Symbol(src)_1." + n : "", Re = Te.toString, Ie = Ce.call( pe ), Oe = $e._, ke = ve( "^" + Ce.call( Ee ).replace( V, "\\$&" ).replace( /hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?" ) + "$" ), Ne = Je ? t.Buffer : void 0, Pe = t.Symbol, je = t.Uint8Array, We = Ne ? Ne.allocUnsafe : void 0, ze = Ht( pe.getPrototypeOf, pe ), Ve = pe.create, Ke = Te.propertyIsEnumerable, Ye = ye.splice, Xe = Pe ? Pe.isConcatSpreadable : void 0, Qe = Pe ? Pe.iterator : void 0, gt = Pe ? Pe.toStringTag : void 0, wt = function () { try { var e = Zi( pe, "defineProperty" ); return e( {}, "", {} ), e } catch ( e ) { } }(), Yt = t.clearTimeout !== $e.clearTimeout && t.clearTimeout, Jt = i && i.now !== $e.Date.now && i.now, Xt = t.setTimeout !== $e.setTimeout && t.setTimeout, Qt = _e.ceil, Zt = _e.floor, en = pe.getOwnPropertySymbols, tn = Ne ? Ne.isBuffer : void 0, nn = t.isFinite, rn = ye.join, on = Ht( pe.keys, pe ), un = _e.max, sn = _e.min, ln = i.now, an = t.parseInt, cn = _e.random, fn = ye.reverse, hn = Zi( t, "DataView" ), dn = Zi( t, "Map" ), _n = Zi( t, "Promise" ), pn = Zi( t, "Set" ), vn = Zi( t, "WeakMap" ), mn = Zi( pe, "create" ), gn = vn && new vn, yn = {}, bn = Ro( hn ), Tn = Ro( dn ), Sn = Ro( _n ), Cn = Ro( pn ), En = Ro( vn ), An = Pe ? Pe.prototype : void 0, wn = An ? An.valueOf : void 0, Rn = An ? An.toString : void 0; function In ( e ) { if ( Bu( e ) && !Du( e ) && !( e instanceof xn ) ) { if ( e instanceof Nn ) return e; if ( Ee.call( e, "__wrapped__" ) ) return Io( e ) } return new Nn( e ) } var On = function () { function e () { } return function ( t ) { if ( !Gu( t ) ) return {}; if ( Ve ) return Ve( t ); e.prototype = t; var n = new e; return e.prototype = void 0, n } }(); function kn () { } function Nn ( e, t ) { this.__wrapped__ = e, this.__actions__ = [], this.__chain__ = !!t, this.__index__ = 0, this.__values__ = void 0 } function xn ( e ) { this.__wrapped__ = e, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = !1, this.__iteratees__ = [], this.__takeCount__ = 4294967295, this.__views__ = [] } function Dn ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function Pn ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function Un ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.clear(); ++t < n; ) { var r = e[t]; this.set( r[0], r[1] ) } } function jn ( e ) { var t = -1, n = null == e ? 0 : e.length; for ( this.__data__ = new Un; ++t < n; )this.add( e[t] ) } function Mn ( e ) { var t = this.__data__ = new Pn( e ); this.size = t.size } function qn ( e, t ) { var n = Du( e ), r = !n && xu( e ), i = !n && !r && Mu( e ), o = !n && !r && !i && Qu( e ), u = n || r || i || o, s = u ? Ot( e.length, me ) : [], l = s.length; for ( var a in e ) !t && !Ee.call( e, a ) || u && ( "length" == a || i && ( "offset" == a || "parent" == a ) || o && ( "buffer" == a || "byteLength" == a || "byteOffset" == a ) || uo( a, l ) ) || s.push( a ); return s } function Ln ( e ) { var t = e.length; return t ? e[jr( 0, t - 1 )] : void 0 } function Fn ( e, t ) { return Eo( mi( e ), Yn( t, 0, e.length ) ) } function Hn ( e ) { return Eo( mi( e ) ) } function Wn ( e, t, n ) { ( void 0 === n || Ou( e[t], n ) ) && ( void 0 !== n || t in e ) || $n( e, t, n ) } function Gn ( e, t, n ) { var r = e[t]; Ee.call( e, t ) && Ou( r, n ) && ( void 0 !== n || t in e ) || $n( e, t, n ) } function Bn ( e, t ) { for ( var n = e.length; n--; )if ( Ou( e[n][0], t ) ) return n; return -1 } function zn ( e, t, n, r ) { return er( e, ( function ( e, i, o ) { t( r, e, n( e ), o ) } ) ), r } function Vn ( e, t ) { return e && gi( t, bs( t ), e ) } function $n ( e, t, n ) { "__proto__" == t && wt ? wt( e, t, { configurable: !0, enumerable: !0, value: n, writable: !0 } ) : e[t] = n } function Kn ( e, t ) { for ( var n = -1, i = t.length, o = r( i ), u = null == e; ++n < i; )o[n] = u ? void 0 : ps( e, t[n] ); return o } function Yn ( e, t, n ) { return e == e && ( void 0 !== n && ( e = e <= n ? e : n ), void 0 !== t && ( e = e >= t ? e : t ) ), e } function Jn ( e, t, n, r, i, o ) { var u, s = 1 & t, a = 2 & t, h = 4 & t; if ( n && ( u = i ? n( e, r, i, o ) : n( e ) ), void 0 !== u ) return u; if ( !Gu( e ) ) return e; var S = Du( e ); if ( S ) { if ( u = function ( e ) { var t = e.length, n = new e.constructor( t ); t && "string" == typeof e[0] && Ee.call( e, "index" ) && ( n.index = e.index, n.input = e.input ); return n }( e ), !s ) return mi( e, u ) } else { var D = no( e ), P = D == d || D == _; if ( Mu( e ) ) return fi( e, s ); if ( D == m || D == l || P && !i ) { if ( u = a || P ? {} : io( e ), !s ) return a ? function ( e, t ) { return gi( e, to( e ), t ) }( e, function ( e, t ) { return e && gi( t, Ts( t ), e ) }( u, e ) ) : function ( e, t ) { return gi( e, eo( e ), t ) }( e, Vn( u, e ) ) } else { if ( !He[D] ) return i ? e : {}; u = function ( e, t, n ) { var r = e.constructor; switch ( t ) { case C: return hi( e ); case c: case f: return new r( +e ); case E: return function ( e, t ) { var n = t ? hi( e.buffer ) : e.buffer; return new e.constructor( n, e.byteOffset, e.byteLength ) }( e, n ); case A: case w: case R: case I: case O: case k: case "[object Uint8ClampedArray]": case N: case x: return di( e, n ); case p: return new r; case v: case b: return new r( e ); case g: return function ( e ) { var t = new e.constructor( e.source, re.exec( e ) ); return t.lastIndex = e.lastIndex, t }( e ); case y: return new r; case T: return i = e, wn ? pe( wn.call( i ) ) : {} }var i }( e, D, s ) } } o || ( o = new Mn ); var U = o.get( e ); if ( U ) return U; o.set( e, u ), Yu( e ) ? e.forEach( ( function ( r ) { u.add( Jn( r, t, n, r, e, o ) ) } ) ) : zu( e ) && e.forEach( ( function ( r, i ) { u.set( i, Jn( r, t, n, i, e, o ) ) } ) ); var j = S ? void 0 : ( h ? a ? Vi : zi : a ? Ts : bs )( e ); return st( j || e, ( function ( r, i ) { j && ( r = e[i = r] ), Gn( u, i, Jn( r, t, n, i, e, o ) ) } ) ), u } function Xn ( e, t, n ) { var r = n.length; if ( null == e ) return !r; for ( e = pe( e ); r--; ) { var i = n[r], o = t[i], u = e[i]; if ( void 0 === u && !( i in e ) || !o( u ) ) return !1 } return !0 } function Qn ( e, t, n ) { if ( "function" != typeof e ) throw new ge( o ); return bo( ( function () { e.apply( void 0, n ) } ), t ) } function Zn ( e, t, n, r ) { var i = -1, o = ft, u = !0, s = e.length, l = [], a = t.length; if ( !s ) return l; n && ( t = dt( t, kt( n ) ) ), r ? ( o = ht, u = !1 ) : t.length >= 200 && ( o = xt, u = !1, t = new jn( t ) ); e: for ( ; ++i < s; ) { var c = e[i], f = null == n ? c : n( c ); if ( c = r || 0 !== c ? c : 0, u && f == f ) { for ( var h = a; h--; )if ( t[h] === f ) continue e; l.push( c ) } else o( t, f, r ) || l.push( c ) } return l } In.templateSettings = { escape: F, evaluate: H, interpolate: W, variable: "", imports: { _: In } }, In.prototype = kn.prototype, In.prototype.constructor = In, Nn.prototype = On( kn.prototype ), Nn.prototype.constructor = Nn, xn.prototype = On( kn.prototype ), xn.prototype.constructor = xn, Dn.prototype.clear = function () { this.__data__ = mn ? mn( null ) : {}, this.size = 0 }, Dn.prototype.delete = function ( e ) { var t = this.has( e ) && delete this.__data__[e]; return this.size -= t ? 1 : 0, t }, Dn.prototype.get = function ( e ) { var t = this.__data__; if ( mn ) { var n = t[e]; return "__lodash_hash_undefined__" === n ? void 0 : n } return Ee.call( t, e ) ? t[e] : void 0 }, Dn.prototype.has = function ( e ) { var t = this.__data__; return mn ? void 0 !== t[e] : Ee.call( t, e ) }, Dn.prototype.set = function ( e, t ) { var n = this.__data__; return this.size += this.has( e ) ? 0 : 1, n[e] = mn && void 0 === t ? "__lodash_hash_undefined__" : t, this }, Pn.prototype.clear = function () { this.__data__ = [], this.size = 0 }, Pn.prototype.delete = function ( e ) { var t = this.__data__, n = Bn( t, e ); return !( n < 0 ) && ( n == t.length - 1 ? t.pop() : Ye.call( t, n, 1 ), --this.size, !0 ) }, Pn.prototype.get = function ( e ) { var t = this.__data__, n = Bn( t, e ); return n < 0 ? void 0 : t[n][1] }, Pn.prototype.has = function ( e ) { return Bn( this.__data__, e ) > -1 }, Pn.prototype.set = function ( e, t ) { var n = this.__data__, r = Bn( n, e ); return r < 0 ? ( ++this.size, n.push( [e, t] ) ) : n[r][1] = t, this }, Un.prototype.clear = function () { this.size = 0, this.__data__ = { hash: new Dn, map: new ( dn || Pn ), string: new Dn } }, Un.prototype.delete = function ( e ) { var t = Xi( this, e ).delete( e ); return this.size -= t ? 1 : 0, t }, Un.prototype.get = function ( e ) { return Xi( this, e ).get( e ) }, Un.prototype.has = function ( e ) { return Xi( this, e ).has( e ) }, Un.prototype.set = function ( e, t ) { var n = Xi( this, e ), r = n.size; return n.set( e, t ), this.size += n.size == r ? 0 : 1, this }, jn.prototype.add = jn.prototype.push = function ( e ) { return this.__data__.set( e, "__lodash_hash_undefined__" ), this }, jn.prototype.has = function ( e ) { return this.__data__.has( e ) }, Mn.prototype.clear = function () { this.__data__ = new Pn, this.size = 0 }, Mn.prototype.delete = function ( e ) { var t = this.__data__, n = t.delete( e ); return this.size = t.size, n }, Mn.prototype.get = function ( e ) { return this.__data__.get( e ) }, Mn.prototype.has = function ( e ) { return this.__data__.has( e ) }, Mn.prototype.set = function ( e, t ) { var n = this.__data__; if ( n instanceof Pn ) { var r = n.__data__; if ( !dn || r.length < 199 ) return r.push( [e, t] ), this.size = ++n.size, this; n = this.__data__ = new Un( r ) } return n.set( e, t ), this.size = n.size, this }; var er = Ti( lr ), tr = Ti( ar, !0 ); function nr ( e, t ) { var n = !0; return er( e, ( function ( e, r, i ) { return n = !!t( e, r, i ) } ) ), n } function rr ( e, t, n ) { for ( var r = -1, i = e.length; ++r < i; ) { var o = e[r], u = t( o ); if ( null != u && ( void 0 === s ? u == u && !Xu( u ) : n( u, s ) ) ) var s = u, l = o } return l } function ir ( e, t ) { var n = []; return er( e, ( function ( e, r, i ) { t( e, r, i ) && n.push( e ) } ) ), n } function or ( e, t, n, r, i ) { var o = -1, u = e.length; for ( n || ( n = oo ), i || ( i = [] ); ++o < u; ) { var s = e[o]; t > 0 && n( s ) ? t > 1 ? or( s, t - 1, n, r, i ) : _t( i, s ) : r || ( i[i.length] = s ) } return i } var ur = Si(), sr = Si( !0 ); function lr ( e, t ) { return e && ur( e, t, bs ) } function ar ( e, t ) { return e && sr( e, t, bs ) } function cr ( e, t ) { return ct( t, ( function ( t ) { return Fu( e[t] ) } ) ) } function fr ( e, t ) { for ( var n = 0, r = ( t = si( t, e ) ).length; null != e && n < r; )e = e[wo( t[n++] )]; return n && n == r ? e : void 0 } function hr ( e, t, n ) { var r = t( e ); return Du( e ) ? r : _t( r, n( e ) ) } function dr ( e ) { return null == e ? void 0 === e ? "[object Undefined]" : "[object Null]" : gt && gt in pe( e ) ? function ( e ) { var t = Ee.call( e, gt ), n = e[gt]; try { e[gt] = void 0; var r = !0 } catch ( e ) { } var i = Re.call( e ); r && ( t ? e[gt] = n : delete e[gt] ); return i }( e ) : function ( e ) { return Re.call( e ) }( e ) } function _r ( e, t ) { return e > t } function pr ( e, t ) { return null != e && Ee.call( e, t ) } function vr ( e, t ) { return null != e && t in pe( e ) } function mr ( e, t, n ) { for ( var i = n ? ht : ft, o = e[0].length, u = e.length, s = u, l = r( u ), a = 1 / 0, c = []; s--; ) { var f = e[s]; s && t && ( f = dt( f, kt( t ) ) ), a = sn( f.length, a ), l[s] = !n && ( t || o >= 120 && f.length >= 120 ) ? new jn( s && f ) : void 0 } f = e[0]; var h = -1, d = l[0]; e: for ( ; ++h < o && c.length < a; ) { var _ = f[h], p = t ? t( _ ) : _; if ( _ = n || 0 !== _ ? _ : 0, !( d ? xt( d, p ) : i( c, p, n ) ) ) { for ( s = u; --s; ) { var v = l[s]; if ( !( v ? xt( v, p ) : i( e[s], p, n ) ) ) continue e } d && d.push( p ), c.push( _ ) } } return c } function gr ( e, t, n ) { var r = null == ( e = vo( e, t = si( t, e ) ) ) ? e : e[wo( Lo( t ) )]; return null == r ? void 0 : ot( r, e, n ) } function yr ( e ) { return Bu( e ) && dr( e ) == l } function br ( e, t, n, r, i ) { return e === t || ( null == e || null == t || !Bu( e ) && !Bu( t ) ? e != e && t != t : function ( e, t, n, r, i, o ) { var u = Du( e ), s = Du( t ), d = u ? a : no( e ), _ = s ? a : no( t ), S = ( d = d == l ? m : d ) == m, A = ( _ = _ == l ? m : _ ) == m, w = d == _; if ( w && Mu( e ) ) { if ( !Mu( t ) ) return !1; u = !0, S = !1 } if ( w && !S ) return o || ( o = new Mn ), u || Qu( e ) ? Gi( e, t, n, r, i, o ) : function ( e, t, n, r, i, o, u ) { switch ( n ) { case E: if ( e.byteLength != t.byteLength || e.byteOffset != t.byteOffset ) return !1; e = e.buffer, t = t.buffer; case C: return !( e.byteLength != t.byteLength || !o( new je( e ), new je( t ) ) ); case c: case f: case v: return Ou( +e, +t ); case h: return e.name == t.name && e.message == t.message; case g: case b: return e == t + ""; case p: var s = Ft; case y: var l = 1 & r; if ( s || ( s = Gt ), e.size != t.size && !l ) return !1; var a = u.get( e ); if ( a ) return a == t; r |= 2, u.set( e, t ); var d = Gi( s( e ), s( t ), r, i, o, u ); return u.delete( e ), d; case T: if ( wn ) return wn.call( e ) == wn.call( t ) }return !1 }( e, t, d, n, r, i, o ); if ( !( 1 & n ) ) { var R = S && Ee.call( e, "__wrapped__" ), I = A && Ee.call( t, "__wrapped__" ); if ( R || I ) { var O = R ? e.value() : e, k = I ? t.value() : t; return o || ( o = new Mn ), i( O, k, n, r, o ) } } if ( !w ) return !1; return o || ( o = new Mn ), function ( e, t, n, r, i, o ) { var u = 1 & n, s = zi( e ), l = s.length, a = zi( t ).length; if ( l != a && !u ) return !1; var c = l; for ( ; c--; ) { var f = s[c]; if ( !( u ? f in t : Ee.call( t, f ) ) ) return !1 } var h = o.get( e ); if ( h && o.get( t ) ) return h == t; var d = !0; o.set( e, t ), o.set( t, e ); var _ = u; for ( ; ++c < l; ) { f = s[c]; var p = e[f], v = t[f]; if ( r ) var m = u ? r( v, p, f, t, e, o ) : r( p, v, f, e, t, o ); if ( !( void 0 === m ? p === v || i( p, v, n, r, o ) : m ) ) { d = !1; break } _ || ( _ = "constructor" == f ) } if ( d && !_ ) { var g = e.constructor, y = t.constructor; g != y && "constructor" in e && "constructor" in t && !( "function" == typeof g && g instanceof g && "function" == typeof y && y instanceof y ) && ( d = !1 ) } return o.delete( e ), o.delete( t ), d }( e, t, n, r, i, o ) }( e, t, n, r, br, i ) ) } function Tr ( e, t, n, r ) { var i = n.length, o = i, u = !r; if ( null == e ) return !o; for ( e = pe( e ); i--; ) { var s = n[i]; if ( u && s[2] ? s[1] !== e[s[0]] : !( s[0] in e ) ) return !1 } for ( ; ++i < o; ) { var l = ( s = n[i] )[0], a = e[l], c = s[1]; if ( u && s[2] ) { if ( void 0 === a && !( l in e ) ) return !1 } else { var f = new Mn; if ( r ) var h = r( a, c, l, e, t, f ); if ( !( void 0 === h ? br( c, a, 3, r, f ) : h ) ) return !1 } } return !0 } function Sr ( e ) { return !( !Gu( e ) || ( t = e, we && we in t ) ) && ( Fu( e ) ? ke : ue ).test( Ro( e ) ); var t } function Cr ( e ) { return "function" == typeof e ? e : null == e ? Vs : "object" == typeof e ? Du( e ) ? Or( e[0], e[1] ) : Ir( e ) : tl( e ) } function Er ( e ) { if ( !fo( e ) ) return on( e ); var t = []; for ( var n in pe( e ) ) Ee.call( e, n ) && "constructor" != n && t.push( n ); return t } function Ar ( e ) { if ( !Gu( e ) ) return function ( e ) { var t = []; if ( null != e ) for ( var n in pe( e ) ) t.push( n ); return t }( e ); var t = fo( e ), n = []; for ( var r in e ) ( "constructor" != r || !t && Ee.call( e, r ) ) && n.push( r ); return n } function wr ( e, t ) { return e < t } function Rr ( e, t ) { var n = -1, i = Uu( e ) ? r( e.length ) : []; return er( e, ( function ( e, r, o ) { i[++n] = t( e, r, o ) } ) ), i } function Ir ( e ) { var t = Qi( e ); return 1 == t.length && t[0][2] ? _o( t[0][0], t[0][1] ) : function ( n ) { return n === e || Tr( n, e, t ) } } function Or ( e, t ) { return lo( e ) && ho( t ) ? _o( wo( e ), t ) : function ( n ) { var r = ps( n, e ); return void 0 === r && r === t ? vs( n, e ) : br( t, r, 3 ) } } function kr ( e, t, n, r, i ) { e !== t && ur( t, ( function ( o, u ) { if ( i || ( i = new Mn ), Gu( o ) ) !function ( e, t, n, r, i, o, u ) { var s = go( e, n ), l = go( t, n ), a = u.get( l ); if ( a ) return void Wn( e, n, a ); var c = o ? o( s, l, n + "", e, t, u ) : void 0, f = void 0 === c; if ( f ) { var h = Du( l ), d = !h && Mu( l ), _ = !h && !d && Qu( l ); c = l, h || d || _ ? Du( s ) ? c = s : ju( s ) ? c = mi( s ) : d ? ( f = !1, c = fi( l, !0 ) ) : _ ? ( f = !1, c = di( l, !0 ) ) : c = [] : $u( l ) || xu( l ) ? ( c = s, xu( s ) ? c = us( s ) : Gu( s ) && !Fu( s ) || ( c = io( l ) ) ) : f = !1 } f && ( u.set( l, c ), i( c, l, r, o, u ), u.delete( l ) ); Wn( e, n, c ) }( e, t, u, n, kr, r, i ); else { var s = r ? r( go( e, u ), o, u + "", e, t, i ) : void 0; void 0 === s && ( s = o ), Wn( e, u, s ) } } ), Ts ) } function Nr ( e, t ) { var n = e.length; if ( n ) return uo( t += t < 0 ? n : 0, n ) ? e[t] : void 0 } function xr ( e, t, n ) { var r = -1; return t = dt( t.length ? t : [Vs], kt( Ji() ) ), function ( e, t ) { var n = e.length; for ( e.sort( t ); n--; )e[n] = e[n].value; return e }( Rr( e, ( function ( e, n, i ) { return { criteria: dt( t, ( function ( t ) { return t( e ) } ) ), index: ++r, value: e } } ) ), ( function ( e, t ) { return function ( e, t, n ) { var r = -1, i = e.criteria, o = t.criteria, u = i.length, s = n.length; for ( ; ++r < u; ) { var l = _i( i[r], o[r] ); if ( l ) { if ( r >= s ) return l; var a = n[r]; return l * ( "desc" == a ? -1 : 1 ) } } return e.index - t.index }( e, t, n ) } ) ) } function Dr ( e, t, n ) { for ( var r = -1, i = t.length, o = {}; ++r < i; ) { var u = t[r], s = fr( e, u ); n( s, u ) && Hr( o, si( u, e ), s ) } return o } function Pr ( e, t, n, r ) { var i = r ? St : Tt, o = -1, u = t.length, s = e; for ( e === t && ( t = mi( t ) ), n && ( s = dt( e, kt( n ) ) ); ++o < u; )for ( var l = 0, a = t[o], c = n ? n( a ) : a; ( l = i( s, c, l, r ) ) > -1; )s !== e && Ye.call( s, l, 1 ), Ye.call( e, l, 1 ); return e } function Ur ( e, t ) { for ( var n = e ? t.length : 0, r = n - 1; n--; ) { var i = t[n]; if ( n == r || i !== o ) { var o = i; uo( i ) ? Ye.call( e, i, 1 ) : Zr( e, i ) } } return e } function jr ( e, t ) { return e + Zt( cn() * ( t - e + 1 ) ) } function Mr ( e, t ) { var n = ""; if ( !e || t < 1 || t > 9007199254740991 ) return n; do { t % 2 && ( n += e ), ( t = Zt( t / 2 ) ) && ( e += e ) } while ( t ); return n } function qr ( e, t ) { return To( po( e, t, Vs ), e + "" ) } function Lr ( e ) { return Ln( Os( e ) ) } function Fr ( e, t ) { var n = Os( e ); return Eo( n, Yn( t, 0, n.length ) ) } function Hr ( e, t, n, r ) { if ( !Gu( e ) ) return e; for ( var i = -1, o = ( t = si( t, e ) ).length, u = o - 1, s = e; null != s && ++i < o; ) { var l = wo( t[i] ), a = n; if ( i != u ) { var c = s[l]; void 0 === ( a = r ? r( c, l, s ) : void 0 ) && ( a = Gu( c ) ? c : uo( t[i + 1] ) ? [] : {} ) } Gn( s, l, a ), s = s[l] } return e } var Wr = gn ? function ( e, t ) { return gn.set( e, t ), e } : Vs, Gr = wt ? function ( e, t ) { return wt( e, "toString", { configurable: !0, enumerable: !1, value: Gs( t ), writable: !0 } ) } : Vs; function Br ( e ) { return Eo( Os( e ) ) } function zr ( e, t, n ) { var i = -1, o = e.length; t < 0 && ( t = -t > o ? 0 : o + t ), ( n = n > o ? o : n ) < 0 && ( n += o ), o = t > n ? 0 : n - t >>> 0, t >>>= 0; for ( var u = r( o ); ++i < o; )u[i] = e[i + t]; return u } function Vr ( e, t ) { var n; return er( e, ( function ( e, r, i ) { return !( n = t( e, r, i ) ) } ) ), !!n } function $r ( e, t, n ) { var r = 0, i = null == e ? r : e.length; if ( "number" == typeof t && t == t && i <= 2147483647 ) { for ( ; r < i; ) { var o = r + i >>> 1, u = e[o]; null !== u && !Xu( u ) && ( n ? u <= t : u < t ) ? r = o + 1 : i = o } return i } return Kr( e, t, Vs, n ) } function Kr ( e, t, n, r ) { t = n( t ); for ( var i = 0, o = null == e ? 0 : e.length, u = t != t, s = null === t, l = Xu( t ), a = void 0 === t; i < o; ) { var c = Zt( ( i + o ) / 2 ), f = n( e[c] ), h = void 0 !== f, d = null === f, _ = f == f, p = Xu( f ); if ( u ) var v = r || _; else v = a ? _ && ( r || h ) : s ? _ && h && ( r || !d ) : l ? _ && h && !d && ( r || !p ) : !d && !p && ( r ? f <= t : f < t ); v ? i = c + 1 : o = c } return sn( o, 4294967294 ) } function Yr ( e, t ) { for ( var n = -1, r = e.length, i = 0, o = []; ++n < r; ) { var u = e[n], s = t ? t( u ) : u; if ( !n || !Ou( s, l ) ) { var l = s; o[i++] = 0 === u ? 0 : u } } return o } function Jr ( e ) { return "number" == typeof e ? e : Xu( e ) ? NaN : +e } function Xr ( e ) { if ( "string" == typeof e ) return e; if ( Du( e ) ) return dt( e, Xr ) + ""; if ( Xu( e ) ) return Rn ? Rn.call( e ) : ""; var t = e + ""; return "0" == t && 1 / e == -1 / 0 ? "-0" : t } function Qr ( e, t, n ) { var r = -1, i = ft, o = e.length, u = !0, s = [], l = s; if ( n ) u = !1, i = ht; else if ( o >= 200 ) { var a = t ? null : Mi( e ); if ( a ) return Gt( a ); u = !1, i = xt, l = new jn } else l = t ? [] : s; e: for ( ; ++r < o; ) { var c = e[r], f = t ? t( c ) : c; if ( c = n || 0 !== c ? c : 0, u && f == f ) { for ( var h = l.length; h--; )if ( l[h] === f ) continue e; t && l.push( f ), s.push( c ) } else i( l, f, n ) || ( l !== s && l.push( f ), s.push( c ) ) } return s } function Zr ( e, t ) { return null == ( e = vo( e, t = si( t, e ) ) ) || delete e[wo( Lo( t ) )] } function ei ( e, t, n, r ) { return Hr( e, t, n( fr( e, t ) ), r ) } function ti ( e, t, n, r ) { for ( var i = e.length, o = r ? i : -1; ( r ? o-- : ++o < i ) && t( e[o], o, e ); ); return n ? zr( e, r ? 0 : o, r ? o + 1 : i ) : zr( e, r ? o + 1 : 0, r ? i : o ) } function ni ( e, t ) { var n = e; return n instanceof xn && ( n = n.value() ), pt( t, ( function ( e, t ) { return t.func.apply( t.thisArg, _t( [e], t.args ) ) } ), n ) } function ri ( e, t, n ) { var i = e.length; if ( i < 2 ) return i ? Qr( e[0] ) : []; for ( var o = -1, u = r( i ); ++o < i; )for ( var s = e[o], l = -1; ++l < i; )l != o && ( u[o] = Zn( u[o] || s, e[l], t, n ) ); return Qr( or( u, 1 ), t, n ) } function ii ( e, t, n ) { for ( var r = -1, i = e.length, o = t.length, u = {}; ++r < i; ) { var s = r < o ? t[r] : void 0; n( u, e[r], s ) } return u } function oi ( e ) { return ju( e ) ? e : [] } function ui ( e ) { return "function" == typeof e ? e : Vs } function si ( e, t ) { return Du( e ) ? e : lo( e, t ) ? [e] : Ao( ss( e ) ) } var li = qr; function ai ( e, t, n ) { var r = e.length; return n = void 0 === n ? r : n, !t && n >= r ? e : zr( e, t, n ) } var ci = Yt || function ( e ) { return $e.clearTimeout( e ) }; function fi ( e, t ) { if ( t ) return e.slice(); var n = e.length, r = We ? We( n ) : new e.constructor( n ); return e.copy( r ), r } function hi ( e ) { var t = new e.constructor( e.byteLength ); return new je( t ).set( new je( e ) ), t } function di ( e, t ) { var n = t ? hi( e.buffer ) : e.buffer; return new e.constructor( n, e.byteOffset, e.length ) } function _i ( e, t ) { if ( e !== t ) { var n = void 0 !== e, r = null === e, i = e == e, o = Xu( e ), u = void 0 !== t, s = null === t, l = t == t, a = Xu( t ); if ( !s && !a && !o && e > t || o && u && l && !s && !a || r && u && l || !n && l || !i ) return 1; if ( !r && !o && !a && e < t || a && n && i && !r && !o || s && n && i || !u && i || !l ) return -1 } return 0 } function pi ( e, t, n, i ) { for ( var o = -1, u = e.length, s = n.length, l = -1, a = t.length, c = un( u - s, 0 ), f = r( a + c ), h = !i; ++l < a; )f[l] = t[l]; for ( ; ++o < s; )( h || o < u ) && ( f[n[o]] = e[o] ); for ( ; c--; )f[l++] = e[o++]; return f } function vi ( e, t, n, i ) { for ( var o = -1, u = e.length, s = -1, l = n.length, a = -1, c = t.length, f = un( u - l, 0 ), h = r( f + c ), d = !i; ++o < f; )h[o] = e[o]; for ( var _ = o; ++a < c; )h[_ + a] = t[a]; for ( ; ++s < l; )( d || o < u ) && ( h[_ + n[s]] = e[o++] ); return h } function mi ( e, t ) { var n = -1, i = e.length; for ( t || ( t = r( i ) ); ++n < i; )t[n] = e[n]; return t } function gi ( e, t, n, r ) { var i = !n; n || ( n = {} ); for ( var o = -1, u = t.length; ++o < u; ) { var s = t[o], l = r ? r( n[s], e[s], s, n, e ) : void 0; void 0 === l && ( l = e[s] ), i ? $n( n, s, l ) : Gn( n, s, l ) } return n } function yi ( e, t ) { return function ( n, r ) { var i = Du( n ) ? ut : zn, o = t ? t() : {}; return i( n, e, Ji( r, 2 ), o ) } } function bi ( e ) { return qr( ( function ( t, n ) { var r = -1, i = n.length, o = i > 1 ? n[i - 1] : void 0, u = i > 2 ? n[2] : void 0; for ( o = e.length > 3 && "function" == typeof o ? ( i--, o ) : void 0, u && so( n[0], n[1], u ) && ( o = i < 3 ? void 0 : o, i = 1 ), t = pe( t ); ++r < i; ) { var s = n[r]; s && e( t, s, r, o ) } return t } ) ) } function Ti ( e, t ) { return function ( n, r ) { if ( null == n ) return n; if ( !Uu( n ) ) return e( n, r ); for ( var i = n.length, o = t ? i : -1, u = pe( n ); ( t ? o-- : ++o < i ) && !1 !== r( u[o], o, u ); ); return n } } function Si ( e ) { return function ( t, n, r ) { for ( var i = -1, o = pe( t ), u = r( t ), s = u.length; s--; ) { var l = u[e ? s : ++i]; if ( !1 === n( o[l], l, o ) ) break } return t } } function Ci ( e ) { return function ( t ) { var n = Lt( t = ss( t ) ) ? Vt( t ) : void 0, r = n ? n[0] : t.charAt( 0 ), i = n ? ai( n, 1 ).join( "" ) : t.slice( 1 ); return r[e]() + i } } function Ei ( e ) { return function ( t ) { return pt( Fs( xs( t ).replace( xe, "" ) ), e, "" ) } } function Ai ( e ) { return function () { var t = arguments; switch ( t.length ) { case 0: return new e; case 1: return new e( t[0] ); case 2: return new e( t[0], t[1] ); case 3: return new e( t[0], t[1], t[2] ); case 4: return new e( t[0], t[1], t[2], t[3] ); case 5: return new e( t[0], t[1], t[2], t[3], t[4] ); case 6: return new e( t[0], t[1], t[2], t[3], t[4], t[5] ); case 7: return new e( t[0], t[1], t[2], t[3], t[4], t[5], t[6] ) }var n = On( e.prototype ), r = e.apply( n, t ); return Gu( r ) ? r : n } } function wi ( e ) { return function ( t, n, r ) { var i = pe( t ); if ( !Uu( t ) ) { var o = Ji( n, 3 ); t = bs( t ), n = function ( e ) { return o( i[e], e, i ) } } var u = e( t, n, r ); return u > -1 ? i[o ? t[u] : u] : void 0 } } function Ri ( e ) { return Bi( ( function ( t ) { var n = t.length, r = n, i = Nn.prototype.thru; for ( e && t.reverse(); r--; ) { var u = t[r]; if ( "function" != typeof u ) throw new ge( o ); if ( i && !s && "wrapper" == Ki( u ) ) var s = new Nn( [], !0 ) } for ( r = s ? r : n; ++r < n; ) { var l = Ki( u = t[r] ), a = "wrapper" == l ? $i( u ) : void 0; s = a && ao( a[0] ) && 424 == a[1] && !a[4].length && 1 == a[9] ? s[Ki( a[0] )].apply( s, a[3] ) : 1 == u.length && ao( u ) ? s[l]() : s.thru( u ) } return function () { var e = arguments, r = e[0]; if ( s && 1 == e.length && Du( r ) ) return s.plant( r ).value(); for ( var i = 0, o = n ? t[i].apply( this, e ) : r; ++i < n; )o = t[i].call( this, o ); return o } } ) ) } function Ii ( e, t, n, i, o, u, s, l, a, c ) { var f = 128 & t, h = 1 & t, d = 2 & t, _ = 24 & t, p = 512 & t, v = d ? void 0 : Ai( e ); return function m () { for ( var g = arguments.length, y = r( g ), b = g; b--; )y[b] = arguments[b]; if ( _ ) var T = Yi( m ), S = Ut( y, T ); if ( i && ( y = pi( y, i, o, _ ) ), u && ( y = vi( y, u, s, _ ) ), g -= S, _ && g < c ) { var C = Wt( y, T ); return Ui( e, t, Ii, m.placeholder, n, y, C, l, a, c - g ) } var E = h ? n : this, A = d ? E[e] : e; return g = y.length, l ? y = mo( y, l ) : p && g > 1 && y.reverse(), f && a < g && ( y.length = a ), this && this !== $e && this instanceof m && ( A = v || Ai( A ) ), A.apply( E, y ) } } function Oi ( e, t ) { return function ( n, r ) { return function ( e, t, n, r ) { return lr( e, ( function ( e, i, o ) { t( r, n( e ), i, o ) } ) ), r }( n, e, t( r ), {} ) } } function ki ( e, t ) { return function ( n, r ) { var i; if ( void 0 === n && void 0 === r ) return t; if ( void 0 !== n && ( i = n ), void 0 !== r ) { if ( void 0 === i ) return r; "string" == typeof n || "string" == typeof r ? ( n = Xr( n ), r = Xr( r ) ) : ( n = Jr( n ), r = Jr( r ) ), i = e( n, r ) } return i } } function Ni ( e ) { return Bi( ( function ( t ) { return t = dt( t, kt( Ji() ) ), qr( ( function ( n ) { var r = this; return e( t, ( function ( e ) { return ot( e, r, n ) } ) ) } ) ) } ) ) } function xi ( e, t ) { var n = ( t = void 0 === t ? " " : Xr( t ) ).length; if ( n < 2 ) return n ? Mr( t, e ) : t; var r = Mr( t, Qt( e / zt( t ) ) ); return Lt( t ) ? ai( Vt( r ), 0, e ).join( "" ) : r.slice( 0, e ) } function Di ( e ) { return function ( t, n, i ) { return i && "number" != typeof i && so( t, n, i ) && ( n = i = void 0 ), t = ns( t ), void 0 === n ? ( n = t, t = 0 ) : n = ns( n ), function ( e, t, n, i ) { for ( var o = -1, u = un( Qt( ( t - e ) / ( n || 1 ) ), 0 ), s = r( u ); u--; )s[i ? u : ++o] = e, e += n; return s }( t, n, i = void 0 === i ? t < n ? 1 : -1 : ns( i ), e ) } } function Pi ( e ) { return function ( t, n ) { return "string" == typeof t && "string" == typeof n || ( t = os( t ), n = os( n ) ), e( t, n ) } } function Ui ( e, t, n, r, i, o, u, s, l, a ) { var c = 8 & t; t |= c ? 32 : 64, 4 & ( t &= ~( c ? 64 : 32 ) ) || ( t &= -4 ); var f = [e, t, i, c ? o : void 0, c ? u : void 0, c ? void 0 : o, c ? void 0 : u, s, l, a], h = n.apply( void 0, f ); return ao( e ) && yo( h, f ), h.placeholder = r, So( h, e, t ) } function ji ( e ) { var t = _e[e]; return function ( e, n ) { if ( e = os( e ), ( n = null == n ? 0 : sn( rs( n ), 292 ) ) && nn( e ) ) { var r = ( ss( e ) + "e" ).split( "e" ); return +( ( r = ( ss( t( r[0] + "e" + ( +r[1] + n ) ) ) + "e" ).split( "e" ) )[0] + "e" + ( +r[1] - n ) ) } return t( e ) } } var Mi = pn && 1 / Gt( new pn( [, -0] ) )[1] == 1 / 0 ? function ( e ) { return new pn( e ) } : Xs; function qi ( e ) { return function ( t ) { var n = no( t ); return n == p ? Ft( t ) : n == y ? Bt( t ) : function ( e, t ) { return dt( t, ( function ( t ) { return [t, e[t]] } ) ) }( t, e( t ) ) } } function Li ( e, t, n, i, s, l, a, c ) { var f = 2 & t; if ( !f && "function" != typeof e ) throw new ge( o ); var h = i ? i.length : 0; if ( h || ( t &= -97, i = s = void 0 ), a = void 0 === a ? a : un( rs( a ), 0 ), c = void 0 === c ? c : rs( c ), h -= s ? s.length : 0, 64 & t ) { var d = i, _ = s; i = s = void 0 } var p = f ? void 0 : $i( e ), v = [e, t, n, i, s, d, _, l, a, c]; if ( p && function ( e, t ) { var n = e[1], r = t[1], i = n | r, o = i < 131, s = 128 == r && 8 == n || 128 == r && 256 == n && e[7].length <= t[8] || 384 == r && t[7].length <= t[8] && 8 == n; if ( !o && !s ) return e; 1 & r && ( e[2] = t[2], i |= 1 & n ? 0 : 4 ); var l = t[3]; if ( l ) { var a = e[3]; e[3] = a ? pi( a, l, t[4] ) : l, e[4] = a ? Wt( e[3], u ) : t[4] } ( l = t[5] ) && ( a = e[5], e[5] = a ? vi( a, l, t[6] ) : l, e[6] = a ? Wt( e[5], u ) : t[6] ); ( l = t[7] ) && ( e[7] = l ); 128 & r && ( e[8] = null == e[8] ? t[8] : sn( e[8], t[8] ) ); null == e[9] && ( e[9] = t[9] ); e[0] = t[0], e[1] = i }( v, p ), e = v[0], t = v[1], n = v[2], i = v[3], s = v[4], !( c = v[9] = void 0 === v[9] ? f ? 0 : e.length : un( v[9] - h, 0 ) ) && 24 & t && ( t &= -25 ), t && 1 != t ) m = 8 == t || 16 == t ? function ( e, t, n ) { var i = Ai( e ); return function o () { for ( var u = arguments.length, s = r( u ), l = u, a = Yi( o ); l--; )s[l] = arguments[l]; var c = u < 3 && s[0] !== a && s[u - 1] !== a ? [] : Wt( s, a ); if ( ( u -= c.length ) < n ) return Ui( e, t, Ii, o.placeholder, void 0, s, c, void 0, void 0, n - u ); var f = this && this !== $e && this instanceof o ? i : e; return ot( f, this, s ) } }( e, t, c ) : 32 != t && 33 != t || s.length ? Ii.apply( void 0, v ) : function ( e, t, n, i ) { var o = 1 & t, u = Ai( e ); return function t () { for ( var s = -1, l = arguments.length, a = -1, c = i.length, f = r( c + l ), h = this && this !== $e && this instanceof t ? u : e; ++a < c; )f[a] = i[a]; for ( ; l--; )f[a++] = arguments[++s]; return ot( h, o ? n : this, f ) } }( e, t, n, i ); else var m = function ( e, t, n ) { var r = 1 & t, i = Ai( e ); return function t () { var o = this && this !== $e && this instanceof t ? i : e; return o.apply( r ? n : this, arguments ) } }( e, t, n ); return So( ( p ? Wr : yo )( m, v ), e, t ) } function Fi ( e, t, n, r ) { return void 0 === e || Ou( e, Te[n] ) && !Ee.call( r, n ) ? t : e } function Hi ( e, t, n, r, i, o ) { return Gu( e ) && Gu( t ) && ( o.set( t, e ), kr( e, t, void 0, Hi, o ), o.delete( t ) ), e } function Wi ( e ) { return $u( e ) ? void 0 : e } function Gi ( e, t, n, r, i, o ) { var u = 1 & n, s = e.length, l = t.length; if ( s != l && !( u && l > s ) ) return !1; var a = o.get( e ); if ( a && o.get( t ) ) return a == t; var c = -1, f = !0, h = 2 & n ? new jn : void 0; for ( o.set( e, t ), o.set( t, e ); ++c < s; ) { var d = e[c], _ = t[c]; if ( r ) var p = u ? r( _, d, c, t, e, o ) : r( d, _, c, e, t, o ); if ( void 0 !== p ) { if ( p ) continue; f = !1; break } if ( h ) { if ( !mt( t, ( function ( e, t ) { if ( !xt( h, t ) && ( d === e || i( d, e, n, r, o ) ) ) return h.push( t ) } ) ) ) { f = !1; break } } else if ( d !== _ && !i( d, _, n, r, o ) ) { f = !1; break } } return o.delete( e ), o.delete( t ), f } function Bi ( e ) { return To( po( e, void 0, Po ), e + "" ) } function zi ( e ) { return hr( e, bs, eo ) } function Vi ( e ) { return hr( e, Ts, to ) } var $i = gn ? function ( e ) { return gn.get( e ) } : Xs; function Ki ( e ) { for ( var t = e.name + "", n = yn[t], r = Ee.call( yn, t ) ? n.length : 0; r--; ) { var i = n[r], o = i.func; if ( null == o || o == e ) return i.name } return t } function Yi ( e ) { return ( Ee.call( In, "placeholder" ) ? In : e ).placeholder } function Ji () { var e = In.iteratee || $s; return e = e === $s ? Cr : e, arguments.length ? e( arguments[0], arguments[1] ) : e } function Xi ( e, t ) { var n, r, i = e.__data__; return ( "string" == ( r = typeof ( n = t ) ) || "number" == r || "symbol" == r || "boolean" == r ? "__proto__" !== n : null === n ) ? i["string" == typeof t ? "string" : "hash"] : i.map } function Qi ( e ) { for ( var t = bs( e ), n = t.length; n--; ) { var r = t[n], i = e[r]; t[n] = [r, i, ho( i )] } return t } function Zi ( e, t ) { var n = function ( e, t ) { return null == e ? void 0 : e[t] }( e, t ); return Sr( n ) ? n : void 0 } var eo = en ? function ( e ) { return null == e ? [] : ( e = pe( e ), ct( en( e ), ( function ( t ) { return Ke.call( e, t ) } ) ) ) } : il, to = en ? function ( e ) { for ( var t = []; e; )_t( t, eo( e ) ), e = ze( e ); return t } : il, no = dr; function ro ( e, t, n ) { for ( var r = -1, i = ( t = si( t, e ) ).length, o = !1; ++r < i; ) { var u = wo( t[r] ); if ( !( o = null != e && n( e, u ) ) ) break; e = e[u] } return o || ++r != i ? o : !!( i = null == e ? 0 : e.length ) && Wu( i ) && uo( u, i ) && ( Du( e ) || xu( e ) ) } function io ( e ) { return "function" != typeof e.constructor || fo( e ) ? {} : On( ze( e ) ) } function oo ( e ) { return Du( e ) || xu( e ) || !!( Xe && e && e[Xe] ) } function uo ( e, t ) { var n = typeof e; return !!( t = null == t ? 9007199254740991 : t ) && ( "number" == n || "symbol" != n && le.test( e ) ) && e > -1 && e % 1 == 0 && e < t } function so ( e, t, n ) { if ( !Gu( n ) ) return !1; var r = typeof t; return !!( "number" == r ? Uu( n ) && uo( t, n.length ) : "string" == r && t in n ) && Ou( n[t], e ) } function lo ( e, t ) { if ( Du( e ) ) return !1; var n = typeof e; return !( "number" != n && "symbol" != n && "boolean" != n && null != e && !Xu( e ) ) || ( B.test( e ) || !G.test( e ) || null != t && e in pe( t ) ) } function ao ( e ) { var t = Ki( e ), n = In[t]; if ( "function" != typeof n || !( t in xn.prototype ) ) return !1; if ( e === n ) return !0; var r = $i( n ); return !!r && e === r[0] } ( hn && no( new hn( new ArrayBuffer( 1 ) ) ) != E || dn && no( new dn ) != p || _n && "[object Promise]" != no( _n.resolve() ) || pn && no( new pn ) != y || vn && no( new vn ) != S ) && ( no = function ( e ) { var t = dr( e ), n = t == m ? e.constructor : void 0, r = n ? Ro( n ) : ""; if ( r ) switch ( r ) { case bn: return E; case Tn: return p; case Sn: return "[object Promise]"; case Cn: return y; case En: return S }return t } ); var co = Se ? Fu : ol; function fo ( e ) { var t = e && e.constructor; return e === ( "function" == typeof t && t.prototype || Te ) } function ho ( e ) { return e == e && !Gu( e ) } function _o ( e, t ) { return function ( n ) { return null != n && ( n[e] === t && ( void 0 !== t || e in pe( n ) ) ) } } function po ( e, t, n ) { return t = un( void 0 === t ? e.length - 1 : t, 0 ), function () { for ( var i = arguments, o = -1, u = un( i.length - t, 0 ), s = r( u ); ++o < u; )s[o] = i[t + o]; o = -1; for ( var l = r( t + 1 ); ++o < t; )l[o] = i[o]; return l[t] = n( s ), ot( e, this, l ) } } function vo ( e, t ) { return t.length < 2 ? e : fr( e, zr( t, 0, -1 ) ) } function mo ( e, t ) { for ( var n = e.length, r = sn( t.length, n ), i = mi( e ); r--; ) { var o = t[r]; e[r] = uo( o, n ) ? i[o] : void 0 } return e } function go ( e, t ) { if ( ( "constructor" !== t || "function" != typeof e[t] ) && "__proto__" != t ) return e[t] } var yo = Co( Wr ), bo = Xt || function ( e, t ) { return $e.setTimeout( e, t ) }, To = Co( Gr ); function So ( e, t, n ) { var r = t + ""; return To( e, function ( e, t ) { var n = t.length; if ( !n ) return e; var r = n - 1; return t[r] = ( n > 1 ? "& " : "" ) + t[r], t = t.join( n > 2 ? ", " : " " ), e.replace( X, "{\n/* [wrapped with " + t + "] */\n" ) }( r, function ( e, t ) { return st( s, ( function ( n ) { var r = "_." + n[0]; t & n[1] && !ft( e, r ) && e.push( r ) } ) ), e.sort() }( function ( e ) { var t = e.match( Q ); return t ? t[1].split( Z ) : [] }( r ), n ) ) ) } function Co ( e ) { var t = 0, n = 0; return function () { var r = ln(), i = 16 - ( r - n ); if ( n = r, i > 0 ) { if ( ++t >= 800 ) return arguments[0] } else t = 0; return e.apply( void 0, arguments ) } } function Eo ( e, t ) { var n = -1, r = e.length, i = r - 1; for ( t = void 0 === t ? r : t; ++n < t; ) { var o = jr( n, i ), u = e[o]; e[o] = e[n], e[n] = u } return e.length = t, e } var Ao = function ( e ) { var t = Cu( e, ( function ( e ) { return 500 === n.size && n.clear(), e } ) ), n = t.cache; return t }( ( function ( e ) { var t = []; return 46 === e.charCodeAt( 0 ) && t.push( "" ), e.replace( z, ( function ( e, n, r, i ) { t.push( r ? i.replace( te, "$1" ) : n || e ) } ) ), t } ) ); function wo ( e ) { if ( "string" == typeof e || Xu( e ) ) return e; var t = e + ""; return "0" == t && 1 / e == -1 / 0 ? "-0" : t } function Ro ( e ) { if ( null != e ) { try { return Ce.call( e ) } catch ( e ) { } try { return e + "" } catch ( e ) { } } return "" } function Io ( e ) { if ( e instanceof xn ) return e.clone(); var t = new Nn( e.__wrapped__, e.__chain__ ); return t.__actions__ = mi( e.__actions__ ), t.__index__ = e.__index__, t.__values__ = e.__values__, t } var Oo = qr( ( function ( e, t ) { return ju( e ) ? Zn( e, or( t, 1, ju, !0 ) ) : [] } ) ), ko = qr( ( function ( e, t ) { var n = Lo( t ); return ju( n ) && ( n = void 0 ), ju( e ) ? Zn( e, or( t, 1, ju, !0 ), Ji( n, 2 ) ) : [] } ) ), No = qr( ( function ( e, t ) { var n = Lo( t ); return ju( n ) && ( n = void 0 ), ju( e ) ? Zn( e, or( t, 1, ju, !0 ), void 0, n ) : [] } ) ); function xo ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = null == n ? 0 : rs( n ); return i < 0 && ( i = un( r + i, 0 ) ), bt( e, Ji( t, 3 ), i ) } function Do ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = r - 1; return void 0 !== n && ( i = rs( n ), i = n < 0 ? un( r + i, 0 ) : sn( i, r - 1 ) ), bt( e, Ji( t, 3 ), i, !0 ) } function Po ( e ) { return ( null == e ? 0 : e.length ) ? or( e, 1 ) : [] } function Uo ( e ) { return e && e.length ? e[0] : void 0 } var jo = qr( ( function ( e ) { var t = dt( e, oi ); return t.length && t[0] === e[0] ? mr( t ) : [] } ) ), Mo = qr( ( function ( e ) { var t = Lo( e ), n = dt( e, oi ); return t === Lo( n ) ? t = void 0 : n.pop(), n.length && n[0] === e[0] ? mr( n, Ji( t, 2 ) ) : [] } ) ), qo = qr( ( function ( e ) { var t = Lo( e ), n = dt( e, oi ); return ( t = "function" == typeof t ? t : void 0 ) && n.pop(), n.length && n[0] === e[0] ? mr( n, void 0, t ) : [] } ) ); function Lo ( e ) { var t = null == e ? 0 : e.length; return t ? e[t - 1] : void 0 } var Fo = qr( Ho ); function Ho ( e, t ) { return e && e.length && t && t.length ? Pr( e, t ) : e } var Wo = Bi( ( function ( e, t ) { var n = null == e ? 0 : e.length, r = Kn( e, t ); return Ur( e, dt( t, ( function ( e ) { return uo( e, n ) ? +e : e } ) ).sort( _i ) ), r } ) ); function Go ( e ) { return null == e ? e : fn.call( e ) } var Bo = qr( ( function ( e ) { return Qr( or( e, 1, ju, !0 ) ) } ) ), zo = qr( ( function ( e ) { var t = Lo( e ); return ju( t ) && ( t = void 0 ), Qr( or( e, 1, ju, !0 ), Ji( t, 2 ) ) } ) ), Vo = qr( ( function ( e ) { var t = Lo( e ); return t = "function" == typeof t ? t : void 0, Qr( or( e, 1, ju, !0 ), void 0, t ) } ) ); function $o ( e ) { if ( !e || !e.length ) return []; var t = 0; return e = ct( e, ( function ( e ) { if ( ju( e ) ) return t = un( e.length, t ), !0 } ) ), Ot( t, ( function ( t ) { return dt( e, At( t ) ) } ) ) } function Ko ( e, t ) { if ( !e || !e.length ) return []; var n = $o( e ); return null == t ? n : dt( n, ( function ( e ) { return ot( t, void 0, e ) } ) ) } var Yo = qr( ( function ( e, t ) { return ju( e ) ? Zn( e, t ) : [] } ) ), Jo = qr( ( function ( e ) { return ri( ct( e, ju ) ) } ) ), Xo = qr( ( function ( e ) { var t = Lo( e ); return ju( t ) && ( t = void 0 ), ri( ct( e, ju ), Ji( t, 2 ) ) } ) ), Qo = qr( ( function ( e ) { var t = Lo( e ); return t = "function" == typeof t ? t : void 0, ri( ct( e, ju ), void 0, t ) } ) ), Zo = qr( $o ); var eu = qr( ( function ( e ) { var t = e.length, n = t > 1 ? e[t - 1] : void 0; return n = "function" == typeof n ? ( e.pop(), n ) : void 0, Ko( e, n ) } ) ); function tu ( e ) { var t = In( e ); return t.__chain__ = !0, t } function nu ( e, t ) { return t( e ) } var ru = Bi( ( function ( e ) { var t = e.length, n = t ? e[0] : 0, r = this.__wrapped__, i = function ( t ) { return Kn( t, e ) }; return !( t > 1 || this.__actions__.length ) && r instanceof xn && uo( n ) ? ( ( r = r.slice( n, +n + ( t ? 1 : 0 ) ) ).__actions__.push( { func: nu, args: [i], thisArg: void 0 } ), new Nn( r, this.__chain__ ).thru( ( function ( e ) { return t && !e.length && e.push( void 0 ), e } ) ) ) : this.thru( i ) } ) ); var iu = yi( ( function ( e, t, n ) { Ee.call( e, n ) ? ++e[n] : $n( e, n, 1 ) } ) ); var ou = wi( xo ), uu = wi( Do ); function su ( e, t ) { return ( Du( e ) ? st : er )( e, Ji( t, 3 ) ) } function lu ( e, t ) { return ( Du( e ) ? lt : tr )( e, Ji( t, 3 ) ) } var au = yi( ( function ( e, t, n ) { Ee.call( e, n ) ? e[n].push( t ) : $n( e, n, [t] ) } ) ); var cu = qr( ( function ( e, t, n ) { var i = -1, o = "function" == typeof t, u = Uu( e ) ? r( e.length ) : []; return er( e, ( function ( e ) { u[++i] = o ? ot( t, e, n ) : gr( e, t, n ) } ) ), u } ) ), fu = yi( ( function ( e, t, n ) { $n( e, n, t ) } ) ); function hu ( e, t ) { return ( Du( e ) ? dt : Rr )( e, Ji( t, 3 ) ) } var du = yi( ( function ( e, t, n ) { e[n ? 0 : 1].push( t ) } ), ( function () { return [[], []] } ) ); var _u = qr( ( function ( e, t ) { if ( null == e ) return []; var n = t.length; return n > 1 && so( e, t[0], t[1] ) ? t = [] : n > 2 && so( t[0], t[1], t[2] ) && ( t = [t[0]] ), xr( e, or( t, 1 ), [] ) } ) ), pu = Jt || function () { return $e.Date.now() }; function vu ( e, t, n ) { return t = n ? void 0 : t, Li( e, 128, void 0, void 0, void 0, void 0, t = e && null == t ? e.length : t ) } function mu ( e, t ) { var n; if ( "function" != typeof t ) throw new ge( o ); return e = rs( e ), function () { return --e > 0 && ( n = t.apply( this, arguments ) ), e <= 1 && ( t = void 0 ), n } } var gu = qr( ( function ( e, t, n ) { var r = 1; if ( n.length ) { var i = Wt( n, Yi( gu ) ); r |= 32 } return Li( e, r, t, n, i ) } ) ), yu = qr( ( function ( e, t, n ) { var r = 3; if ( n.length ) { var i = Wt( n, Yi( yu ) ); r |= 32 } return Li( t, r, e, n, i ) } ) ); function bu ( e, t, n ) { var r, i, u, s, l, a, c = 0, f = !1, h = !1, d = !0; if ( "function" != typeof e ) throw new ge( o ); function _ ( t ) { var n = r, o = i; return r = i = void 0, c = t, s = e.apply( o, n ) } function p ( e ) { return c = e, l = bo( m, t ), f ? _( e ) : s } function v ( e ) { var n = e - a; return void 0 === a || n >= t || n < 0 || h && e - c >= u } function m () { var e = pu(); if ( v( e ) ) return g( e ); l = bo( m, function ( e ) { var n = t - ( e - a ); return h ? sn( n, u - ( e - c ) ) : n }( e ) ) } function g ( e ) { return l = void 0, d && r ? _( e ) : ( r = i = void 0, s ) } function y () { var e = pu(), n = v( e ); if ( r = arguments, i = this, a = e, n ) { if ( void 0 === l ) return p( a ); if ( h ) return ci( l ), l = bo( m, t ), _( a ) } return void 0 === l && ( l = bo( m, t ) ), s } return t = os( t ) || 0, Gu( n ) && ( f = !!n.leading, u = ( h = "maxWait" in n ) ? un( os( n.maxWait ) || 0, t ) : u, d = "trailing" in n ? !!n.trailing : d ), y.cancel = function () { void 0 !== l && ci( l ), c = 0, r = a = i = l = void 0 }, y.flush = function () { return void 0 === l ? s : g( pu() ) }, y } var Tu = qr( ( function ( e, t ) { return Qn( e, 1, t ) } ) ), Su = qr( ( function ( e, t, n ) { return Qn( e, os( t ) || 0, n ) } ) ); function Cu ( e, t ) { if ( "function" != typeof e || null != t && "function" != typeof t ) throw new ge( o ); var n = function () { var r = arguments, i = t ? t.apply( this, r ) : r[0], o = n.cache; if ( o.has( i ) ) return o.get( i ); var u = e.apply( this, r ); return n.cache = o.set( i, u ) || o, u }; return n.cache = new ( Cu.Cache || Un ), n } function Eu ( e ) { if ( "function" != typeof e ) throw new ge( o ); return function () { var t = arguments; switch ( t.length ) { case 0: return !e.call( this ); case 1: return !e.call( this, t[0] ); case 2: return !e.call( this, t[0], t[1] ); case 3: return !e.call( this, t[0], t[1], t[2] ) }return !e.apply( this, t ) } } Cu.Cache = Un; var Au = li( ( function ( e, t ) { var n = ( t = 1 == t.length && Du( t[0] ) ? dt( t[0], kt( Ji() ) ) : dt( or( t, 1 ), kt( Ji() ) ) ).length; return qr( ( function ( r ) { for ( var i = -1, o = sn( r.length, n ); ++i < o; )r[i] = t[i].call( this, r[i] ); return ot( e, this, r ) } ) ) } ) ), wu = qr( ( function ( e, t ) { return Li( e, 32, void 0, t, Wt( t, Yi( wu ) ) ) } ) ), Ru = qr( ( function ( e, t ) { return Li( e, 64, void 0, t, Wt( t, Yi( Ru ) ) ) } ) ), Iu = Bi( ( function ( e, t ) { return Li( e, 256, void 0, void 0, void 0, t ) } ) ); function Ou ( e, t ) { return e === t || e != e && t != t } var ku = Pi( _r ), Nu = Pi( ( function ( e, t ) { return e >= t } ) ), xu = yr( function () { return arguments }() ) ? yr : function ( e ) { return Bu( e ) && Ee.call( e, "callee" ) && !Ke.call( e, "callee" ) }, Du = r.isArray, Pu = Ze ? kt( Ze ) : function ( e ) { return Bu( e ) && dr( e ) == C }; function Uu ( e ) { return null != e && Wu( e.length ) && !Fu( e ) } function ju ( e ) { return Bu( e ) && Uu( e ) } var Mu = tn || ol, qu = et ? kt( et ) : function ( e ) { return Bu( e ) && dr( e ) == f }; function Lu ( e ) { if ( !Bu( e ) ) return !1; var t = dr( e ); return t == h || "[object DOMException]" == t || "string" == typeof e.message && "string" == typeof e.name && !$u( e ) } function Fu ( e ) { if ( !Gu( e ) ) return !1; var t = dr( e ); return t == d || t == _ || "[object AsyncFunction]" == t || "[object Proxy]" == t } function Hu ( e ) { return "number" == typeof e && e == rs( e ) } function Wu ( e ) { return "number" == typeof e && e > -1 && e % 1 == 0 && e <= 9007199254740991 } function Gu ( e ) { var t = typeof e; return null != e && ( "object" == t || "function" == t ) } function Bu ( e ) { return null != e && "object" == typeof e } var zu = tt ? kt( tt ) : function ( e ) { return Bu( e ) && no( e ) == p }; function Vu ( e ) { return "number" == typeof e || Bu( e ) && dr( e ) == v } function $u ( e ) { if ( !Bu( e ) || dr( e ) != m ) return !1; var t = ze( e ); if ( null === t ) return !0; var n = Ee.call( t, "constructor" ) && t.constructor; return "function" == typeof n && n instanceof n && Ce.call( n ) == Ie } var Ku = nt ? kt( nt ) : function ( e ) { return Bu( e ) && dr( e ) == g }; var Yu = rt ? kt( rt ) : function ( e ) { return Bu( e ) && no( e ) == y }; function Ju ( e ) { return "string" == typeof e || !Du( e ) && Bu( e ) && dr( e ) == b } function Xu ( e ) { return "symbol" == typeof e || Bu( e ) && dr( e ) == T } var Qu = it ? kt( it ) : function ( e ) { return Bu( e ) && Wu( e.length ) && !!Fe[dr( e )] }; var Zu = Pi( wr ), es = Pi( ( function ( e, t ) { return e <= t } ) ); function ts ( e ) { if ( !e ) return []; if ( Uu( e ) ) return Ju( e ) ? Vt( e ) : mi( e ); if ( Qe && e[Qe] ) return function ( e ) { for ( var t, n = []; !( t = e.next() ).done; )n.push( t.value ); return n }( e[Qe]() ); var t = no( e ); return ( t == p ? Ft : t == y ? Gt : Os )( e ) } function ns ( e ) { return e ? ( e = os( e ) ) === 1 / 0 || e === -1 / 0 ? 17976931348623157e292 * ( e < 0 ? -1 : 1 ) : e == e ? e : 0 : 0 === e ? e : 0 } function rs ( e ) { var t = ns( e ), n = t % 1; return t == t ? n ? t - n : t : 0 } function is ( e ) { return e ? Yn( rs( e ), 0, 4294967295 ) : 0 } function os ( e ) { if ( "number" == typeof e ) return e; if ( Xu( e ) ) return NaN; if ( Gu( e ) ) { var t = "function" == typeof e.valueOf ? e.valueOf() : e; e = Gu( t ) ? t + "" : t } if ( "string" != typeof e ) return 0 === e ? e : +e; e = e.replace( K, "" ); var n = oe.test( e ); return n || se.test( e ) ? Be( e.slice( 2 ), n ? 2 : 8 ) : ie.test( e ) ? NaN : +e } function us ( e ) { return gi( e, Ts( e ) ) } function ss ( e ) { return null == e ? "" : Xr( e ) } var ls = bi( ( function ( e, t ) { if ( fo( t ) || Uu( t ) ) gi( t, bs( t ), e ); else for ( var n in t ) Ee.call( t, n ) && Gn( e, n, t[n] ) } ) ), as = bi( ( function ( e, t ) { gi( t, Ts( t ), e ) } ) ), cs = bi( ( function ( e, t, n, r ) { gi( t, Ts( t ), e, r ) } ) ), fs = bi( ( function ( e, t, n, r ) { gi( t, bs( t ), e, r ) } ) ), hs = Bi( Kn ); var ds = qr( ( function ( e, t ) { e = pe( e ); var n = -1, r = t.length, i = r > 2 ? t[2] : void 0; for ( i && so( t[0], t[1], i ) && ( r = 1 ); ++n < r; )for ( var o = t[n], u = Ts( o ), s = -1, l = u.length; ++s < l; ) { var a = u[s], c = e[a]; ( void 0 === c || Ou( c, Te[a] ) && !Ee.call( e, a ) ) && ( e[a] = o[a] ) } return e } ) ), _s = qr( ( function ( e ) { return e.push( void 0, Hi ), ot( Cs, void 0, e ) } ) ); function ps ( e, t, n ) { var r = null == e ? void 0 : fr( e, t ); return void 0 === r ? n : r } function vs ( e, t ) { return null != e && ro( e, t, vr ) } var ms = Oi( ( function ( e, t, n ) { null != t && "function" != typeof t.toString && ( t = Re.call( t ) ), e[t] = n } ), Gs( Vs ) ), gs = Oi( ( function ( e, t, n ) { null != t && "function" != typeof t.toString && ( t = Re.call( t ) ), Ee.call( e, t ) ? e[t].push( n ) : e[t] = [n] } ), Ji ), ys = qr( gr ); function bs ( e ) { return Uu( e ) ? qn( e ) : Er( e ) } function Ts ( e ) { return Uu( e ) ? qn( e, !0 ) : Ar( e ) } var Ss = bi( ( function ( e, t, n ) { kr( e, t, n ) } ) ), Cs = bi( ( function ( e, t, n, r ) { kr( e, t, n, r ) } ) ), Es = Bi( ( function ( e, t ) { var n = {}; if ( null == e ) return n; var r = !1; t = dt( t, ( function ( t ) { return t = si( t, e ), r || ( r = t.length > 1 ), t } ) ), gi( e, Vi( e ), n ), r && ( n = Jn( n, 7, Wi ) ); for ( var i = t.length; i--; )Zr( n, t[i] ); return n } ) ); var As = Bi( ( function ( e, t ) { return null == e ? {} : function ( e, t ) { return Dr( e, t, ( function ( t, n ) { return vs( e, n ) } ) ) }( e, t ) } ) ); function ws ( e, t ) { if ( null == e ) return {}; var n = dt( Vi( e ), ( function ( e ) { return [e] } ) ); return t = Ji( t ), Dr( e, n, ( function ( e, n ) { return t( e, n[0] ) } ) ) } var Rs = qi( bs ), Is = qi( Ts ); function Os ( e ) { return null == e ? [] : Nt( e, bs( e ) ) } var ks = Ei( ( function ( e, t, n ) { return t = t.toLowerCase(), e + ( n ? Ns( t ) : t ) } ) ); function Ns ( e ) { return Ls( ss( e ).toLowerCase() ) } function xs ( e ) { return ( e = ss( e ) ) && e.replace( ae, jt ).replace( De, "" ) } var Ds = Ei( ( function ( e, t, n ) { return e + ( n ? "-" : "" ) + t.toLowerCase() } ) ), Ps = Ei( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + t.toLowerCase() } ) ), Us = Ci( "toLowerCase" ); var js = Ei( ( function ( e, t, n ) { return e + ( n ? "_" : "" ) + t.toLowerCase() } ) ); var Ms = Ei( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + Ls( t ) } ) ); var qs = Ei( ( function ( e, t, n ) { return e + ( n ? " " : "" ) + t.toUpperCase() } ) ), Ls = Ci( "toUpperCase" ); function Fs ( e, t, n ) { return e = ss( e ), void 0 === ( t = n ? void 0 : t ) ? function ( e ) { return Me.test( e ) }( e ) ? function ( e ) { return e.match( Ue ) || [] }( e ) : function ( e ) { return e.match( ee ) || [] }( e ) : e.match( t ) || [] } var Hs = qr( ( function ( e, t ) { try { return ot( e, void 0, t ) } catch ( e ) { return Lu( e ) ? e : new he( e ) } } ) ), Ws = Bi( ( function ( e, t ) { return st( t, ( function ( t ) { t = wo( t ), $n( e, t, gu( e[t], e ) ) } ) ), e } ) ); function Gs ( e ) { return function () { return e } } var Bs = Ri(), zs = Ri( !0 ); function Vs ( e ) { return e } function $s ( e ) { return Cr( "function" == typeof e ? e : Jn( e, 1 ) ) } var Ks = qr( ( function ( e, t ) { return function ( n ) { return gr( n, e, t ) } } ) ), Ys = qr( ( function ( e, t ) { return function ( n ) { return gr( e, n, t ) } } ) ); function Js ( e, t, n ) { var r = bs( t ), i = cr( t, r ); null != n || Gu( t ) && ( i.length || !r.length ) || ( n = t, t = e, e = this, i = cr( t, bs( t ) ) ); var o = !( Gu( n ) && "chain" in n && !n.chain ), u = Fu( e ); return st( i, ( function ( n ) { var r = t[n]; e[n] = r, u && ( e.prototype[n] = function () { var t = this.__chain__; if ( o || t ) { var n = e( this.__wrapped__ ), i = n.__actions__ = mi( this.__actions__ ); return i.push( { func: r, args: arguments, thisArg: e } ), n.__chain__ = t, n } return r.apply( e, _t( [this.value()], arguments ) ) } ) } ) ), e } function Xs () { } var Qs = Ni( dt ), Zs = Ni( at ), el = Ni( mt ); function tl ( e ) { return lo( e ) ? At( wo( e ) ) : function ( e ) { return function ( t ) { return fr( t, e ) } }( e ) } var nl = Di(), rl = Di( !0 ); function il () { return [] } function ol () { return !1 } var ul = ki( ( function ( e, t ) { return e + t } ), 0 ), sl = ji( "ceil" ), ll = ki( ( function ( e, t ) { return e / t } ), 1 ), al = ji( "floor" ); var cl, fl = ki( ( function ( e, t ) { return e * t } ), 1 ), hl = ji( "round" ), dl = ki( ( function ( e, t ) { return e - t } ), 0 ); return In.after = function ( e, t ) { if ( "function" != typeof t ) throw new ge( o ); return e = rs( e ), function () { if ( --e < 1 ) return t.apply( this, arguments ) } }, In.ary = vu, In.assign = ls, In.assignIn = as, In.assignInWith = cs, In.assignWith = fs, In.at = hs, In.before = mu, In.bind = gu, In.bindAll = Ws, In.bindKey = yu, In.castArray = function () { if ( !arguments.length ) return []; var e = arguments[0]; return Du( e ) ? e : [e] }, In.chain = tu, In.chunk = function ( e, t, n ) { t = ( n ? so( e, t, n ) : void 0 === t ) ? 1 : un( rs( t ), 0 ); var i = null == e ? 0 : e.length; if ( !i || t < 1 ) return []; for ( var o = 0, u = 0, s = r( Qt( i / t ) ); o < i; )s[u++] = zr( e, o, o += t ); return s }, In.compact = function ( e ) { for ( var t = -1, n = null == e ? 0 : e.length, r = 0, i = []; ++t < n; ) { var o = e[t]; o && ( i[r++] = o ) } return i }, In.concat = function () { var e = arguments.length; if ( !e ) return []; for ( var t = r( e - 1 ), n = arguments[0], i = e; i--; )t[i - 1] = arguments[i]; return _t( Du( n ) ? mi( n ) : [n], or( t, 1 ) ) }, In.cond = function ( e ) { var t = null == e ? 0 : e.length, n = Ji(); return e = t ? dt( e, ( function ( e ) { if ( "function" != typeof e[1] ) throw new ge( o ); return [n( e[0] ), e[1]] } ) ) : [], qr( ( function ( n ) { for ( var r = -1; ++r < t; ) { var i = e[r]; if ( ot( i[0], this, n ) ) return ot( i[1], this, n ) } } ) ) }, In.conforms = function ( e ) { return function ( e ) { var t = bs( e ); return function ( n ) { return Xn( n, e, t ) } }( Jn( e, 1 ) ) }, In.constant = Gs, In.countBy = iu, In.create = function ( e, t ) { var n = On( e ); return null == t ? n : Vn( n, t ) }, In.curry = function e ( t, n, r ) { var i = Li( t, 8, void 0, void 0, void 0, void 0, void 0, n = r ? void 0 : n ); return i.placeholder = e.placeholder, i }, In.curryRight = function e ( t, n, r ) { var i = Li( t, 16, void 0, void 0, void 0, void 0, void 0, n = r ? void 0 : n ); return i.placeholder = e.placeholder, i }, In.debounce = bu, In.defaults = ds, In.defaultsDeep = _s, In.defer = Tu, In.delay = Su, In.difference = Oo, In.differenceBy = ko, In.differenceWith = No, In.drop = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? zr( e, ( t = n || void 0 === t ? 1 : rs( t ) ) < 0 ? 0 : t, r ) : [] }, In.dropRight = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? zr( e, 0, ( t = r - ( t = n || void 0 === t ? 1 : rs( t ) ) ) < 0 ? 0 : t ) : [] }, In.dropRightWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !0, !0 ) : [] }, In.dropWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !0 ) : [] }, In.fill = function ( e, t, n, r ) { var i = null == e ? 0 : e.length; return i ? ( n && "number" != typeof n && so( e, t, n ) && ( n = 0, r = i ), function ( e, t, n, r ) { var i = e.length; for ( ( n = rs( n ) ) < 0 && ( n = -n > i ? 0 : i + n ), ( r = void 0 === r || r > i ? i : rs( r ) ) < 0 && ( r += i ), r = n > r ? 0 : is( r ); n < r; )e[n++] = t; return e }( e, t, n, r ) ) : [] }, In.filter = function ( e, t ) { return ( Du( e ) ? ct : ir )( e, Ji( t, 3 ) ) }, In.flatMap = function ( e, t ) { return or( hu( e, t ), 1 ) }, In.flatMapDeep = function ( e, t ) { return or( hu( e, t ), 1 / 0 ) }, In.flatMapDepth = function ( e, t, n ) { return n = void 0 === n ? 1 : rs( n ), or( hu( e, t ), n ) }, In.flatten = Po, In.flattenDeep = function ( e ) { return ( null == e ? 0 : e.length ) ? or( e, 1 / 0 ) : [] }, In.flattenDepth = function ( e, t ) { return ( null == e ? 0 : e.length ) ? or( e, t = void 0 === t ? 1 : rs( t ) ) : [] }, In.flip = function ( e ) { return Li( e, 512 ) }, In.flow = Bs, In.flowRight = zs, In.fromPairs = function ( e ) { for ( var t = -1, n = null == e ? 0 : e.length, r = {}; ++t < n; ) { var i = e[t]; r[i[0]] = i[1] } return r }, In.functions = function ( e ) { return null == e ? [] : cr( e, bs( e ) ) }, In.functionsIn = function ( e ) { return null == e ? [] : cr( e, Ts( e ) ) }, In.groupBy = au, In.initial = function ( e ) { return ( null == e ? 0 : e.length ) ? zr( e, 0, -1 ) : [] }, In.intersection = jo, In.intersectionBy = Mo, In.intersectionWith = qo, In.invert = ms, In.invertBy = gs, In.invokeMap = cu, In.iteratee = $s, In.keyBy = fu, In.keys = bs, In.keysIn = Ts, In.map = hu, In.mapKeys = function ( e, t ) { var n = {}; return t = Ji( t, 3 ), lr( e, ( function ( e, r, i ) { $n( n, t( e, r, i ), e ) } ) ), n }, In.mapValues = function ( e, t ) { var n = {}; return t = Ji( t, 3 ), lr( e, ( function ( e, r, i ) { $n( n, r, t( e, r, i ) ) } ) ), n }, In.matches = function ( e ) { return Ir( Jn( e, 1 ) ) }, In.matchesProperty = function ( e, t ) { return Or( e, Jn( t, 1 ) ) }, In.memoize = Cu, In.merge = Ss, In.mergeWith = Cs, In.method = Ks, In.methodOf = Ys, In.mixin = Js, In.negate = Eu, In.nthArg = function ( e ) { return e = rs( e ), qr( ( function ( t ) { return Nr( t, e ) } ) ) }, In.omit = Es, In.omitBy = function ( e, t ) { return ws( e, Eu( Ji( t ) ) ) }, In.once = function ( e ) { return mu( 2, e ) }, In.orderBy = function ( e, t, n, r ) { return null == e ? [] : ( Du( t ) || ( t = null == t ? [] : [t] ), Du( n = r ? void 0 : n ) || ( n = null == n ? [] : [n] ), xr( e, t, n ) ) }, In.over = Qs, In.overArgs = Au, In.overEvery = Zs, In.overSome = el, In.partial = wu, In.partialRight = Ru, In.partition = du, In.pick = As, In.pickBy = ws, In.property = tl, In.propertyOf = function ( e ) { return function ( t ) { return null == e ? void 0 : fr( e, t ) } }, In.pull = Fo, In.pullAll = Ho, In.pullAllBy = function ( e, t, n ) { return e && e.length && t && t.length ? Pr( e, t, Ji( n, 2 ) ) : e }, In.pullAllWith = function ( e, t, n ) { return e && e.length && t && t.length ? Pr( e, t, void 0, n ) : e }, In.pullAt = Wo, In.range = nl, In.rangeRight = rl, In.rearg = Iu, In.reject = function ( e, t ) { return ( Du( e ) ? ct : ir )( e, Eu( Ji( t, 3 ) ) ) }, In.remove = function ( e, t ) { var n = []; if ( !e || !e.length ) return n; var r = -1, i = [], o = e.length; for ( t = Ji( t, 3 ); ++r < o; ) { var u = e[r]; t( u, r, e ) && ( n.push( u ), i.push( r ) ) } return Ur( e, i ), n }, In.rest = function ( e, t ) { if ( "function" != typeof e ) throw new ge( o ); return qr( e, t = void 0 === t ? t : rs( t ) ) }, In.reverse = Go, In.sampleSize = function ( e, t, n ) { return t = ( n ? so( e, t, n ) : void 0 === t ) ? 1 : rs( t ), ( Du( e ) ? Fn : Fr )( e, t ) }, In.set = function ( e, t, n ) { return null == e ? e : Hr( e, t, n ) }, In.setWith = function ( e, t, n, r ) { return r = "function" == typeof r ? r : void 0, null == e ? e : Hr( e, t, n, r ) }, In.shuffle = function ( e ) { return ( Du( e ) ? Hn : Br )( e ) }, In.slice = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? ( n && "number" != typeof n && so( e, t, n ) ? ( t = 0, n = r ) : ( t = null == t ? 0 : rs( t ), n = void 0 === n ? r : rs( n ) ), zr( e, t, n ) ) : [] }, In.sortBy = _u, In.sortedUniq = function ( e ) { return e && e.length ? Yr( e ) : [] }, In.sortedUniqBy = function ( e, t ) { return e && e.length ? Yr( e, Ji( t, 2 ) ) : [] }, In.split = function ( e, t, n ) { return n && "number" != typeof n && so( e, t, n ) && ( t = n = void 0 ), ( n = void 0 === n ? 4294967295 : n >>> 0 ) ? ( e = ss( e ) ) && ( "string" == typeof t || null != t && !Ku( t ) ) && !( t = Xr( t ) ) && Lt( e ) ? ai( Vt( e ), 0, n ) : e.split( t, n ) : [] }, In.spread = function ( e, t ) { if ( "function" != typeof e ) throw new ge( o ); return t = null == t ? 0 : un( rs( t ), 0 ), qr( ( function ( n ) { var r = n[t], i = ai( n, 0, t ); return r && _t( i, r ), ot( e, this, i ) } ) ) }, In.tail = function ( e ) { var t = null == e ? 0 : e.length; return t ? zr( e, 1, t ) : [] }, In.take = function ( e, t, n ) { return e && e.length ? zr( e, 0, ( t = n || void 0 === t ? 1 : rs( t ) ) < 0 ? 0 : t ) : [] }, In.takeRight = function ( e, t, n ) { var r = null == e ? 0 : e.length; return r ? zr( e, ( t = r - ( t = n || void 0 === t ? 1 : rs( t ) ) ) < 0 ? 0 : t, r ) : [] }, In.takeRightWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ), !1, !0 ) : [] }, In.takeWhile = function ( e, t ) { return e && e.length ? ti( e, Ji( t, 3 ) ) : [] }, In.tap = function ( e, t ) { return t( e ), e }, In.throttle = function ( e, t, n ) { var r = !0, i = !0; if ( "function" != typeof e ) throw new ge( o ); return Gu( n ) && ( r = "leading" in n ? !!n.leading : r, i = "trailing" in n ? !!n.trailing : i ), bu( e, t, { leading: r, maxWait: t, trailing: i } ) }, In.thru = nu, In.toArray = ts, In.toPairs = Rs, In.toPairsIn = Is, In.toPath = function ( e ) { return Du( e ) ? dt( e, wo ) : Xu( e ) ? [e] : mi( Ao( ss( e ) ) ) }, In.toPlainObject = us, In.transform = function ( e, t, n ) { var r = Du( e ), i = r || Mu( e ) || Qu( e ); if ( t = Ji( t, 4 ), null == n ) { var o = e && e.constructor; n = i ? r ? new o : [] : Gu( e ) && Fu( o ) ? On( ze( e ) ) : {} } return ( i ? st : lr )( e, ( function ( e, r, i ) { return t( n, e, r, i ) } ) ), n }, In.unary = function ( e ) { return vu( e, 1 ) }, In.union = Bo, In.unionBy = zo, In.unionWith = Vo, In.uniq = function ( e ) { return e && e.length ? Qr( e ) : [] }, In.uniqBy = function ( e, t ) { return e && e.length ? Qr( e, Ji( t, 2 ) ) : [] }, In.uniqWith = function ( e, t ) { return t = "function" == typeof t ? t : void 0, e && e.length ? Qr( e, void 0, t ) : [] }, In.unset = function ( e, t ) { return null == e || Zr( e, t ) }, In.unzip = $o, In.unzipWith = Ko, In.update = function ( e, t, n ) { return null == e ? e : ei( e, t, ui( n ) ) }, In.updateWith = function ( e, t, n, r ) { return r = "function" == typeof r ? r : void 0, null == e ? e : ei( e, t, ui( n ), r ) }, In.values = Os, In.valuesIn = function ( e ) { return null == e ? [] : Nt( e, Ts( e ) ) }, In.without = Yo, In.words = Fs, In.wrap = function ( e, t ) { return wu( ui( t ), e ) }, In.xor = Jo, In.xorBy = Xo, In.xorWith = Qo, In.zip = Zo, In.zipObject = function ( e, t ) { return ii( e || [], t || [], Gn ) }, In.zipObjectDeep = function ( e, t ) { return ii( e || [], t || [], Hr ) }, In.zipWith = eu, In.entries = Rs, In.entriesIn = Is, In.extend = as, In.extendWith = cs, Js( In, In ), In.add = ul, In.attempt = Hs, In.camelCase = ks, In.capitalize = Ns, In.ceil = sl, In.clamp = function ( e, t, n ) { return void 0 === n && ( n = t, t = void 0 ), void 0 !== n && ( n = ( n = os( n ) ) == n ? n : 0 ), void 0 !== t && ( t = ( t = os( t ) ) == t ? t : 0 ), Yn( os( e ), t, n ) }, In.clone = function ( e ) { return Jn( e, 4 ) }, In.cloneDeep = function ( e ) { return Jn( e, 5 ) }, In.cloneDeepWith = function ( e, t ) { return Jn( e, 5, t = "function" == typeof t ? t : void 0 ) }, In.cloneWith = function ( e, t ) { return Jn( e, 4, t = "function" == typeof t ? t : void 0 ) }, In.conformsTo = function ( e, t ) { return null == t || Xn( e, t, bs( t ) ) }, In.deburr = xs, In.defaultTo = function ( e, t ) { return null == e || e != e ? t : e }, In.divide = ll, In.endsWith = function ( e, t, n ) { e = ss( e ), t = Xr( t ); var r = e.length, i = n = void 0 === n ? r : Yn( rs( n ), 0, r ); return ( n -= t.length ) >= 0 && e.slice( n, i ) == t }, In.eq = Ou, In.escape = function ( e ) { return ( e = ss( e ) ) && L.test( e ) ? e.replace( M, Mt ) : e }, In.escapeRegExp = function ( e ) { return ( e = ss( e ) ) && $.test( e ) ? e.replace( V, "\\$&" ) : e }, In.every = function ( e, t, n ) { var r = Du( e ) ? at : nr; return n && so( e, t, n ) && ( t = void 0 ), r( e, Ji( t, 3 ) ) }, In.find = ou, In.findIndex = xo, In.findKey = function ( e, t ) { return yt( e, Ji( t, 3 ), lr ) }, In.findLast = uu, In.findLastIndex = Do, In.findLastKey = function ( e, t ) { return yt( e, Ji( t, 3 ), ar ) }, In.floor = al, In.forEach = su, In.forEachRight = lu, In.forIn = function ( e, t ) { return null == e ? e : ur( e, Ji( t, 3 ), Ts ) }, In.forInRight = function ( e, t ) { return null == e ? e : sr( e, Ji( t, 3 ), Ts ) }, In.forOwn = function ( e, t ) { return e && lr( e, Ji( t, 3 ) ) }, In.forOwnRight = function ( e, t ) { return e && ar( e, Ji( t, 3 ) ) }, In.get = ps, In.gt = ku, In.gte = Nu, In.has = function ( e, t ) { return null != e && ro( e, t, pr ) }, In.hasIn = vs, In.head = Uo, In.identity = Vs, In.includes = function ( e, t, n, r ) { e = Uu( e ) ? e : Os( e ), n = n && !r ? rs( n ) : 0; var i = e.length; return n < 0 && ( n = un( i + n, 0 ) ), Ju( e ) ? n <= i && e.indexOf( t, n ) > -1 : !!i && Tt( e, t, n ) > -1 }, In.indexOf = function ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = null == n ? 0 : rs( n ); return i < 0 && ( i = un( r + i, 0 ) ), Tt( e, t, i ) }, In.inRange = function ( e, t, n ) { return t = ns( t ), void 0 === n ? ( n = t, t = 0 ) : n = ns( n ), function ( e, t, n ) { return e >= sn( t, n ) && e < un( t, n ) }( e = os( e ), t, n ) }, In.invoke = ys, In.isArguments = xu, In.isArray = Du, In.isArrayBuffer = Pu, In.isArrayLike = Uu, In.isArrayLikeObject = ju, In.isBoolean = function ( e ) { return !0 === e || !1 === e || Bu( e ) && dr( e ) == c }, In.isBuffer = Mu, In.isDate = qu, In.isElement = function ( e ) { return Bu( e ) && 1 === e.nodeType && !$u( e ) }, In.isEmpty = function ( e ) { if ( null == e ) return !0; if ( Uu( e ) && ( Du( e ) || "string" == typeof e || "function" == typeof e.splice || Mu( e ) || Qu( e ) || xu( e ) ) ) return !e.length; var t = no( e ); if ( t == p || t == y ) return !e.size; if ( fo( e ) ) return !Er( e ).length; for ( var n in e ) if ( Ee.call( e, n ) ) return !1; return !0 }, In.isEqual = function ( e, t ) { return br( e, t ) }, In.isEqualWith = function ( e, t, n ) { var r = ( n = "function" == typeof n ? n : void 0 ) ? n( e, t ) : void 0; return void 0 === r ? br( e, t, void 0, n ) : !!r }, In.isError = Lu, In.isFinite = function ( e ) { return "number" == typeof e && nn( e ) }, In.isFunction = Fu, In.isInteger = Hu, In.isLength = Wu, In.isMap = zu, In.isMatch = function ( e, t ) { return e === t || Tr( e, t, Qi( t ) ) }, In.isMatchWith = function ( e, t, n ) { return n = "function" == typeof n ? n : void 0, Tr( e, t, Qi( t ), n ) }, In.isNaN = function ( e ) { return Vu( e ) && e != +e }, In.isNative = function ( e ) { if ( co( e ) ) throw new he( "Unsupported core-js use. Try https://npms.io/search?q=ponyfill." ); return Sr( e ) }, In.isNil = function ( e ) { return null == e }, In.isNull = function ( e ) { return null === e }, In.isNumber = Vu, In.isObject = Gu, In.isObjectLike = Bu, In.isPlainObject = $u, In.isRegExp = Ku, In.isSafeInteger = function ( e ) { return Hu( e ) && e >= -9007199254740991 && e <= 9007199254740991 }, In.isSet = Yu, In.isString = Ju, In.isSymbol = Xu, In.isTypedArray = Qu, In.isUndefined = function ( e ) { return void 0 === e }, In.isWeakMap = function ( e ) { return Bu( e ) && no( e ) == S }, In.isWeakSet = function ( e ) { return Bu( e ) && "[object WeakSet]" == dr( e ) }, In.join = function ( e, t ) { return null == e ? "" : rn.call( e, t ) }, In.kebabCase = Ds, In.last = Lo, In.lastIndexOf = function ( e, t, n ) { var r = null == e ? 0 : e.length; if ( !r ) return -1; var i = r; return void 0 !== n && ( i = ( i = rs( n ) ) < 0 ? un( r + i, 0 ) : sn( i, r - 1 ) ), t == t ? function ( e, t, n ) { for ( var r = n + 1; r--; )if ( e[r] === t ) return r; return r }( e, t, i ) : bt( e, Ct, i, !0 ) }, In.lowerCase = Ps, In.lowerFirst = Us, In.lt = Zu, In.lte = es, In.max = function ( e ) { return e && e.length ? rr( e, Vs, _r ) : void 0 }, In.maxBy = function ( e, t ) { return e && e.length ? rr( e, Ji( t, 2 ), _r ) : void 0 }, In.mean = function ( e ) { return Et( e, Vs ) }, In.meanBy = function ( e, t ) { return Et( e, Ji( t, 2 ) ) }, In.min = function ( e ) { return e && e.length ? rr( e, Vs, wr ) : void 0 }, In.minBy = function ( e, t ) { return e && e.length ? rr( e, Ji( t, 2 ), wr ) : void 0 }, In.stubArray = il, In.stubFalse = ol, In.stubObject = function () { return {} }, In.stubString = function () { return "" }, In.stubTrue = function () { return !0 }, In.multiply = fl, In.nth = function ( e, t ) { return e && e.length ? Nr( e, rs( t ) ) : void 0 }, In.noConflict = function () { return $e._ === this && ( $e._ = Oe ), this }, In.noop = Xs, In.now = pu, In.pad = function ( e, t, n ) { e = ss( e ); var r = ( t = rs( t ) ) ? zt( e ) : 0; if ( !t || r >= t ) return e; var i = ( t - r ) / 2; return xi( Zt( i ), n ) + e + xi( Qt( i ), n ) }, In.padEnd = function ( e, t, n ) { e = ss( e ); var r = ( t = rs( t ) ) ? zt( e ) : 0; return t && r < t ? e + xi( t - r, n ) : e }, In.padStart = function ( e, t, n ) { e = ss( e ); var r = ( t = rs( t ) ) ? zt( e ) : 0; return t && r < t ? xi( t - r, n ) + e : e }, In.parseInt = function ( e, t, n ) { return n || null == t ? t = 0 : t && ( t = +t ), an( ss( e ).replace( Y, "" ), t || 0 ) }, In.random = function ( e, t, n ) { if ( n && "boolean" != typeof n && so( e, t, n ) && ( t = n = void 0 ), void 0 === n && ( "boolean" == typeof t ? ( n = t, t = void 0 ) : "boolean" == typeof e && ( n = e, e = void 0 ) ), void 0 === e && void 0 === t ? ( e = 0, t = 1 ) : ( e = ns( e ), void 0 === t ? ( t = e, e = 0 ) : t = ns( t ) ), e > t ) { var r = e; e = t, t = r } if ( n || e % 1 || t % 1 ) { var i = cn(); return sn( e + i * ( t - e + Ge( "1e-" + ( ( i + "" ).length - 1 ) ) ), t ) } return jr( e, t ) }, In.reduce = function ( e, t, n ) { var r = Du( e ) ? pt : Rt, i = arguments.length < 3; return r( e, Ji( t, 4 ), n, i, er ) }, In.reduceRight = function ( e, t, n ) { var r = Du( e ) ? vt : Rt, i = arguments.length < 3; return r( e, Ji( t, 4 ), n, i, tr ) }, In.repeat = function ( e, t, n ) { return t = ( n ? so( e, t, n ) : void 0 === t ) ? 1 : rs( t ), Mr( ss( e ), t ) }, In.replace = function () { var e = arguments, t = ss( e[0] ); return e.length < 3 ? t : t.replace( e[1], e[2] ) }, In.result = function ( e, t, n ) { var r = -1, i = ( t = si( t, e ) ).length; for ( i || ( i = 1, e = void 0 ); ++r < i; ) { var o = null == e ? void 0 : e[wo( t[r] )]; void 0 === o && ( r = i, o = n ), e = Fu( o ) ? o.call( e ) : o } return e }, In.round = hl, In.runInContext = e, In.sample = function ( e ) { return ( Du( e ) ? Ln : Lr )( e ) }, In.size = function ( e ) { if ( null == e ) return 0; if ( Uu( e ) ) return Ju( e ) ? zt( e ) : e.length; var t = no( e ); return t == p || t == y ? e.size : Er( e ).length }, In.snakeCase = js, In.some = function ( e, t, n ) { var r = Du( e ) ? mt : Vr; return n && so( e, t, n ) && ( t = void 0 ), r( e, Ji( t, 3 ) ) }, In.sortedIndex = function ( e, t ) { return $r( e, t ) }, In.sortedIndexBy = function ( e, t, n ) { return Kr( e, t, Ji( n, 2 ) ) }, In.sortedIndexOf = function ( e, t ) { var n = null == e ? 0 : e.length; if ( n ) { var r = $r( e, t ); if ( r < n && Ou( e[r], t ) ) return r } return -1 }, In.sortedLastIndex = function ( e, t ) { return $r( e, t, !0 ) }, In.sortedLastIndexBy = function ( e, t, n ) { return Kr( e, t, Ji( n, 2 ), !0 ) }, In.sortedLastIndexOf = function ( e, t ) { if ( null == e ? 0 : e.length ) { var n = $r( e, t, !0 ) - 1; if ( Ou( e[n], t ) ) return n } return -1 }, In.startCase = Ms, In.startsWith = function ( e, t, n ) { return e = ss( e ), n = null == n ? 0 : Yn( rs( n ), 0, e.length ), t = Xr( t ), e.slice( n, n + t.length ) == t }, In.subtract = dl, In.sum = function ( e ) { return e && e.length ? It( e, Vs ) : 0 }, In.sumBy = function ( e, t ) { return e && e.length ? It( e, Ji( t, 2 ) ) : 0 }, In.template = function ( e, t, n ) { var r = In.templateSettings; n && so( e, t, n ) && ( t = void 0 ), e = ss( e ), t = cs( {}, t, r, Fi ); var i, o, u = cs( {}, t.imports, r.imports, Fi ), s = bs( u ), l = Nt( u, s ), a = 0, c = t.interpolate || ce, f = "__p += '", h = ve( ( t.escape || ce ).source + "|" + c.source + "|" + ( c === W ? ne : ce ).source + "|" + ( t.evaluate || ce ).source + "|$", "g" ), d = "//# sourceURL=" + ( Ee.call( t, "sourceURL" ) ? ( t.sourceURL + "" ).replace( /[\r\n]/g, " " ) : "lodash.templateSources[" + ++Le + "]" ) + "\n"; e.replace( h, ( function ( t, n, r, u, s, l ) { return r || ( r = u ), f += e.slice( a, l ).replace( fe, qt ), n && ( i = !0, f += "' +\n__e(" + n + ") +\n'" ), s && ( o = !0, f += "';\n" + s + ";\n__p += '" ), r && ( f += "' +\n((__t = (" + r + ")) == null ? '' : __t) +\n'" ), a = l + t.length, t } ) ), f += "';\n"; var _ = Ee.call( t, "variable" ) && t.variable; _ || ( f = "with (obj) {\n" + f + "\n}\n" ), f = ( o ? f.replace( D, "" ) : f ).replace( P, "$1" ).replace( U, "$1;" ), f = "function(" + ( _ || "obj" ) + ") {\n" + ( _ ? "" : "obj || (obj = {});\n" ) + "var __t, __p = ''" + ( i ? ", __e = _.escape" : "" ) + ( o ? ", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n" : ";\n" ) + f + "return __p\n}"; var p = Hs( ( function () { return de( s, d + "return " + f ).apply( void 0, l ) } ) ); if ( p.source = f, Lu( p ) ) throw p; return p }, In.times = function ( e, t ) { if ( ( e = rs( e ) ) < 1 || e > 9007199254740991 ) return []; var n = 4294967295, r = sn( e, 4294967295 ); e -= 4294967295; for ( var i = Ot( r, t = Ji( t ) ); ++n < e; )t( n ); return i }, In.toFinite = ns, In.toInteger = rs, In.toLength = is, In.toLower = function ( e ) { return ss( e ).toLowerCase() }, In.toNumber = os, In.toSafeInteger = function ( e ) { return e ? Yn( rs( e ), -9007199254740991, 9007199254740991 ) : 0 === e ? e : 0 }, In.toString = ss, In.toUpper = function ( e ) { return ss( e ).toUpperCase() }, In.trim = function ( e, t, n ) { if ( ( e = ss( e ) ) && ( n || void 0 === t ) ) return e.replace( K, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = Vt( e ), i = Vt( t ); return ai( r, Dt( r, i ), Pt( r, i ) + 1 ).join( "" ) }, In.trimEnd = function ( e, t, n ) { if ( ( e = ss( e ) ) && ( n || void 0 === t ) ) return e.replace( J, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = Vt( e ); return ai( r, 0, Pt( r, Vt( t ) ) + 1 ).join( "" ) }, In.trimStart = function ( e, t, n ) { if ( ( e = ss( e ) ) && ( n || void 0 === t ) ) return e.replace( Y, "" ); if ( !e || !( t = Xr( t ) ) ) return e; var r = Vt( e ); return ai( r, Dt( r, Vt( t ) ) ).join( "" ) }, In.truncate = function ( e, t ) { var n = 30, r = "..."; if ( Gu( t ) ) { var i = "separator" in t ? t.separator : i; n = "length" in t ? rs( t.length ) : n, r = "omission" in t ? Xr( t.omission ) : r } var o = ( e = ss( e ) ).length; if ( Lt( e ) ) { var u = Vt( e ); o = u.length } if ( n >= o ) return e; var s = n - zt( r ); if ( s < 1 ) return r; var l = u ? ai( u, 0, s ).join( "" ) : e.slice( 0, s ); if ( void 0 === i ) return l + r; if ( u && ( s += l.length - s ), Ku( i ) ) { if ( e.slice( s ).search( i ) ) { var a, c = l; for ( i.global || ( i = ve( i.source, ss( re.exec( i ) ) + "g" ) ), i.lastIndex = 0; a = i.exec( c ); )var f = a.index; l = l.slice( 0, void 0 === f ? s : f ) } } else if ( e.indexOf( Xr( i ), s ) != s ) { var h = l.lastIndexOf( i ); h > -1 && ( l = l.slice( 0, h ) ) } return l + r }, In.unescape = function ( e ) { return ( e = ss( e ) ) && q.test( e ) ? e.replace( j, $t ) : e }, In.uniqueId = function ( e ) { var t = ++Ae; return ss( e ) + t }, In.upperCase = qs, In.upperFirst = Ls, In.each = su, In.eachRight = lu, In.first = Uo, Js( In, ( cl = {}, lr( In, ( function ( e, t ) { Ee.call( In.prototype, t ) || ( cl[t] = e ) } ) ), cl ), { chain: !1 } ), In.VERSION = "4.17.15", st( ["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], ( function ( e ) { In[e].placeholder = In } ) ), st( ["drop", "take"], ( function ( e, t ) { xn.prototype[e] = function ( n ) { n = void 0 === n ? 1 : un( rs( n ), 0 ); var r = this.__filtered__ && !t ? new xn( this ) : this.clone(); return r.__filtered__ ? r.__takeCount__ = sn( n, r.__takeCount__ ) : r.__views__.push( { size: sn( n, 4294967295 ), type: e + ( r.__dir__ < 0 ? "Right" : "" ) } ), r }, xn.prototype[e + "Right"] = function ( t ) { return this.reverse()[e]( t ).reverse() } } ) ), st( ["filter", "map", "takeWhile"], ( function ( e, t ) { var n = t + 1, r = 1 == n || 3 == n; xn.prototype[e] = function ( e ) { var t = this.clone(); return t.__iteratees__.push( { iteratee: Ji( e, 3 ), type: n } ), t.__filtered__ = t.__filtered__ || r, t } } ) ), st( ["head", "last"], ( function ( e, t ) { var n = "take" + ( t ? "Right" : "" ); xn.prototype[e] = function () { return this[n]( 1 ).value()[0] } } ) ), st( ["initial", "tail"], ( function ( e, t ) { var n = "drop" + ( t ? "" : "Right" ); xn.prototype[e] = function () { return this.__filtered__ ? new xn( this ) : this[n]( 1 ) } } ) ), xn.prototype.compact = function () { return this.filter( Vs ) }, xn.prototype.find = function ( e ) { return this.filter( e ).head() }, xn.prototype.findLast = function ( e ) { return this.reverse().find( e ) }, xn.prototype.invokeMap = qr( ( function ( e, t ) { return "function" == typeof e ? new xn( this ) : this.map( ( function ( n ) { return gr( n, e, t ) } ) ) } ) ), xn.prototype.reject = function ( e ) { return this.filter( Eu( Ji( e ) ) ) }, xn.prototype.slice = function ( e, t ) { e = rs( e ); var n = this; return n.__filtered__ && ( e > 0 || t < 0 ) ? new xn( n ) : ( e < 0 ? n = n.takeRight( -e ) : e && ( n = n.drop( e ) ), void 0 !== t && ( n = ( t = rs( t ) ) < 0 ? n.dropRight( -t ) : n.take( t - e ) ), n ) }, xn.prototype.takeRightWhile = function ( e ) { return this.reverse().takeWhile( e ).reverse() }, xn.prototype.toArray = function () { return this.take( 4294967295 ) }, lr( xn.prototype, ( function ( e, t ) { var n = /^(?:filter|find|map|reject)|While$/.test( t ), r = /^(?:head|last)$/.test( t ), i = In[r ? "take" + ( "last" == t ? "Right" : "" ) : t], o = r || /^find/.test( t ); i && ( In.prototype[t] = function () { var t = this.__wrapped__, u = r ? [1] : arguments, s = t instanceof xn, l = u[0], a = s || Du( t ), c = function ( e ) { var t = i.apply( In, _t( [e], u ) ); return r && f ? t[0] : t }; a && n && "function" == typeof l && 1 != l.length && ( s = a = !1 ); var f = this.__chain__, h = !!this.__actions__.length, d = o && !f, _ = s && !h; if ( !o && a ) { t = _ ? t : new xn( this ); var p = e.apply( t, u ); return p.__actions__.push( { func: nu, args: [c], thisArg: void 0 } ), new Nn( p, f ) } return d && _ ? e.apply( this, u ) : ( p = this.thru( c ), d ? r ? p.value()[0] : p.value() : p ) } ) } ) ), st( ["pop", "push", "shift", "sort", "splice", "unshift"], ( function ( e ) { var t = ye[e], n = /^(?:push|sort|unshift)$/.test( e ) ? "tap" : "thru", r = /^(?:pop|shift)$/.test( e ); In.prototype[e] = function () { var e = arguments; if ( r && !this.__chain__ ) { var i = this.value(); return t.apply( Du( i ) ? i : [], e ) } return this[n]( ( function ( n ) { return t.apply( Du( n ) ? n : [], e ) } ) ) } } ) ), lr( xn.prototype, ( function ( e, t ) { var n = In[t]; if ( n ) { var r = n.name + ""; Ee.call( yn, r ) || ( yn[r] = [] ), yn[r].push( { name: t, func: n } ) } } ) ), yn[Ii( void 0, 2 ).name] = [{ name: "wrapper", func: void 0 }], xn.prototype.clone = function () { var e = new xn( this.__wrapped__ ); return e.__actions__ = mi( this.__actions__ ), e.__dir__ = this.__dir__, e.__filtered__ = this.__filtered__, e.__iteratees__ = mi( this.__iteratees__ ), e.__takeCount__ = this.__takeCount__, e.__views__ = mi( this.__views__ ), e }, xn.prototype.reverse = function () { if ( this.__filtered__ ) { var e = new xn( this ); e.__dir__ = -1, e.__filtered__ = !0 } else ( e = this.clone() ).__dir__ *= -1; return e }, xn.prototype.value = function () { var e = this.__wrapped__.value(), t = this.__dir__, n = Du( e ), r = t < 0, i = n ? e.length : 0, o = function ( e, t, n ) { var r = -1, i = n.length; for ( ; ++r < i; ) { var o = n[r], u = o.size; switch ( o.type ) { case "drop": e += u; break; case "dropRight": t -= u; break; case "take": t = sn( t, e + u ); break; case "takeRight": e = un( e, t - u ) } } return { start: e, end: t } }( 0, i, this.__views__ ), u = o.start, s = o.end, l = s - u, a = r ? s : u - 1, c = this.__iteratees__, f = c.length, h = 0, d = sn( l, this.__takeCount__ ); if ( !n || !r && i == l && d == l ) return ni( e, this.__actions__ ); var _ = []; e: for ( ; l-- && h < d; ) { for ( var p = -1, v = e[a += t]; ++p < f; ) { var m = c[p], g = m.iteratee, y = m.type, b = g( v ); if ( 2 == y ) v = b; else if ( !b ) { if ( 1 == y ) continue e; break e } } _[h++] = v } return _ }, In.prototype.at = ru, In.prototype.chain = function () { return tu( this ) }, In.prototype.commit = function () { return new Nn( this.value(), this.__chain__ ) }, In.prototype.next = function () { void 0 === this.__values__ && ( this.__values__ = ts( this.value() ) ); var e = this.__index__ >= this.__values__.length; return { done: e, value: e ? void 0 : this.__values__[this.__index__++] } }, In.prototype.plant = function ( e ) { for ( var t, n = this; n instanceof kn; ) { var r = Io( n ); r.__index__ = 0, r.__values__ = void 0, t ? i.__wrapped__ = r : t = r; var i = r; n = n.__wrapped__ } return i.__wrapped__ = e, t }, In.prototype.reverse = function () { var e = this.__wrapped__; if ( e instanceof xn ) { var t = e; return this.__actions__.length && ( t = new xn( this ) ), ( t = t.reverse() ).__actions__.push( { func: nu, args: [Go], thisArg: void 0 } ), new Nn( t, this.__chain__ ) } return this.thru( Go ) }, In.prototype.toJSON = In.prototype.valueOf = In.prototype.value = function () { return ni( this.__wrapped__, this.__actions__ ) }, In.prototype.first = In.prototype.head, Qe && ( In.prototype[Qe] = function () { return this } ), In }(); $e._ = Kt, void 0 === ( i = function () { return Kt }.call( t, n, t, r ) ) || ( r.exports = i ) } ).call( this )
    } ).call( this, n( 17 ), n( 28 )( e ) )
}, function ( e, t, n ) { "use strict"; var r = n( 19 ); e.exports = { USER_AGENT: "".concat( r.title, " " ).concat( r.version ), SIP: "sip", SIPS: "sips", causes: { CONNECTION_ERROR: "Connection Error", REQUEST_TIMEOUT: "Request Timeout", SIP_FAILURE_CODE: "SIP Failure Code", INTERNAL_ERROR: "Internal Error", BUSY: "Busy", REJECTED: "Rejected", REDIRECTED: "Redirected", UNAVAILABLE: "Unavailable", NOT_FOUND: "Not Found", ADDRESS_INCOMPLETE: "Address Incomplete", INCOMPATIBLE_SDP: "Incompatible SDP", MISSING_SDP: "Missing SDP", AUTHENTICATION_ERROR: "Authentication Error", BYE: "Terminated", WEBRTC_ERROR: "WebRTC Error", CANCELED: "Canceled", NO_ANSWER: "No Answer", EXPIRES: "Expires", NO_ACK: "No ACK", DIALOG_ERROR: "Dialog Error", USER_DENIED_MEDIA_ACCESS: "User Denied Media Access", BAD_MEDIA_DESCRIPTION: "Bad Media Description", RTP_TIMEOUT: "RTP Timeout" }, SIP_ERROR_CAUSES: { REDIRECTED: [300, 301, 302, 305, 380], BUSY: [486, 600], REJECTED: [403, 603], NOT_FOUND: [404, 604], UNAVAILABLE: [480, 410, 408, 430], ADDRESS_INCOMPLETE: [484, 424], INCOMPATIBLE_SDP: [488, 606], AUTHENTICATION_ERROR: [401, 407] }, ACK: "ACK", BYE: "BYE", CANCEL: "CANCEL", INFO: "INFO", INVITE: "INVITE", MESSAGE: "MESSAGE", NOTIFY: "NOTIFY", OPTIONS: "OPTIONS", REGISTER: "REGISTER", REFER: "REFER", UPDATE: "UPDATE", SUBSCRIBE: "SUBSCRIBE", DTMF_TRANSPORT: { INFO: "INFO", RFC2833: "RFC2833" }, REASON_PHRASE: { 100: "Trying", 180: "Ringing", 181: "Call Is Being Forwarded", 182: "Queued", 183: "Session Progress", 199: "Early Dialog Terminated", 200: "OK", 202: "Accepted", 204: "No Notification", 300: "Multiple Choices", 301: "Moved Permanently", 302: "Moved Temporarily", 305: "Use Proxy", 380: "Alternative Service", 400: "Bad Request", 401: "Unauthorized", 402: "Payment Required", 403: "Forbidden", 404: "Not Found", 405: "Method Not Allowed", 406: "Not Acceptable", 407: "Proxy Authentication Required", 408: "Request Timeout", 410: "Gone", 412: "Conditional Request Failed", 413: "Request Entity Too Large", 414: "Request-URI Too Long", 415: "Unsupported Media Type", 416: "Unsupported URI Scheme", 417: "Unknown Resource-Priority", 420: "Bad Extension", 421: "Extension Required", 422: "Session Interval Too Small", 423: "Interval Too Brief", 424: "Bad Location Information", 428: "Use Identity Header", 429: "Provide Referrer Identity", 430: "Flow Failed", 433: "Anonymity Disallowed", 436: "Bad Identity-Info", 437: "Unsupported Certificate", 438: "Invalid Identity Header", 439: "First Hop Lacks Outbound Support", 440: "Max-Breadth Exceeded", 469: "Bad Info Package", 470: "Consent Needed", 478: "Unresolvable Destination", 480: "Temporarily Unavailable", 481: "Call/Transaction Does Not Exist", 482: "Loop Detected", 483: "Too Many Hops", 484: "Address Incomplete", 485: "Ambiguous", 486: "Busy Here", 487: "Request Terminated", 488: "Not Acceptable Here", 489: "Bad Event", 491: "Request Pending", 493: "Undecipherable", 494: "Security Agreement Required", 500: "JsSIP Internal Error", 501: "Not Implemented", 502: "Bad Gateway", 503: "Service Unavailable", 504: "Server Time-out", 505: "Version Not Supported", 513: "Message Too Large", 580: "Precondition Failure", 600: "Busy Everywhere", 603: "Decline", 604: "Does Not Exist Anywhere", 606: "Not Acceptable" }, ALLOWED_METHODS: "INVITE,ACK,CANCEL,BYE,UPDATE,MESSAGE,OPTIONS,REFER,INFO,NOTIFY", ACCEPTED_BODY_TYPES: "application/sdp, application/dtmf-relay", MAX_FORWARDS: 69, SESSION_EXPIRES: 90, MIN_SESSION_EXPIRES: 60, CONNECTION_RECOVERY_MAX_INTERVAL: 30, CONNECTION_RECOVERY_MIN_INTERVAL: 2 } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 15 ); e.exports = function () { function e ( t ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), t ? ( this._debug = i.default( "".concat( "JsSIP", ":" ).concat( t ) ), this._warn = i.default( "".concat( "JsSIP", ":WARN:" ).concat( t ) ), this._error = i.default( "".concat( "JsSIP", ":ERROR:" ).concat( t ) ) ) : ( this._debug = i.default( "JsSIP" ), this._warn = i.default( "".concat( "JsSIP", ":WARN" ) ), this._error = i.default( "".concat( "JsSIP", ":ERROR" ) ) ), this._debug.log = console.info.bind( console ), this._warn.log = console.warn.bind( console ), this._error.log = console.error.bind( console ) } var t, n, o; return t = e, ( n = [{ key: "debug", get: function () { return this._debug } }, { key: "warn", get: function () { return this._warn } }, { key: "error", get: function () { return this._error } }] ) && r( t.prototype, n ), o && r( t, o ), e }() }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return o( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return o( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, i = function () { }; return { s: i, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: i } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function o ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } var u = n( 1 ), s = n( 9 ), l = n( 6 ); t.str_utf8_length = function ( e ) { return unescape( encodeURIComponent( e ) ).length }; var a = t.isFunction = function ( e ) { return void 0 !== e && "[object Function]" === Object.prototype.toString.call( e ) }; t.isString = function ( e ) { return void 0 !== e && "[object String]" === Object.prototype.toString.call( e ) }, t.isDecimal = function ( e ) { return !isNaN( e ) && parseFloat( e ) === parseInt( e, 10 ) }, t.isEmpty = function ( e ) { return null === e || "" === e || void 0 === e || Array.isArray( e ) && 0 === e.length || "number" == typeof e && isNaN( e ) }, t.hasMethods = function ( e ) { for ( var t = arguments.length, n = new Array( t > 1 ? t - 1 : 0 ), r = 1; r < t; r++ )n[r - 1] = arguments[r]; for ( var i = 0, o = n; i < o.length; i++ ) { var u = o[i]; if ( a( e[u] ) ) return !1 } return !0 }; var c = t.createRandomToken = function ( e ) { var t, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 32, r = ""; for ( t = 0; t < e; t++ )r += ( Math.random() * n | 0 ).toString( n ); return r }; t.newTag = function () { return c( 10 ) }, t.newUUID = function () { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace( /[xy]/g, ( function ( e ) { var t = 16 * Math.random() | 0; return ( "x" === e ? t : 3 & t | 8 ).toString( 16 ) } ) ) }, t.hostType = function ( e ) { if ( e ) return -1 !== ( e = l.parse( e, "host" ) ) ? e.host_type : void 0 }; var f = t.escapeUser = function ( e ) { return encodeURIComponent( decodeURIComponent( e ) ).replace( /%3A/gi, ":" ).replace( /%2B/gi, "+" ).replace( /%3F/gi, "?" ).replace( /%2F/gi, "/" ) }; t.normalizeTarget = function ( e, t ) { if ( e ) { if ( e instanceof s ) return e; if ( "string" == typeof e ) { var n, r, i, o = e.split( "@" ); switch ( o.length ) { case 1: if ( !t ) return; n = e, r = t; break; case 2: n = o[0], r = o[1]; break; default: n = o.slice( 0, o.length - 1 ).join( "@" ), r = o[o.length - 1] }return n = n.replace( /^(sips?|tel):/i, "" ), /^[-.()]*\+?[0-9\-.()]+$/.test( n ) && ( n = n.replace( /[-.()]/g, "" ) ), e = "".concat( u.SIP, ":" ).concat( f( n ), "@" ).concat( r ), ( i = s.parse( e ) ) ? i : void 0 } } else; }, t.headerize = function ( e ) { var t, n = { "Call-Id": "Call-ID", Cseq: "CSeq", "Www-Authenticate": "WWW-Authenticate" }, r = e.toLowerCase().replace( /_/g, "-" ).split( "-" ), i = "", o = r.length; for ( t = 0; t < o; t++ )0 !== t && ( i += "-" ), i += r[t].charAt( 0 ).toUpperCase() + r[t].substring( 1 ); return n[i] && ( i = n[i] ), i }, t.sipErrorCause = function ( e ) { for ( var t in u.SIP_ERROR_CAUSES ) if ( -1 !== u.SIP_ERROR_CAUSES[t].indexOf( e ) ) return u.causes[t]; return u.causes.SIP_FAILURE_CODE }, t.getRandomTestNetIP = function () { return "192.0.2.".concat( ( e = 1, t = 254, Math.floor( Math.random() * ( t - e + 1 ) + e ) ) ); var e, t }, t.calculateMD5 = function ( e ) { function t ( e, t ) { return e << t | e >>> 32 - t } function n ( e, t ) { var n = 2147483648 & e, r = 2147483648 & t, i = 1073741824 & e, o = 1073741824 & t, u = ( 1073741823 & e ) + ( 1073741823 & t ); return i & o ? 2147483648 ^ u ^ n ^ r : i | o ? 1073741824 & u ? 3221225472 ^ u ^ n ^ r : 1073741824 ^ u ^ n ^ r : u ^ n ^ r } function r ( e, r, i, o, u, s, l ) { return e = n( e, n( n( function ( e, t, n ) { return e & t | ~e & n }( r, i, o ), u ), l ) ), n( t( e, s ), r ) } function i ( e, r, i, o, u, s, l ) { return e = n( e, n( n( function ( e, t, n ) { return e & n | t & ~n }( r, i, o ), u ), l ) ), n( t( e, s ), r ) } function o ( e, r, i, o, u, s, l ) { return e = n( e, n( n( function ( e, t, n ) { return e ^ t ^ n }( r, i, o ), u ), l ) ), n( t( e, s ), r ) } function u ( e, r, i, o, u, s, l ) { return e = n( e, n( n( function ( e, t, n ) { return t ^ ( e | ~n ) }( r, i, o ), u ), l ) ), n( t( e, s ), r ) } function s ( e ) { var t, n = "", r = ""; for ( t = 0; t <= 3; t++ )n += ( r = "0".concat( ( e >>> 8 * t & 255 ).toString( 16 ) ) ).substr( r.length - 2, 2 ); return n } var l, a, c, f, h, d, _, p, v, m; for ( l = function ( e ) { for ( var t, n = e.length, r = n + 8, i = 16 * ( ( r - r % 64 ) / 64 + 1 ), o = new Array( i - 1 ), u = 0, s = 0; s < n; )u = s % 4 * 8, o[t = ( s - s % 4 ) / 4] = o[t] | e.charCodeAt( s ) << u, s++; return u = s % 4 * 8, o[t = ( s - s % 4 ) / 4] = o[t] | 128 << u, o[i - 2] = n << 3, o[i - 1] = n >>> 29, o }( e = function ( e ) { e = e.replace( /\r\n/g, "\n" ); for ( var t = "", n = 0; n < e.length; n++ ) { var r = e.charCodeAt( n ); r < 128 ? t += String.fromCharCode( r ) : r > 127 && r < 2048 ? ( t += String.fromCharCode( r >> 6 | 192 ), t += String.fromCharCode( 63 & r | 128 ) ) : ( t += String.fromCharCode( r >> 12 | 224 ), t += String.fromCharCode( r >> 6 & 63 | 128 ), t += String.fromCharCode( 63 & r | 128 ) ) } return t }( e ) ), _ = 1732584193, p = 4023233417, v = 2562383102, m = 271733878, a = 0; a < l.length; a += 16 )c = _, f = p, h = v, d = m, _ = r( _, p, v, m, l[a + 0], 7, 3614090360 ), m = r( m, _, p, v, l[a + 1], 12, 3905402710 ), v = r( v, m, _, p, l[a + 2], 17, 606105819 ), p = r( p, v, m, _, l[a + 3], 22, 3250441966 ), _ = r( _, p, v, m, l[a + 4], 7, 4118548399 ), m = r( m, _, p, v, l[a + 5], 12, 1200080426 ), v = r( v, m, _, p, l[a + 6], 17, 2821735955 ), p = r( p, v, m, _, l[a + 7], 22, 4249261313 ), _ = r( _, p, v, m, l[a + 8], 7, 1770035416 ), m = r( m, _, p, v, l[a + 9], 12, 2336552879 ), v = r( v, m, _, p, l[a + 10], 17, 4294925233 ), p = r( p, v, m, _, l[a + 11], 22, 2304563134 ), _ = r( _, p, v, m, l[a + 12], 7, 1804603682 ), m = r( m, _, p, v, l[a + 13], 12, 4254626195 ), v = r( v, m, _, p, l[a + 14], 17, 2792965006 ), _ = i( _, p = r( p, v, m, _, l[a + 15], 22, 1236535329 ), v, m, l[a + 1], 5, 4129170786 ), m = i( m, _, p, v, l[a + 6], 9, 3225465664 ), v = i( v, m, _, p, l[a + 11], 14, 643717713 ), p = i( p, v, m, _, l[a + 0], 20, 3921069994 ), _ = i( _, p, v, m, l[a + 5], 5, 3593408605 ), m = i( m, _, p, v, l[a + 10], 9, 38016083 ), v = i( v, m, _, p, l[a + 15], 14, 3634488961 ), p = i( p, v, m, _, l[a + 4], 20, 3889429448 ), _ = i( _, p, v, m, l[a + 9], 5, 568446438 ), m = i( m, _, p, v, l[a + 14], 9, 3275163606 ), v = i( v, m, _, p, l[a + 3], 14, 4107603335 ), p = i( p, v, m, _, l[a + 8], 20, 1163531501 ), _ = i( _, p, v, m, l[a + 13], 5, 2850285829 ), m = i( m, _, p, v, l[a + 2], 9, 4243563512 ), v = i( v, m, _, p, l[a + 7], 14, 1735328473 ), _ = o( _, p = i( p, v, m, _, l[a + 12], 20, 2368359562 ), v, m, l[a + 5], 4, 4294588738 ), m = o( m, _, p, v, l[a + 8], 11, 2272392833 ), v = o( v, m, _, p, l[a + 11], 16, 1839030562 ), p = o( p, v, m, _, l[a + 14], 23, 4259657740 ), _ = o( _, p, v, m, l[a + 1], 4, 2763975236 ), m = o( m, _, p, v, l[a + 4], 11, 1272893353 ), v = o( v, m, _, p, l[a + 7], 16, 4139469664 ), p = o( p, v, m, _, l[a + 10], 23, 3200236656 ), _ = o( _, p, v, m, l[a + 13], 4, 681279174 ), m = o( m, _, p, v, l[a + 0], 11, 3936430074 ), v = o( v, m, _, p, l[a + 3], 16, 3572445317 ), p = o( p, v, m, _, l[a + 6], 23, 76029189 ), _ = o( _, p, v, m, l[a + 9], 4, 3654602809 ), m = o( m, _, p, v, l[a + 12], 11, 3873151461 ), v = o( v, m, _, p, l[a + 15], 16, 530742520 ), _ = u( _, p = o( p, v, m, _, l[a + 2], 23, 3299628645 ), v, m, l[a + 0], 6, 4096336452 ), m = u( m, _, p, v, l[a + 7], 10, 1126891415 ), v = u( v, m, _, p, l[a + 14], 15, 2878612391 ), p = u( p, v, m, _, l[a + 5], 21, 4237533241 ), _ = u( _, p, v, m, l[a + 12], 6, 1700485571 ), m = u( m, _, p, v, l[a + 3], 10, 2399980690 ), v = u( v, m, _, p, l[a + 10], 15, 4293915773 ), p = u( p, v, m, _, l[a + 1], 21, 2240044497 ), _ = u( _, p, v, m, l[a + 8], 6, 1873313359 ), m = u( m, _, p, v, l[a + 15], 10, 4264355552 ), v = u( v, m, _, p, l[a + 6], 15, 2734768916 ), p = u( p, v, m, _, l[a + 13], 21, 1309151649 ), _ = u( _, p, v, m, l[a + 4], 6, 4149444226 ), m = u( m, _, p, v, l[a + 11], 10, 3174756917 ), v = u( v, m, _, p, l[a + 2], 15, 718787259 ), p = u( p, v, m, _, l[a + 9], 21, 3951481745 ), _ = n( _, c ), p = n( p, f ), v = n( v, h ), m = n( m, d ); return ( s( _ ) + s( p ) + s( v ) + s( m ) ).toLowerCase() }, t.closeMediaStream = function ( e ) { if ( e ) try { if ( e.getTracks ) { var t, n = i( e.getTracks() ); try { for ( n.s(); !( t = n.n() ).done; ) { t.value.stop() } } catch ( e ) { n.e( e ) } finally { n.f() } } else { var o, u = i( e.getAudioTracks() ); try { for ( u.s(); !( o = u.n() ).done; ) { o.value.stop() } } catch ( e ) { u.e( e ) } finally { u.f() } var s, l = i( e.getVideoTracks() ); try { for ( l.s(); !( s = l.n() ).done; ) { s.value.stop() } } catch ( e ) { l.e( e ) } finally { l.f() } } } catch ( t ) { "function" != typeof e.stop && "object" !== r( e.stop ) || e.stop() } }, t.cloneArray = function ( e ) { return e && e.slice() || [] }, t.cloneObject = function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; return e && Object.assign( {}, e ) || t } }, function ( e, t, n ) { "use strict"; var r = n( 13 ), i = "object" == typeof self && self && self.Object === Object && self, o = r.a || i || Function( "return this" )(); t.a = o }, function ( e, t, n ) { "use strict"; var r, i = "object" == typeof Reflect ? Reflect : null, o = i && "function" == typeof i.apply ? i.apply : function ( e, t, n ) { return Function.prototype.apply.call( e, t, n ) }; r = i && "function" == typeof i.ownKeys ? i.ownKeys : Object.getOwnPropertySymbols ? function ( e ) { return Object.getOwnPropertyNames( e ).concat( Object.getOwnPropertySymbols( e ) ) } : function ( e ) { return Object.getOwnPropertyNames( e ) }; var u = Number.isNaN || function ( e ) { return e != e }; function s () { s.init.call( this ) } e.exports = s, e.exports.once = function ( e, t ) { return new Promise( ( function ( n, r ) { function i ( n ) { e.removeListener( t, o ), r( n ) } function o () { "function" == typeof e.removeListener && e.removeListener( "error", i ), n( [].slice.call( arguments ) ) } m( e, t, o, { once: !0 } ), "error" !== t && function ( e, t, n ) { "function" == typeof e.on && m( e, "error", t, n ) }( e, i, { once: !0 } ) } ) ) }, s.EventEmitter = s, s.prototype._events = void 0, s.prototype._eventsCount = 0, s.prototype._maxListeners = void 0; var l = 10; function a ( e ) { if ( "function" != typeof e ) throw new TypeError( 'The "listener" argument must be of type Function. Received type ' + typeof e ) } function c ( e ) { return void 0 === e._maxListeners ? s.defaultMaxListeners : e._maxListeners } function f ( e, t, n, r ) { var i, o, u, s; if ( a( n ), void 0 === ( o = e._events ) ? ( o = e._events = Object.create( null ), e._eventsCount = 0 ) : ( void 0 !== o.newListener && ( e.emit( "newListener", t, n.listener ? n.listener : n ), o = e._events ), u = o[t] ), void 0 === u ) u = o[t] = n, ++e._eventsCount; else if ( "function" == typeof u ? u = o[t] = r ? [n, u] : [u, n] : r ? u.unshift( n ) : u.push( n ), ( i = c( e ) ) > 0 && u.length > i && !u.warned ) { u.warned = !0; var l = new Error( "Possible EventEmitter memory leak detected. " + u.length + " " + String( t ) + " listeners added. Use emitter.setMaxListeners() to increase limit" ); l.name = "MaxListenersExceededWarning", l.emitter = e, l.type = t, l.count = u.length, s = l, console && console.warn && console.warn( s ) } return e } function h () { if ( !this.fired ) return this.target.removeListener( this.type, this.wrapFn ), this.fired = !0, 0 === arguments.length ? this.listener.call( this.target ) : this.listener.apply( this.target, arguments ) } function d ( e, t, n ) { var r = { fired: !1, wrapFn: void 0, target: e, type: t, listener: n }, i = h.bind( r ); return i.listener = n, r.wrapFn = i, i } function _ ( e, t, n ) { var r = e._events; if ( void 0 === r ) return []; var i = r[t]; return void 0 === i ? [] : "function" == typeof i ? n ? [i.listener || i] : [i] : n ? function ( e ) { for ( var t = new Array( e.length ), n = 0; n < t.length; ++n )t[n] = e[n].listener || e[n]; return t }( i ) : v( i, i.length ) } function p ( e ) { var t = this._events; if ( void 0 !== t ) { var n = t[e]; if ( "function" == typeof n ) return 1; if ( void 0 !== n ) return n.length } return 0 } function v ( e, t ) { for ( var n = new Array( t ), r = 0; r < t; ++r )n[r] = e[r]; return n } function m ( e, t, n, r ) { if ( "function" == typeof e.on ) r.once ? e.once( t, n ) : e.on( t, n ); else { if ( "function" != typeof e.addEventListener ) throw new TypeError( 'The "emitter" argument must be of type EventEmitter. Received type ' + typeof e ); e.addEventListener( t, ( function i ( o ) { r.once && e.removeEventListener( t, i ), n( o ) } ) ) } } Object.defineProperty( s, "defaultMaxListeners", { enumerable: !0, get: function () { return l }, set: function ( e ) { if ( "number" != typeof e || e < 0 || u( e ) ) throw new RangeError( 'The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + e + "." ); l = e } } ), s.init = function () { void 0 !== this._events && this._events !== Object.getPrototypeOf( this )._events || ( this._events = Object.create( null ), this._eventsCount = 0 ), this._maxListeners = this._maxListeners || void 0 }, s.prototype.setMaxListeners = function ( e ) { if ( "number" != typeof e || e < 0 || u( e ) ) throw new RangeError( 'The value of "n" is out of range. It must be a non-negative number. Received ' + e + "." ); return this._maxListeners = e, this }, s.prototype.getMaxListeners = function () { return c( this ) }, s.prototype.emit = function ( e ) { for ( var t = [], n = 1; n < arguments.length; n++ )t.push( arguments[n] ); var r = "error" === e, i = this._events; if ( void 0 !== i ) r = r && void 0 === i.error; else if ( !r ) return !1; if ( r ) { var u; if ( t.length > 0 && ( u = t[0] ), u instanceof Error ) throw u; var s = new Error( "Unhandled error." + ( u ? " (" + u.message + ")" : "" ) ); throw s.context = u, s } var l = i[e]; if ( void 0 === l ) return !1; if ( "function" == typeof l ) o( l, this, t ); else { var a = l.length, c = v( l, a ); for ( n = 0; n < a; ++n )o( c[n], this, t ) } return !0 }, s.prototype.addListener = function ( e, t ) { return f( this, e, t, !1 ) }, s.prototype.on = s.prototype.addListener, s.prototype.prependListener = function ( e, t ) { return f( this, e, t, !0 ) }, s.prototype.once = function ( e, t ) { return a( t ), this.on( e, d( this, e, t ) ), this }, s.prototype.prependOnceListener = function ( e, t ) { return a( t ), this.prependListener( e, d( this, e, t ) ), this }, s.prototype.removeListener = function ( e, t ) { var n, r, i, o, u; if ( a( t ), void 0 === ( r = this._events ) ) return this; if ( void 0 === ( n = r[e] ) ) return this; if ( n === t || n.listener === t ) 0 == --this._eventsCount ? this._events = Object.create( null ) : ( delete r[e], r.removeListener && this.emit( "removeListener", e, n.listener || t ) ); else if ( "function" != typeof n ) { for ( i = -1, o = n.length - 1; o >= 0; o-- )if ( n[o] === t || n[o].listener === t ) { u = n[o].listener, i = o; break } if ( i < 0 ) return this; 0 === i ? n.shift() : function ( e, t ) { for ( ; t + 1 < e.length; t++ )e[t] = e[t + 1]; e.pop() }( n, i ), 1 === n.length && ( r[e] = n[0] ), void 0 !== r.removeListener && this.emit( "removeListener", e, u || t ) } return this }, s.prototype.off = s.prototype.removeListener, s.prototype.removeAllListeners = function ( e ) { var t, n, r; if ( void 0 === ( n = this._events ) ) return this; if ( void 0 === n.removeListener ) return 0 === arguments.length ? ( this._events = Object.create( null ), this._eventsCount = 0 ) : void 0 !== n[e] && ( 0 == --this._eventsCount ? this._events = Object.create( null ) : delete n[e] ), this; if ( 0 === arguments.length ) { var i, o = Object.keys( n ); for ( r = 0; r < o.length; ++r )"removeListener" !== ( i = o[r] ) && this.removeAllListeners( i ); return this.removeAllListeners( "removeListener" ), this._events = Object.create( null ), this._eventsCount = 0, this } if ( "function" == typeof ( t = n[e] ) ) this.removeListener( e, t ); else if ( void 0 !== t ) for ( r = t.length - 1; r >= 0; r-- )this.removeListener( e, t[r] ); return this }, s.prototype.listeners = function ( e ) { return _( this, e, !0 ) }, s.prototype.rawListeners = function ( e ) { return _( this, e, !1 ) }, s.listenerCount = function ( e, t ) { return "function" == typeof e.listenerCount ? e.listenerCount( t ) : p.call( e, t ) }, s.prototype.listenerCount = p, s.prototype.eventNames = function () { return this._eventsCount > 0 ? r( this._events ) : [] } }, function ( e, t, n ) { "use strict"; e.exports = function () { function e ( e ) { return '"' + e.replace( /\\/g, "\\\\" ).replace( /"/g, '\\"' ).replace( /\x08/g, "\\b" ).replace( /\t/g, "\\t" ).replace( /\n/g, "\\n" ).replace( /\f/g, "\\f" ).replace( /\r/g, "\\r" ).replace( /[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g, escape ) + '"' } var t = { parse: function ( t, r ) { var i = { CRLF: a, DIGIT: c, ALPHA: f, HEXDIG: h, WSP: d, OCTET: _, DQUOTE: p, SP: v, HTAB: m, alphanum: g, reserved: y, unreserved: b, mark: T, escaped: S, LWS: C, SWS: E, HCOLON: A, TEXT_UTF8_TRIM: w, TEXT_UTF8char: R, UTF8_NONASCII: I, UTF8_CONT: O, LHEX: function () { var e; null === ( e = c() ) && ( /^[a-f]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[a-f]" ) ) ); return e }, token: k, token_nodot: N, separators: function () { var e; 40 === t.charCodeAt( o ) ? ( e = "(", o++ ) : ( e = null, l( '"("' ) ); null === e && ( 41 === t.charCodeAt( o ) ? ( e = ")", o++ ) : ( e = null, l( '")"' ) ), null === e && ( 60 === t.charCodeAt( o ) ? ( e = "<", o++ ) : ( e = null, l( '"<"' ) ), null === e && ( 62 === t.charCodeAt( o ) ? ( e = ">", o++ ) : ( e = null, l( '">"' ) ), null === e && ( 64 === t.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, l( '"@"' ) ), null === e && ( 44 === t.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, l( '","' ) ), null === e && ( 59 === t.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, l( '";"' ) ), null === e && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 92 === t.charCodeAt( o ) ? ( e = "\\", o++ ) : ( e = null, l( '"\\\\"' ) ), null === e && null === ( e = p() ) && ( 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ), null === e && ( 91 === t.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, l( '"["' ) ), null === e && ( 93 === t.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, l( '"]"' ) ), null === e && ( 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null === e && ( 61 === t.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, l( '"="' ) ), null === e && ( 123 === t.charCodeAt( o ) ? ( e = "{", o++ ) : ( e = null, l( '"{"' ) ), null === e && ( 125 === t.charCodeAt( o ) ? ( e = "}", o++ ) : ( e = null, l( '"}"' ) ), null === e && null === ( e = v() ) && ( e = m() ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ); return e }, word: x, STAR: D, SLASH: P, EQUAL: U, LPAREN: j, RPAREN: M, RAQUOT: q, LAQUOT: L, COMMA: F, SEMI: H, COLON: W, LDQUOT: G, RDQUOT: B, comment: function e () { var t, n, r, i; if ( i = o, null !== ( t = j() ) ) { for ( n = [], null === ( r = z() ) && null === ( r = Y() ) && ( r = e() ); null !== r; )n.push( r ), null === ( r = z() ) && null === ( r = Y() ) && ( r = e() ); null !== n && null !== ( r = M() ) ? t = [t, n, r] : ( t = null, o = i ) } else t = null, o = i; return t }, ctext: z, quoted_string: V, quoted_string_clean: $, qdtext: K, quoted_pair: Y, SIP_URI_noparams: J, SIP_URI: X, uri_scheme: Q, uri_scheme_sips: Z, uri_scheme_sip: ee, userinfo: te, user: ne, user_unreserved: re, password: ie, hostport: oe, host: ue, hostname: se, domainlabel: le, toplabel: ae, IPv6reference: ce, IPv6address: fe, h16: he, ls32: de, IPv4address: _e, dec_octet: pe, port: ve, uri_parameters: me, uri_parameter: ge, transport_param: ye, user_param: be, method_param: Te, ttl_param: Se, maddr_param: Ce, lr_param: Ee, other_param: Ae, pname: we, pvalue: Re, paramchar: Ie, param_unreserved: Oe, headers: ke, header: Ne, hname: xe, hvalue: De, hnv_unreserved: Pe, Request_Response: function () { var e; null === ( e = ct() ) && ( e = Ue() ); return e }, Request_Line: Ue, Request_URI: je, absoluteURI: Me, hier_part: qe, net_path: Le, abs_path: Fe, opaque_part: He, uric: We, uric_no_slash: Ge, path_segments: Be, segment: ze, param: Ve, pchar: $e, scheme: Ke, authority: Ye, srvr: Je, reg_name: Xe, query: Qe, SIP_Version: Ze, INVITEm: et, ACKm: tt, OPTIONSm: nt, BYEm: rt, CANCELm: it, REGISTERm: ot, SUBSCRIBEm: ut, NOTIFYm: st, REFERm: lt, Method: at, Status_Line: ct, Status_Code: ft, extension_code: ht, Reason_Phrase: dt, Allow_Events: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = Mt() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = Mt() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = Mt() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Call_ID: function () { var e, n, r, i, u, s; i = o, u = o, null !== ( e = x() ) ? ( s = o, 64 === t.charCodeAt( o ) ? ( n = "@", o++ ) : ( n = null, l( '"@"' ) ), null !== n && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = u ) ) : ( e = null, o = u ); null !== e && ( e = function ( e ) { Fn = t.substring( o, e ) }( i ) ); null === e && ( o = i ); return e }, Contact: function () { var e, t, n, r, i, u, s; if ( i = o, null === ( e = D() ) ) if ( u = o, null !== ( e = _t() ) ) { for ( t = [], s = o, null !== ( n = F() ) && null !== ( r = _t() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = F() ) && null !== ( r = _t() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( e = function ( e ) { var t, n; for ( n = Fn.multi_header.length, t = 0; t < n; t++ )if ( null === Fn.multi_header[t].parsed ) { Fn = null; break } Fn = null !== Fn ? Fn.multi_header : -1 }() ); null === e && ( o = i ); return e }, contact_param: _t, name_addr: pt, display_name: vt, contact_params: mt, c_p_q: gt, c_p_expires: yt, delta_seconds: bt, qvalue: Tt, generic_param: St, gen_value: Ct, Content_Disposition: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = Et() ) ) { for ( t = [], u = o, null !== ( n = H() ) && null !== ( r = At() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = H() ) && null !== ( r = At() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, disp_type: Et, disp_param: At, handling_param: wt, Content_Encoding: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = k() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Content_Length: function () { var e, t, n; if ( n = o, null !== ( t = c() ) ) for ( e = []; null !== t; )e.push( t ), t = c(); else e = null; null !== e && ( e = void ( Fn = parseInt( e.join( "" ) ) ) ); null === e && ( o = n ); return e }, Content_Type: function () { var e, n; n = o, null !== ( e = Rt() ) && ( e = function ( e ) { Fn = t.substring( o, e ) }( n ) ); null === e && ( o = n ); return e }, media_type: Rt, m_type: It, discrete_type: Ot, composite_type: kt, extension_token: Nt, x_token: xt, m_subtype: Dt, m_parameter: Pt, m_value: Ut, CSeq: function () { var e, t, n, r; r = o, null !== ( e = jt() ) && null !== ( t = C() ) && null !== ( n = at() ) ? e = [e, t, n] : ( e = null, o = r ); return e }, CSeq_value: jt, Expires: function () { var e, t; t = o, null !== ( e = bt() ) && ( e = void ( Fn = e ) ); null === e && ( o = t ); return e }, Event: function () { var e, t, n, r, i, u, s; if ( i = o, u = o, null !== ( e = Mt() ) ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( l = e[0], e = void ( Fn.event = l.join( "" ).toLowerCase() ) ); var l; null === e && ( o = i ); return e }, event_type: Mt, From: function () { var e, t, n, r, i, u, s; i = o, u = o, null === ( e = J() ) && ( e = pt() ); if ( null !== e ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = qt() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = qt() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( e = function ( e ) { var t = Fn.tag; try { Fn = new Ln( Fn.uri, Fn.display_name, Fn.params ), t && Fn.setParam( "tag", t ) } catch ( e ) { Fn = -1 } }() ); null === e && ( o = i ); return e }, from_param: qt, tag_param: Lt, Max_Forwards: function () { var e, t, n; if ( n = o, null !== ( t = c() ) ) for ( e = []; null !== t; )e.push( t ), t = c(); else e = null; null !== e && ( e = void ( Fn = parseInt( e.join( "" ) ) ) ); null === e && ( o = n ); return e }, Min_Expires: function () { var e, t; t = o, null !== ( e = bt() ) && ( e = void ( Fn = e ) ); null === e && ( o = t ); return e }, Name_Addr_Header: function () { var e, t, n, r, i, u, s, l, a, c; l = o, a = o, e = [], t = vt(); for ( ; null !== t; )e.push( t ), t = vt(); if ( null !== e ) if ( null !== ( t = L() ) ) if ( null !== ( n = X() ) ) if ( null !== ( r = q() ) ) { for ( i = [], c = o, null !== ( u = H() ) && null !== ( s = St() ) ? u = [u, s] : ( u = null, o = c ); null !== u; )i.push( u ), c = o, null !== ( u = H() ) && null !== ( s = St() ) ? u = [u, s] : ( u = null, o = c ); null !== i ? e = [e, t, n, r, i] : ( e = null, o = a ) } else e = null, o = a; else e = null, o = a; else e = null, o = a; else e = null, o = a; null !== e && ( e = function ( e ) { try { Fn = new Ln( Fn.uri, Fn.display_name, Fn.params ) } catch ( e ) { Fn = -1 } }() ); null === e && ( o = l ); return e }, Proxy_Authenticate: function () { return Ft() }, challenge: Ft, other_challenge: Ht, auth_param: Wt, digest_cln: Gt, realm: Bt, realm_value: zt, domain: Vt, URI: $t, nonce: Kt, nonce_value: Yt, opaque: Jt, stale: Xt, algorithm: Qt, qop_options: Zt, qop_value: en, Proxy_Require: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = k() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Record_Route: function () { var e, t, n, r, i, u, s; if ( i = o, u = o, null !== ( e = tn() ) ) { for ( t = [], s = o, null !== ( n = F() ) && null !== ( r = tn() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = F() ) && null !== ( r = tn() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( e = function ( e ) { var t, n; for ( n = Fn.multi_header.length, t = 0; t < n; t++ )if ( null === Fn.multi_header[t].parsed ) { Fn = null; break } Fn = null !== Fn ? Fn.multi_header : -1 }() ); null === e && ( o = i ); return e }, rec_route: tn, Reason: function () { var e, n, r, i, u, s, a; u = o, s = o, "sip" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"SIP"' ) ); null === e && ( e = k() ); if ( null !== e ) { for ( n = [], a = o, null !== ( r = H() ) && null !== ( i = nn() ) ? r = [r, i] : ( r = null, o = a ); null !== r; )n.push( r ), a = o, null !== ( r = H() ) && null !== ( i = nn() ) ? r = [r, i] : ( r = null, o = a ); null !== n ? e = [e, n] : ( e = null, o = s ) } else e = null, o = s; null !== e && ( e = function ( e, t ) { if ( Fn.protocol = t.toLowerCase(), Fn.params || ( Fn.params = {} ), Fn.params.text && '"' === Fn.params.text[0] ) { var n = Fn.params.text; Fn.text = n.substring( 1, n.length - 1 ), delete Fn.params.text } }( 0, e[0] ) ); null === e && ( o = u ); return e }, reason_param: nn, reason_cause: rn, Require: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = k() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, Route: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = on() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = on() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = on() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, route_param: on, Subscription_State: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = un() ) ) { for ( t = [], u = o, null !== ( n = H() ) && null !== ( r = sn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = H() ) && null !== ( r = sn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, substate_value: un, subexp_params: sn, event_reason_value: ln, Subject: function () { var e; return e = null !== ( e = w() ) ? e : "" }, Supported: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = k() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e = null !== e ? e : "" }, To: function () { var e, t, n, r, i, u, s; i = o, u = o, null === ( e = J() ) && ( e = pt() ); if ( null !== e ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = an() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = an() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( e = function ( e ) { var t = Fn.tag; try { Fn = new Ln( Fn.uri, Fn.display_name, Fn.params ), t && Fn.setParam( "tag", t ) } catch ( e ) { Fn = -1 } }() ); null === e && ( o = i ); return e }, to_param: an, Via: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = cn() ) ) { for ( t = [], u = o, null !== ( n = F() ) && null !== ( r = cn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = F() ) && null !== ( r = cn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, via_param: cn, via_params: fn, via_ttl: hn, via_maddr: dn, via_received: _n, via_branch: pn, response_port: vn, rport: mn, sent_protocol: gn, protocol_name: yn, transport: bn, sent_by: Tn, via_host: Sn, via_port: Cn, ttl: En, WWW_Authenticate: function () { return Ft() }, Session_Expires: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = An() ) ) { for ( t = [], u = o, null !== ( n = H() ) && null !== ( r = wn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = H() ) && null !== ( r = wn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, s_e_expires: An, s_e_params: wn, s_e_refresher: Rn, extension_header: function () { var e, t, n, r; r = o, null !== ( e = k() ) && null !== ( t = A() ) && null !== ( n = In() ) ? e = [e, t, n] : ( e = null, o = r ); return e }, header_value: In, message_body: function () { var e, t; e = [], t = _(); for ( ; null !== t; )e.push( t ), t = _(); return e }, uuid_URI: function () { var e, n, r; r = o, "uuid:" === t.substr( o, 5 ) ? ( e = "uuid:", o += 5 ) : ( e = null, l( '"uuid:"' ) ); null !== e && null !== ( n = On() ) ? e = [e, n] : ( e = null, o = r ); return e }, uuid: On, hex4: kn, hex8: Nn, hex12: xn, Refer_To: function () { var e, t, n, r, i, u, s; i = o, u = o, null === ( e = J() ) && ( e = pt() ); if ( null !== e ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; null !== e && ( e = function ( e ) { try { Fn = new Ln( Fn.uri, Fn.display_name, Fn.params ) } catch ( e ) { Fn = -1 } }() ); null === e && ( o = i ); return e }, Replaces: function () { var e, t, n, r, i, u; if ( i = o, null !== ( e = Dn() ) ) { for ( t = [], u = o, null !== ( n = H() ) && null !== ( r = Pn() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = H() ) && null !== ( r = Pn() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e }, call_id: Dn, replaces_param: Pn, to_tag: Un, from_tag: jn, early_flag: Mn }; if ( void 0 !== r ) { if ( void 0 === i[r] ) throw new Error( "Invalid rule name: " + e( r ) + "." ) } else r = "CRLF"; var o = 0, u = 0, s = []; function l ( e ) { o < u || ( o > u && ( u = o, s = [] ), s.push( e ) ) } function a () { var e; return "\r\n" === t.substr( o, 2 ) ? ( e = "\r\n", o += 2 ) : ( e = null, l( '"\\r\\n"' ) ), e } function c () { var e; return /^[0-9]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[0-9]" ) ), e } function f () { var e; return /^[a-zA-Z]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[a-zA-Z]" ) ), e } function h () { var e; return /^[0-9a-fA-F]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[0-9a-fA-F]" ) ), e } function d () { var e; return null === ( e = v() ) && ( e = m() ), e } function _ () { var e; return /^[\0-\xFF]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[\\0-\\xFF]" ) ), e } function p () { var e; return /^["]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( '["]' ) ), e } function v () { var e; return 32 === t.charCodeAt( o ) ? ( e = " ", o++ ) : ( e = null, l( '" "' ) ), e } function m () { var e; return 9 === t.charCodeAt( o ) ? ( e = "\t", o++ ) : ( e = null, l( '"\\t"' ) ), e } function g () { var e; return /^[a-zA-Z0-9]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[a-zA-Z0-9]" ) ), e } function y () { var e; return 59 === t.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, l( '";"' ) ), null === e && ( 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ), null === e && ( 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null === e && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 64 === t.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, l( '"@"' ) ), null === e && ( 38 === t.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, l( '"&"' ) ), null === e && ( 61 === t.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, l( '"="' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ), null === e && ( 44 === t.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, l( '","' ) ) ) ) ) ) ) ) ) ) ), e } function b () { var e; return null === ( e = g() ) && ( e = T() ), e } function T () { var e; return 45 === t.charCodeAt( o ) ? ( e = "-", o++ ) : ( e = null, l( '"-"' ) ), null === e && ( 95 === t.charCodeAt( o ) ? ( e = "_", o++ ) : ( e = null, l( '"_"' ) ), null === e && ( 46 === t.charCodeAt( o ) ? ( e = ".", o++ ) : ( e = null, l( '"."' ) ), null === e && ( 33 === t.charCodeAt( o ) ? ( e = "!", o++ ) : ( e = null, l( '"!"' ) ), null === e && ( 126 === t.charCodeAt( o ) ? ( e = "~", o++ ) : ( e = null, l( '"~"' ) ), null === e && ( 42 === t.charCodeAt( o ) ? ( e = "*", o++ ) : ( e = null, l( '"*"' ) ), null === e && ( 39 === t.charCodeAt( o ) ? ( e = "'", o++ ) : ( e = null, l( '"\'"' ) ), null === e && ( 40 === t.charCodeAt( o ) ? ( e = "(", o++ ) : ( e = null, l( '"("' ) ), null === e && ( 41 === t.charCodeAt( o ) ? ( e = ")", o++ ) : ( e = null, l( '")"' ) ) ) ) ) ) ) ) ) ), e } function S () { var e, n, r, i, u; return i = o, u = o, 37 === t.charCodeAt( o ) ? ( e = "%", o++ ) : ( e = null, l( '"%"' ) ), null !== e && null !== ( n = h() ) && null !== ( r = h() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( e = e.join( "" ) ), null === e && ( o = i ), e } function C () { var e, t, n, r, i, u; for ( r = o, i = o, u = o, e = [], t = d(); null !== t; )e.push( t ), t = d(); if ( null !== e && null !== ( t = a() ) ? e = [e, t] : ( e = null, o = u ), null !== ( e = null !== e ? e : "" ) ) { if ( null !== ( n = d() ) ) for ( t = []; null !== n; )t.push( n ), n = d(); else t = null; null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return null !== e && ( e = " " ), null === e && ( o = r ), e } function E () { var e; return e = null !== ( e = C() ) ? e : "" } function A () { var e, n, r, i, u; for ( i = o, u = o, e = [], null === ( n = v() ) && ( n = m() ); null !== n; )e.push( n ), null === ( n = v() ) && ( n = m() ); return null !== e ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ":" ), null === e && ( o = i ), e } function w () { var e, n, r, i, u, s, l; if ( u = o, s = o, null !== ( n = R() ) ) for ( e = []; null !== n; )e.push( n ), n = R(); else e = null; if ( null !== e ) { for ( n = [], l = o, r = [], i = C(); null !== i; )r.push( i ), i = C(); for ( null !== r && null !== ( i = R() ) ? r = [r, i] : ( r = null, o = l ); null !== r; ) { for ( n.push( r ), l = o, r = [], i = C(); null !== i; )r.push( i ), i = C(); null !== r && null !== ( i = R() ) ? r = [r, i] : ( r = null, o = l ) } null !== n ? e = [e, n] : ( e = null, o = s ) } else e = null, o = s; return null !== e && ( e = function ( e ) { return t.substring( o, e ) }( u ) ), null === e && ( o = u ), e } function R () { var e; return /^[!-~]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[!-~]" ) ), null === e && ( e = I() ), e } function I () { var e; return /^[\x80-\uFFFF]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[\\x80-\\uFFFF]" ) ), e } function O () { var e; return /^[\x80-\xBF]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[\\x80-\\xBF]" ) ), e } function k () { var e, n, r; if ( r = o, null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ) ) ) ) ) ) ) ) ) ) ), null !== n ) for ( e = []; null !== n; )e.push( n ), null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( e = function ( e ) { return t.substring( o, e ) }( r ) ), null === e && ( o = r ), e } function N () { var e, n, r; if ( r = o, null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ) ) ) ) ) ) ) ) ) ), null !== n ) for ( e = []; null !== n; )e.push( n ), null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( e = function ( e ) { return t.substring( o, e ) }( r ) ), null === e && ( o = r ), e } function x () { var e, n, r; if ( r = o, null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ), null === n && ( 40 === t.charCodeAt( o ) ? ( n = "(", o++ ) : ( n = null, l( '"("' ) ), null === n && ( 41 === t.charCodeAt( o ) ? ( n = ")", o++ ) : ( n = null, l( '")"' ) ), null === n && ( 60 === t.charCodeAt( o ) ? ( n = "<", o++ ) : ( n = null, l( '"<"' ) ), null === n && ( 62 === t.charCodeAt( o ) ? ( n = ">", o++ ) : ( n = null, l( '">"' ) ), null === n && ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null === n && ( 92 === t.charCodeAt( o ) ? ( n = "\\", o++ ) : ( n = null, l( '"\\\\"' ) ), null === n && null === ( n = p() ) && ( 47 === t.charCodeAt( o ) ? ( n = "/", o++ ) : ( n = null, l( '"/"' ) ), null === n && ( 91 === t.charCodeAt( o ) ? ( n = "[", o++ ) : ( n = null, l( '"["' ) ), null === n && ( 93 === t.charCodeAt( o ) ? ( n = "]", o++ ) : ( n = null, l( '"]"' ) ), null === n && ( 63 === t.charCodeAt( o ) ? ( n = "?", o++ ) : ( n = null, l( '"?"' ) ), null === n && ( 123 === t.charCodeAt( o ) ? ( n = "{", o++ ) : ( n = null, l( '"{"' ) ), null === n && ( 125 === t.charCodeAt( o ) ? ( n = "}", o++ ) : ( n = null, l( '"}"' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ), null !== n ) for ( e = []; null !== n; )e.push( n ), null === ( n = g() ) && ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null === n && ( 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null === n && ( 33 === t.charCodeAt( o ) ? ( n = "!", o++ ) : ( n = null, l( '"!"' ) ), null === n && ( 37 === t.charCodeAt( o ) ? ( n = "%", o++ ) : ( n = null, l( '"%"' ) ), null === n && ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null === n && ( 95 === t.charCodeAt( o ) ? ( n = "_", o++ ) : ( n = null, l( '"_"' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 96 === t.charCodeAt( o ) ? ( n = "`", o++ ) : ( n = null, l( '"`"' ) ), null === n && ( 39 === t.charCodeAt( o ) ? ( n = "'", o++ ) : ( n = null, l( '"\'"' ) ), null === n && ( 126 === t.charCodeAt( o ) ? ( n = "~", o++ ) : ( n = null, l( '"~"' ) ), null === n && ( 40 === t.charCodeAt( o ) ? ( n = "(", o++ ) : ( n = null, l( '"("' ) ), null === n && ( 41 === t.charCodeAt( o ) ? ( n = ")", o++ ) : ( n = null, l( '")"' ) ), null === n && ( 60 === t.charCodeAt( o ) ? ( n = "<", o++ ) : ( n = null, l( '"<"' ) ), null === n && ( 62 === t.charCodeAt( o ) ? ( n = ">", o++ ) : ( n = null, l( '">"' ) ), null === n && ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null === n && ( 92 === t.charCodeAt( o ) ? ( n = "\\", o++ ) : ( n = null, l( '"\\\\"' ) ), null === n && null === ( n = p() ) && ( 47 === t.charCodeAt( o ) ? ( n = "/", o++ ) : ( n = null, l( '"/"' ) ), null === n && ( 91 === t.charCodeAt( o ) ? ( n = "[", o++ ) : ( n = null, l( '"["' ) ), null === n && ( 93 === t.charCodeAt( o ) ? ( n = "]", o++ ) : ( n = null, l( '"]"' ) ), null === n && ( 63 === t.charCodeAt( o ) ? ( n = "?", o++ ) : ( n = null, l( '"?"' ) ), null === n && ( 123 === t.charCodeAt( o ) ? ( n = "{", o++ ) : ( n = null, l( '"{"' ) ), null === n && ( 125 === t.charCodeAt( o ) ? ( n = "}", o++ ) : ( n = null, l( '"}"' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ); else e = null; return null !== e && ( e = function ( e ) { return t.substring( o, e ) }( r ) ), null === e && ( o = r ), e } function D () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 42 === t.charCodeAt( o ) ? ( n = "*", o++ ) : ( n = null, l( '"*"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "*" ), null === e && ( o = i ), e } function P () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 47 === t.charCodeAt( o ) ? ( n = "/", o++ ) : ( n = null, l( '"/"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "/" ), null === e && ( o = i ), e } function U () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "=" ), null === e && ( o = i ), e } function j () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 40 === t.charCodeAt( o ) ? ( n = "(", o++ ) : ( n = null, l( '"("' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "(" ), null === e && ( o = i ), e } function M () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 41 === t.charCodeAt( o ) ? ( n = ")", o++ ) : ( n = null, l( '")"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ")" ), null === e && ( o = i ), e } function q () { var e, n, r, i; return r = o, i = o, 62 === t.charCodeAt( o ) ? ( e = ">", o++ ) : ( e = null, l( '">"' ) ), null !== e && null !== ( n = E() ) ? e = [e, n] : ( e = null, o = i ), null !== e && ( e = ">" ), null === e && ( o = r ), e } function L () { var e, n, r, i; return r = o, i = o, null !== ( e = E() ) ? ( 60 === t.charCodeAt( o ) ? ( n = "<", o++ ) : ( n = null, l( '"<"' ) ), null !== n ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( e = "<" ), null === e && ( o = r ), e } function F () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 44 === t.charCodeAt( o ) ? ( n = ",", o++ ) : ( n = null, l( '","' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = "," ), null === e && ( o = i ), e } function H () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 59 === t.charCodeAt( o ) ? ( n = ";", o++ ) : ( n = null, l( '";"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ";" ), null === e && ( o = i ), e } function W () { var e, n, r, i, u; return i = o, u = o, null !== ( e = E() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = E() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = ":" ), null === e && ( o = i ), e } function G () { var e, t, n, r; return n = o, r = o, null !== ( e = E() ) && null !== ( t = p() ) ? e = [e, t] : ( e = null, o = r ), null !== e && ( e = '"' ), null === e && ( o = n ), e } function B () { var e, t, n, r; return n = o, r = o, null !== ( e = p() ) && null !== ( t = E() ) ? e = [e, t] : ( e = null, o = r ), null !== e && ( e = '"' ), null === e && ( o = n ), e } function z () { var e; return /^[!-']/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[!-']" ) ), null === e && ( /^[*-[]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[*-[]" ) ), null === e && ( /^[\]-~]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[\\]-~]" ) ), null === e && null === ( e = I() ) && ( e = C() ) ) ), e } function V () { var e, n, r, i, u, s; if ( u = o, s = o, null !== ( e = E() ) ) if ( null !== ( n = p() ) ) { for ( r = [], null === ( i = K() ) && ( i = Y() ); null !== i; )r.push( i ), null === ( i = K() ) && ( i = Y() ); null !== r && null !== ( i = p() ) ? e = [e, n, r, i] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; return null !== e && ( e = function ( e ) { return t.substring( o, e ) }( u ) ), null === e && ( o = u ), e } function $ () { var e, n, r, i, u, s; if ( u = o, s = o, null !== ( e = E() ) ) if ( null !== ( n = p() ) ) { for ( r = [], null === ( i = K() ) && ( i = Y() ); null !== i; )r.push( i ), null === ( i = K() ) && ( i = Y() ); null !== r && null !== ( i = p() ) ? e = [e, n, r, i] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; return null !== e && ( e = function ( e ) { var n = t.substring( o, e ).trim(); return n.substring( 1, n.length - 1 ).replace( /\\([\x00-\x09\x0b-\x0c\x0e-\x7f])/g, "$1" ) }( u ) ), null === e && ( o = u ), e } function K () { var e; return null === ( e = C() ) && ( 33 === t.charCodeAt( o ) ? ( e = "!", o++ ) : ( e = null, l( '"!"' ) ), null === e && ( /^[#-[]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[#-[]" ) ), null === e && ( /^[\]-~]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[\\]-~]" ) ), null === e && ( e = I() ) ) ) ), e } function Y () { var e, n, r; return r = o, 92 === t.charCodeAt( o ) ? ( e = "\\", o++ ) : ( e = null, l( '"\\\\"' ) ), null !== e ? ( /^[\0-\t]/.test( t.charAt( o ) ) ? ( n = t.charAt( o ), o++ ) : ( n = null, l( "[\\0-\\t]" ) ), null === n && ( /^[\x0B-\f]/.test( t.charAt( o ) ) ? ( n = t.charAt( o ), o++ ) : ( n = null, l( "[\\x0B-\\f]" ) ), null === n && ( /^[\x0E-]/.test( t.charAt( o ) ) ? ( n = t.charAt( o ), o++ ) : ( n = null, l( "[\\x0E-]" ) ) ) ), null !== n ? e = [e, n] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function J () { var e, n, r, i, u, s; return u = o, s = o, null !== ( e = Q() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = null !== ( r = te() ) ? r : "" ) && null !== ( i = oe() ) ? e = [e, n, r, i] : ( e = null, o = s ) ) : ( e = null, o = s ), null !== e && ( e = function ( e ) { try { Fn.uri = new qn( Fn.scheme, Fn.user, Fn.host, Fn.port ), delete Fn.scheme, delete Fn.user, delete Fn.host, delete Fn.host_type, delete Fn.port } catch ( e ) { Fn = -1 } }() ), null === e && ( o = u ), e } function X () { var e, n, i, u, s, a, c, f; return c = o, f = o, null !== ( e = Q() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( i = null !== ( i = te() ) ? i : "" ) && null !== ( u = oe() ) && null !== ( s = me() ) && null !== ( a = null !== ( a = ke() ) ? a : "" ) ? e = [e, n, i, u, s, a] : ( e = null, o = f ) ) : ( e = null, o = f ), null !== e && ( e = function ( e ) { try { Fn.uri = new qn( Fn.scheme, Fn.user, Fn.host, Fn.port, Fn.uri_params, Fn.uri_headers ), delete Fn.scheme, delete Fn.user, delete Fn.host, delete Fn.host_type, delete Fn.port, delete Fn.uri_params, "SIP_URI" === r && ( Fn = Fn.uri ) } catch ( e ) { Fn = -1 } }() ), null === e && ( o = c ), e } function Q () { var e; return null === ( e = Z() ) && ( e = ee() ), e } function Z () { var e, n, r; return n = o, "sips" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"sips"' ) ), null !== e && ( r = e, e = void ( Fn.scheme = r.toLowerCase() ) ), null === e && ( o = n ), e } function ee () { var e, n, r; return n = o, "sip" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"sip"' ) ), null !== e && ( r = e, e = void ( Fn.scheme = r.toLowerCase() ) ), null === e && ( o = n ), e } function te () { var e, n, r, i, u, s; return i = o, u = o, null !== ( e = ne() ) ? ( s = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = ie() ) ? n = [n, r] : ( n = null, o = s ), null !== ( n = null !== n ? n : "" ) ? ( 64 === t.charCodeAt( o ) ? ( r = "@", o++ ) : ( r = null, l( '"@"' ) ), null !== r ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = function ( e ) { Fn.user = decodeURIComponent( t.substring( o - 1, e ) ) }( i ) ), null === e && ( o = i ), e } function ne () { var e, t; if ( null === ( t = b() ) && null === ( t = S() ) && ( t = re() ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = b() ) && null === ( t = S() ) && ( t = re() ); else e = null; return e } function re () { var e; return 38 === t.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, l( '"&"' ) ), null === e && ( 61 === t.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, l( '"="' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ), null === e && ( 44 === t.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, l( '","' ) ), null === e && ( 59 === t.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, l( '";"' ) ), null === e && ( 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null === e && ( 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ) ) ) ) ) ) ) ), e } function ie () { var e, n, r; for ( r = o, e = [], null === ( n = b() ) && null === ( n = S() ) && ( 38 === t.charCodeAt( o ) ? ( n = "&", o++ ) : ( n = null, l( '"&"' ) ), null === n && ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 36 === t.charCodeAt( o ) ? ( n = "$", o++ ) : ( n = null, l( '"$"' ) ), null === n && ( 44 === t.charCodeAt( o ) ? ( n = ",", o++ ) : ( n = null, l( '","' ) ) ) ) ) ) ); null !== n; )e.push( n ), null === ( n = b() ) && null === ( n = S() ) && ( 38 === t.charCodeAt( o ) ? ( n = "&", o++ ) : ( n = null, l( '"&"' ) ), null === n && ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ), null === n && ( 36 === t.charCodeAt( o ) ? ( n = "$", o++ ) : ( n = null, l( '"$"' ) ), null === n && ( 44 === t.charCodeAt( o ) ? ( n = ",", o++ ) : ( n = null, l( '","' ) ) ) ) ) ) ); return null !== e && ( e = function ( e ) { Fn.password = t.substring( o, e ) }( r ) ), null === e && ( o = r ), e } function oe () { var e, n, r, i, u; return i = o, null !== ( e = ue() ) ? ( u = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = ve() ) ? n = [n, r] : ( n = null, o = u ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function ue () { var e, n; return n = o, null === ( e = se() ) && null === ( e = _e() ) && ( e = ce() ), null !== e && ( e = function ( e ) { return Fn.host = t.substring( o, e ).toLowerCase(), Fn.host }( n ) ), null === e && ( o = n ), e } function se () { var e, n, r, i, u, s; for ( i = o, u = o, e = [], s = o, null !== ( n = le() ) ? ( 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ), null !== r ? n = [n, r] : ( n = null, o = s ) ) : ( n = null, o = s ); null !== n; )e.push( n ), s = o, null !== ( n = le() ) ? ( 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ), null !== r ? n = [n, r] : ( n = null, o = s ) ) : ( n = null, o = s ); return null !== e && null !== ( n = ae() ) ? ( 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ), null !== ( r = null !== r ? r : "" ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = function ( e ) { return Fn.host_type = "domain", t.substring( o, e ) }( i ) ), null === e && ( o = i ), e } function le () { var e, n, r, i; if ( i = o, null !== ( e = g() ) ) { for ( n = [], null === ( r = g() ) && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 95 === t.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, l( '"_"' ) ) ) ); null !== r; )n.push( r ), null === ( r = g() ) && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 95 === t.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, l( '"_"' ) ) ) ); null !== n ? e = [e, n] : ( e = null, o = i ) } else e = null, o = i; return e } function ae () { var e, n, r, i; if ( i = o, null !== ( e = f() ) ) { for ( n = [], null === ( r = g() ) && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 95 === t.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, l( '"_"' ) ) ) ); null !== r; )n.push( r ), null === ( r = g() ) && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 95 === t.charCodeAt( o ) ? ( r = "_", o++ ) : ( r = null, l( '"_"' ) ) ) ); null !== n ? e = [e, n] : ( e = null, o = i ) } else e = null, o = i; return e } function ce () { var e, n, r, i, u; return i = o, u = o, 91 === t.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, l( '"["' ) ), null !== e && null !== ( n = fe() ) ? ( 93 === t.charCodeAt( o ) ? ( r = "]", o++ ) : ( r = null, l( '"]"' ) ), null !== r ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = function ( e ) { return Fn.host_type = "IPv6", t.substring( o, e ) }( i ) ), null === e && ( o = i ), e } function fe () { var e, n, r, i, u, s, a, c, f, h, d, _, p, v, m, g; return v = o, m = o, null !== ( e = he() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? ( 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? ( 58 === t.charCodeAt( o ) ? ( s = ":", o++ ) : ( s = null, l( '":"' ) ), null !== s && null !== ( a = he() ) ? ( 58 === t.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, l( '":"' ) ), null !== c && null !== ( f = he() ) ? ( 58 === t.charCodeAt( o ) ? ( h = ":", o++ ) : ( h = null, l( '":"' ) ), null !== h && null !== ( d = he() ) ? ( 58 === t.charCodeAt( o ) ? ( _ = ":", o++ ) : ( _ = null, l( '":"' ) ), null !== _ && null !== ( p = de() ) ? e = [e, n, r, i, u, s, a, c, f, h, d, _, p] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? ( 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? ( 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? ( 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = he() ) ? ( 58 === t.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, l( '":"' ) ), null !== f && null !== ( h = he() ) ? ( 58 === t.charCodeAt( o ) ? ( d = ":", o++ ) : ( d = null, l( '":"' ) ), null !== d && null !== ( _ = de() ) ? e = [e, n, r, i, u, s, a, c, f, h, d, _] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? ( 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? ( 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? ( 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = he() ) ? ( 58 === t.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, l( '":"' ) ), null !== f && null !== ( h = de() ) ? e = [e, n, r, i, u, s, a, c, f, h] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? ( 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? ( 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? ( 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = de() ) ? e = [e, n, r, i, u, s, a, c] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? ( 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? ( 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = de() ) ? e = [e, n, r, i, u, s] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? ( 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = de() ) ? e = [e, n, r, i] : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = de() ) ? e = [e, n] : ( e = null, o = m ), null === e && ( m = o, "::" === t.substr( o, 2 ) ? ( e = "::", o += 2 ) : ( e = null, l( '"::"' ) ), null !== e && null !== ( n = he() ) ? e = [e, n] : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( "::" === t.substr( o, 2 ) ? ( n = "::", o += 2 ) : ( n = null, l( '"::"' ) ), null !== n && null !== ( r = he() ) ? ( 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? ( 58 === t.charCodeAt( o ) ? ( s = ":", o++ ) : ( s = null, l( '":"' ) ), null !== s && null !== ( a = he() ) ? ( 58 === t.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, l( '":"' ) ), null !== c && null !== ( f = he() ) ? ( 58 === t.charCodeAt( o ) ? ( h = ":", o++ ) : ( h = null, l( '":"' ) ), null !== h && null !== ( d = de() ) ? e = [e, n, r, i, u, s, a, c, f, h, d] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( "::" === t.substr( o, 2 ) ? ( r = "::", o += 2 ) : ( r = null, l( '"::"' ) ), null !== r && null !== ( i = he() ) ? ( 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? ( 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = he() ) ? ( 58 === t.charCodeAt( o ) ? ( f = ":", o++ ) : ( f = null, l( '":"' ) ), null !== f && null !== ( h = de() ) ? e = [e, n, r, i, u, s, a, c, f, h] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? r = [r, i] : ( r = null, o = g ), null !== ( r = null !== r ? r : "" ) ? ( "::" === t.substr( o, 2 ) ? ( i = "::", o += 2 ) : ( i = null, l( '"::"' ) ), null !== i && null !== ( u = he() ) ? ( 58 === t.charCodeAt( o ) ? ( s = ":", o++ ) : ( s = null, l( '":"' ) ), null !== s && null !== ( a = he() ) ? ( 58 === t.charCodeAt( o ) ? ( c = ":", o++ ) : ( c = null, l( '":"' ) ), null !== c && null !== ( f = de() ) ? e = [e, n, r, i, u, s, a, c, f] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? r = [r, i] : ( r = null, o = g ), null !== ( r = null !== r ? r : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? i = [i, u] : ( i = null, o = g ), null !== ( i = null !== i ? i : "" ) ? ( "::" === t.substr( o, 2 ) ? ( u = "::", o += 2 ) : ( u = null, l( '"::"' ) ), null !== u && null !== ( s = he() ) ? ( 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = de() ) ? e = [e, n, r, i, u, s, a, c] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? r = [r, i] : ( r = null, o = g ), null !== ( r = null !== r ? r : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? i = [i, u] : ( i = null, o = g ), null !== ( i = null !== i ? i : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? u = [u, s] : ( u = null, o = g ), null !== ( u = null !== u ? u : "" ) ? ( "::" === t.substr( o, 2 ) ? ( s = "::", o += 2 ) : ( s = null, l( '"::"' ) ), null !== s && null !== ( a = de() ) ? e = [e, n, r, i, u, s, a] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? r = [r, i] : ( r = null, o = g ), null !== ( r = null !== r ? r : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? i = [i, u] : ( i = null, o = g ), null !== ( i = null !== i ? i : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? u = [u, s] : ( u = null, o = g ), null !== ( u = null !== u ? u : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( s = ":", o++ ) : ( s = null, l( '":"' ) ), null !== s && null !== ( a = he() ) ? s = [s, a] : ( s = null, o = g ), null !== ( s = null !== s ? s : "" ) ? ( "::" === t.substr( o, 2 ) ? ( a = "::", o += 2 ) : ( a = null, l( '"::"' ) ), null !== a && null !== ( c = he() ) ? e = [e, n, r, i, u, s, a, c] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ), null === e && ( m = o, null !== ( e = he() ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? n = [n, r] : ( n = null, o = g ), null !== ( n = null !== n ? n : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( r = ":", o++ ) : ( r = null, l( '":"' ) ), null !== r && null !== ( i = he() ) ? r = [r, i] : ( r = null, o = g ), null !== ( r = null !== r ? r : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( i = ":", o++ ) : ( i = null, l( '":"' ) ), null !== i && null !== ( u = he() ) ? i = [i, u] : ( i = null, o = g ), null !== ( i = null !== i ? i : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( u = ":", o++ ) : ( u = null, l( '":"' ) ), null !== u && null !== ( s = he() ) ? u = [u, s] : ( u = null, o = g ), null !== ( u = null !== u ? u : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( s = ":", o++ ) : ( s = null, l( '":"' ) ), null !== s && null !== ( a = he() ) ? s = [s, a] : ( s = null, o = g ), null !== ( s = null !== s ? s : "" ) ? ( g = o, 58 === t.charCodeAt( o ) ? ( a = ":", o++ ) : ( a = null, l( '":"' ) ), null !== a && null !== ( c = he() ) ? a = [a, c] : ( a = null, o = g ), null !== ( a = null !== a ? a : "" ) ? ( "::" === t.substr( o, 2 ) ? ( c = "::", o += 2 ) : ( c = null, l( '"::"' ) ), null !== c ? e = [e, n, r, i, u, s, a, c] : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) : ( e = null, o = m ) ) ) ) ) ) ) ) ) ) ) ) ) ) ), null !== e && ( e = function ( e ) { return Fn.host_type = "IPv6", t.substring( o, e ) }( v ) ), null === e && ( o = v ), e } function he () { var e, t, n, r, i; return i = o, null !== ( e = h() ) && null !== ( t = null !== ( t = h() ) ? t : "" ) && null !== ( n = null !== ( n = h() ) ? n : "" ) && null !== ( r = null !== ( r = h() ) ? r : "" ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function de () { var e, n, r, i; return i = o, null !== ( e = he() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n && null !== ( r = he() ) ? e = [e, n, r] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( e = _e() ), e } function _e () { var e, n, r, i, u, s, a, c, f; return c = o, f = o, null !== ( e = pe() ) ? ( 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null !== n && null !== ( r = pe() ) ? ( 46 === t.charCodeAt( o ) ? ( i = ".", o++ ) : ( i = null, l( '"."' ) ), null !== i && null !== ( u = pe() ) ? ( 46 === t.charCodeAt( o ) ? ( s = ".", o++ ) : ( s = null, l( '"."' ) ), null !== s && null !== ( a = pe() ) ? e = [e, n, r, i, u, s, a] : ( e = null, o = f ) ) : ( e = null, o = f ) ) : ( e = null, o = f ) ) : ( e = null, o = f ), null !== e && ( e = function ( e ) { return Fn.host_type = "IPv4", t.substring( o, e ) }( c ) ), null === e && ( o = c ), e } function pe () { var e, n, r, i; return i = o, "25" === t.substr( o, 2 ) ? ( e = "25", o += 2 ) : ( e = null, l( '"25"' ) ), null !== e ? ( /^[0-5]/.test( t.charAt( o ) ) ? ( n = t.charAt( o ), o++ ) : ( n = null, l( "[0-5]" ) ), null !== n ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( i = o, 50 === t.charCodeAt( o ) ? ( e = "2", o++ ) : ( e = null, l( '"2"' ) ), null !== e ? ( /^[0-4]/.test( t.charAt( o ) ) ? ( n = t.charAt( o ), o++ ) : ( n = null, l( "[0-4]" ) ), null !== n && null !== ( r = c() ) ? e = [e, n, r] : ( e = null, o = i ) ) : ( e = null, o = i ), null === e && ( i = o, 49 === t.charCodeAt( o ) ? ( e = "1", o++ ) : ( e = null, l( '"1"' ) ), null !== e && null !== ( n = c() ) && null !== ( r = c() ) ? e = [e, n, r] : ( e = null, o = i ), null === e && ( i = o, /^[1-9]/.test( t.charAt( o ) ) ? ( e = t.charAt( o ), o++ ) : ( e = null, l( "[1-9]" ) ), null !== e && null !== ( n = c() ) ? e = [e, n] : ( e = null, o = i ), null === e && ( e = c() ) ) ) ), e } function ve () { var e, t, n, r, i, u, s, l; return u = o, s = o, null !== ( e = null !== ( e = c() ) ? e : "" ) && null !== ( t = null !== ( t = c() ) ? t : "" ) && null !== ( n = null !== ( n = c() ) ? n : "" ) && null !== ( r = null !== ( r = c() ) ? r : "" ) && null !== ( i = null !== ( i = c() ) ? i : "" ) ? e = [e, t, n, r, i] : ( e = null, o = s ), null !== e && ( l = e, l = parseInt( l.join( "" ) ), Fn.port = l, e = l ), null === e && ( o = u ), e } function me () { var e, n, r, i; for ( e = [], i = o, 59 === t.charCodeAt( o ) ? ( n = ";", o++ ) : ( n = null, l( '";"' ) ), null !== n && null !== ( r = ge() ) ? n = [n, r] : ( n = null, o = i ); null !== n; )e.push( n ), i = o, 59 === t.charCodeAt( o ) ? ( n = ";", o++ ) : ( n = null, l( '";"' ) ), null !== n && null !== ( r = ge() ) ? n = [n, r] : ( n = null, o = i ); return e } function ge () { var e; return null === ( e = ye() ) && null === ( e = be() ) && null === ( e = Te() ) && null === ( e = Se() ) && null === ( e = Ce() ) && null === ( e = Ee() ) && ( e = Ae() ), e } function ye () { var e, n, r, i, u; return r = o, i = o, "transport=" === t.substr( o, 10 ).toLowerCase() ? ( e = t.substr( o, 10 ), o += 10 ) : ( e = null, l( '"transport="' ) ), null !== e ? ( "udp" === t.substr( o, 3 ).toLowerCase() ? ( n = t.substr( o, 3 ), o += 3 ) : ( n = null, l( '"udp"' ) ), null === n && ( "tcp" === t.substr( o, 3 ).toLowerCase() ? ( n = t.substr( o, 3 ), o += 3 ) : ( n = null, l( '"tcp"' ) ), null === n && ( "sctp" === t.substr( o, 4 ).toLowerCase() ? ( n = t.substr( o, 4 ), o += 4 ) : ( n = null, l( '"sctp"' ) ), null === n && ( "tls" === t.substr( o, 3 ).toLowerCase() ? ( n = t.substr( o, 3 ), o += 3 ) : ( n = null, l( '"tls"' ) ), null === n && ( n = k() ) ) ) ), null !== n ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.transport = u.toLowerCase() ) ), null === e && ( o = r ), e } function be () { var e, n, r, i, u; return r = o, i = o, "user=" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"user="' ) ), null !== e ? ( "phone" === t.substr( o, 5 ).toLowerCase() ? ( n = t.substr( o, 5 ), o += 5 ) : ( n = null, l( '"phone"' ) ), null === n && ( "ip" === t.substr( o, 2 ).toLowerCase() ? ( n = t.substr( o, 2 ), o += 2 ) : ( n = null, l( '"ip"' ) ), null === n && ( n = k() ) ), null !== n ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.user = u.toLowerCase() ) ), null === e && ( o = r ), e } function Te () { var e, n, r, i, u; return r = o, i = o, "method=" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"method="' ) ), null !== e && null !== ( n = at() ) ? e = [e, n] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.method = u ) ), null === e && ( o = r ), e } function Se () { var e, n, r, i, u; return r = o, i = o, "ttl=" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"ttl="' ) ), null !== e && null !== ( n = En() ) ? e = [e, n] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.ttl = u ) ), null === e && ( o = r ), e } function Ce () { var e, n, r, i, u; return r = o, i = o, "maddr=" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"maddr="' ) ), null !== e && null !== ( n = ue() ) ? e = [e, n] : ( e = null, o = i ), null !== e && ( u = e[1], Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.maddr = u ) ), null === e && ( o = r ), e } function Ee () { var e, n, r, i, u, s; return i = o, u = o, "lr" === t.substr( o, 2 ).toLowerCase() ? ( e = t.substr( o, 2 ), o += 2 ) : ( e = null, l( '"lr"' ) ), null !== e ? ( s = o, 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null !== n && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = s ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( Fn.uri_params || ( Fn.uri_params = {} ), e = void ( Fn.uri_params.lr = void 0 ) ), null === e && ( o = i ), e } function Ae () { var e, n, r, i, u, s, a, c; return i = o, u = o, null !== ( e = we() ) ? ( s = o, 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null !== n && null !== ( r = Re() ) ? n = [n, r] : ( n = null, o = s ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( a = e[0], c = e[1], Fn.uri_params || ( Fn.uri_params = {} ), c = void 0 === c ? void 0 : c[1], e = void ( Fn.uri_params[a.toLowerCase()] = c ) ), null === e && ( o = i ), e } function we () { var e, t, n; if ( n = o, null !== ( t = Ie() ) ) for ( e = []; null !== t; )e.push( t ), t = Ie(); else e = null; return null !== e && ( e = e.join( "" ) ), null === e && ( o = n ), e } function Re () { var e, t, n; if ( n = o, null !== ( t = Ie() ) ) for ( e = []; null !== t; )e.push( t ), t = Ie(); else e = null; return null !== e && ( e = e.join( "" ) ), null === e && ( o = n ), e } function Ie () { var e; return null === ( e = Oe() ) && null === ( e = b() ) && ( e = S() ), e } function Oe () { var e; return 91 === t.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, l( '"["' ) ), null === e && ( 93 === t.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, l( '"]"' ) ), null === e && ( 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ), null === e && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 38 === t.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, l( '"&"' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ) ) ) ) ) ) ), e } function ke () { var e, n, r, i, u, s, a; if ( s = o, 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null !== e ) if ( null !== ( n = Ne() ) ) { for ( r = [], a = o, 38 === t.charCodeAt( o ) ? ( i = "&", o++ ) : ( i = null, l( '"&"' ) ), null !== i && null !== ( u = Ne() ) ? i = [i, u] : ( i = null, o = a ); null !== i; )r.push( i ), a = o, 38 === t.charCodeAt( o ) ? ( i = "&", o++ ) : ( i = null, l( '"&"' ) ), null !== i && null !== ( u = Ne() ) ? i = [i, u] : ( i = null, o = a ); null !== r ? e = [e, n, r] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; return e } function Ne () { var e, n, r, i, u, s, a; return i = o, u = o, null !== ( e = xe() ) ? ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null !== n && null !== ( r = De() ) ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( s = e[0], a = e[2], s = s.join( "" ).toLowerCase(), a = a.join( "" ), Fn.uri_headers || ( Fn.uri_headers = {} ), e = void ( Fn.uri_headers[s] ? Fn.uri_headers[s].push( a ) : Fn.uri_headers[s] = [a] ) ), null === e && ( o = i ), e } function xe () { var e, t; if ( null === ( t = Pe() ) && null === ( t = b() ) && ( t = S() ), null !== t ) for ( e = []; null !== t; )e.push( t ), null === ( t = Pe() ) && null === ( t = b() ) && ( t = S() ); else e = null; return e } function De () { var e, t; for ( e = [], null === ( t = Pe() ) && null === ( t = b() ) && ( t = S() ); null !== t; )e.push( t ), null === ( t = Pe() ) && null === ( t = b() ) && ( t = S() ); return e } function Pe () { var e; return 91 === t.charCodeAt( o ) ? ( e = "[", o++ ) : ( e = null, l( '"["' ) ), null === e && ( 93 === t.charCodeAt( o ) ? ( e = "]", o++ ) : ( e = null, l( '"]"' ) ), null === e && ( 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ), null === e && ( 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null === e && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ) ) ) ) ) ) ), e } function Ue () { var e, t, n, r, i, u; return u = o, null !== ( e = at() ) && null !== ( t = v() ) && null !== ( n = je() ) && null !== ( r = v() ) && null !== ( i = Ze() ) ? e = [e, t, n, r, i] : ( e = null, o = u ), e } function je () { var e; return null === ( e = X() ) && ( e = Me() ), e } function Me () { var e, n, r, i; return i = o, null !== ( e = Ke() ) ? ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null !== n ? ( null === ( r = qe() ) && ( r = He() ), null !== r ? e = [e, n, r] : ( e = null, o = i ) ) : ( e = null, o = i ) ) : ( e = null, o = i ), e } function qe () { var e, n, r, i, u; return i = o, null === ( e = Le() ) && ( e = Fe() ), null !== e ? ( u = o, 63 === t.charCodeAt( o ) ? ( n = "?", o++ ) : ( n = null, l( '"?"' ) ), null !== n && null !== ( r = Qe() ) ? n = [n, r] : ( n = null, o = u ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function Le () { var e, n, r, i; return i = o, "//" === t.substr( o, 2 ) ? ( e = "//", o += 2 ) : ( e = null, l( '"//"' ) ), null !== e && null !== ( n = Ye() ) && null !== ( r = null !== ( r = Fe() ) ? r : "" ) ? e = [e, n, r] : ( e = null, o = i ), e } function Fe () { var e, n, r; return r = o, 47 === t.charCodeAt( o ) ? ( e = "/", o++ ) : ( e = null, l( '"/"' ) ), null !== e && null !== ( n = Be() ) ? e = [e, n] : ( e = null, o = r ), e } function He () { var e, t, n, r; if ( r = o, null !== ( e = Ge() ) ) { for ( t = [], n = We(); null !== n; )t.push( n ), n = We(); null !== t ? e = [e, t] : ( e = null, o = r ) } else e = null, o = r; return e } function We () { var e; return null === ( e = y() ) && null === ( e = b() ) && ( e = S() ), e } function Ge () { var e; return null === ( e = b() ) && null === ( e = S() ) && ( 59 === t.charCodeAt( o ) ? ( e = ";", o++ ) : ( e = null, l( '";"' ) ), null === e && ( 63 === t.charCodeAt( o ) ? ( e = "?", o++ ) : ( e = null, l( '"?"' ) ), null === e && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 64 === t.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, l( '"@"' ) ), null === e && ( 38 === t.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, l( '"&"' ) ), null === e && ( 61 === t.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, l( '"="' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ), null === e && ( 44 === t.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, l( '","' ) ) ) ) ) ) ) ) ) ) ), e } function Be () { var e, n, r, i, u, s; if ( u = o, null !== ( e = ze() ) ) { for ( n = [], s = o, 47 === t.charCodeAt( o ) ? ( r = "/", o++ ) : ( r = null, l( '"/"' ) ), null !== r && null !== ( i = ze() ) ? r = [r, i] : ( r = null, o = s ); null !== r; )n.push( r ), s = o, 47 === t.charCodeAt( o ) ? ( r = "/", o++ ) : ( r = null, l( '"/"' ) ), null !== r && null !== ( i = ze() ) ? r = [r, i] : ( r = null, o = s ); null !== n ? e = [e, n] : ( e = null, o = u ) } else e = null, o = u; return e } function ze () { var e, n, r, i, u, s; for ( u = o, e = [], n = $e(); null !== n; )e.push( n ), n = $e(); if ( null !== e ) { for ( n = [], s = o, 59 === t.charCodeAt( o ) ? ( r = ";", o++ ) : ( r = null, l( '";"' ) ), null !== r && null !== ( i = Ve() ) ? r = [r, i] : ( r = null, o = s ); null !== r; )n.push( r ), s = o, 59 === t.charCodeAt( o ) ? ( r = ";", o++ ) : ( r = null, l( '";"' ) ), null !== r && null !== ( i = Ve() ) ? r = [r, i] : ( r = null, o = s ); null !== n ? e = [e, n] : ( e = null, o = u ) } else e = null, o = u; return e } function Ve () { var e, t; for ( e = [], t = $e(); null !== t; )e.push( t ), t = $e(); return e } function $e () { var e; return null === ( e = b() ) && null === ( e = S() ) && ( 58 === t.charCodeAt( o ) ? ( e = ":", o++ ) : ( e = null, l( '":"' ) ), null === e && ( 64 === t.charCodeAt( o ) ? ( e = "@", o++ ) : ( e = null, l( '"@"' ) ), null === e && ( 38 === t.charCodeAt( o ) ? ( e = "&", o++ ) : ( e = null, l( '"&"' ) ), null === e && ( 61 === t.charCodeAt( o ) ? ( e = "=", o++ ) : ( e = null, l( '"="' ) ), null === e && ( 43 === t.charCodeAt( o ) ? ( e = "+", o++ ) : ( e = null, l( '"+"' ) ), null === e && ( 36 === t.charCodeAt( o ) ? ( e = "$", o++ ) : ( e = null, l( '"$"' ) ), null === e && ( 44 === t.charCodeAt( o ) ? ( e = ",", o++ ) : ( e = null, l( '","' ) ) ) ) ) ) ) ) ), e } function Ke () { var e, n, r, i, u; if ( i = o, u = o, null !== ( e = f() ) ) { for ( n = [], null === ( r = f() ) && null === ( r = c() ) && ( 43 === t.charCodeAt( o ) ? ( r = "+", o++ ) : ( r = null, l( '"+"' ) ), null === r && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ) ) ) ); null !== r; )n.push( r ), null === ( r = f() ) && null === ( r = c() ) && ( 43 === t.charCodeAt( o ) ? ( r = "+", o++ ) : ( r = null, l( '"+"' ) ), null === r && ( 45 === t.charCodeAt( o ) ? ( r = "-", o++ ) : ( r = null, l( '"-"' ) ), null === r && ( 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ) ) ) ); null !== n ? e = [e, n] : ( e = null, o = u ) } else e = null, o = u; return null !== e && ( e = function ( e ) { Fn.scheme = t.substring( o, e ) }( i ) ), null === e && ( o = i ), e } function Ye () { var e; return null === ( e = Je() ) && ( e = Xe() ), e } function Je () { var e, n, r, i; return r = o, i = o, null !== ( e = te() ) ? ( 64 === t.charCodeAt( o ) ? ( n = "@", o++ ) : ( n = null, l( '"@"' ) ), null !== n ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== ( e = null !== e ? e : "" ) && null !== ( n = oe() ) ? e = [e, n] : ( e = null, o = r ), e = null !== e ? e : "" } function Xe () { var e, n; if ( null === ( n = b() ) && null === ( n = S() ) && ( 36 === t.charCodeAt( o ) ? ( n = "$", o++ ) : ( n = null, l( '"$"' ) ), null === n && ( 44 === t.charCodeAt( o ) ? ( n = ",", o++ ) : ( n = null, l( '","' ) ), null === n && ( 59 === t.charCodeAt( o ) ? ( n = ";", o++ ) : ( n = null, l( '";"' ) ), null === n && ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null === n && ( 64 === t.charCodeAt( o ) ? ( n = "@", o++ ) : ( n = null, l( '"@"' ) ), null === n && ( 38 === t.charCodeAt( o ) ? ( n = "&", o++ ) : ( n = null, l( '"&"' ) ), null === n && ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ) ) ) ) ) ) ) ) ), null !== n ) for ( e = []; null !== n; )e.push( n ), null === ( n = b() ) && null === ( n = S() ) && ( 36 === t.charCodeAt( o ) ? ( n = "$", o++ ) : ( n = null, l( '"$"' ) ), null === n && ( 44 === t.charCodeAt( o ) ? ( n = ",", o++ ) : ( n = null, l( '","' ) ), null === n && ( 59 === t.charCodeAt( o ) ? ( n = ";", o++ ) : ( n = null, l( '";"' ) ), null === n && ( 58 === t.charCodeAt( o ) ? ( n = ":", o++ ) : ( n = null, l( '":"' ) ), null === n && ( 64 === t.charCodeAt( o ) ? ( n = "@", o++ ) : ( n = null, l( '"@"' ) ), null === n && ( 38 === t.charCodeAt( o ) ? ( n = "&", o++ ) : ( n = null, l( '"&"' ) ), null === n && ( 61 === t.charCodeAt( o ) ? ( n = "=", o++ ) : ( n = null, l( '"="' ) ), null === n && ( 43 === t.charCodeAt( o ) ? ( n = "+", o++ ) : ( n = null, l( '"+"' ) ) ) ) ) ) ) ) ) ); else e = null; return e } function Qe () { var e, t; for ( e = [], t = We(); null !== t; )e.push( t ), t = We(); return e } function Ze () { var e, n, r, i, u, s, a, f; if ( a = o, f = o, "sip" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"SIP"' ) ), null !== e ) if ( 47 === t.charCodeAt( o ) ? ( n = "/", o++ ) : ( n = null, l( '"/"' ) ), null !== n ) { if ( null !== ( i = c() ) ) for ( r = []; null !== i; )r.push( i ), i = c(); else r = null; if ( null !== r ) if ( 46 === t.charCodeAt( o ) ? ( i = ".", o++ ) : ( i = null, l( '"."' ) ), null !== i ) { if ( null !== ( s = c() ) ) for ( u = []; null !== s; )u.push( s ), s = c(); else u = null; null !== u ? e = [e, n, r, i, u] : ( e = null, o = f ) } else e = null, o = f; else e = null, o = f } else e = null, o = f; else e = null, o = f; return null !== e && ( e = function ( e ) { Fn.sip_version = t.substring( o, e ) }( a ) ), null === e && ( o = a ), e } function et () { var e; return "INVITE" === t.substr( o, 6 ) ? ( e = "INVITE", o += 6 ) : ( e = null, l( '"INVITE"' ) ), e } function tt () { var e; return "ACK" === t.substr( o, 3 ) ? ( e = "ACK", o += 3 ) : ( e = null, l( '"ACK"' ) ), e } function nt () { var e; return "OPTIONS" === t.substr( o, 7 ) ? ( e = "OPTIONS", o += 7 ) : ( e = null, l( '"OPTIONS"' ) ), e } function rt () { var e; return "BYE" === t.substr( o, 3 ) ? ( e = "BYE", o += 3 ) : ( e = null, l( '"BYE"' ) ), e } function it () { var e; return "CANCEL" === t.substr( o, 6 ) ? ( e = "CANCEL", o += 6 ) : ( e = null, l( '"CANCEL"' ) ), e } function ot () { var e; return "REGISTER" === t.substr( o, 8 ) ? ( e = "REGISTER", o += 8 ) : ( e = null, l( '"REGISTER"' ) ), e } function ut () { var e; return "SUBSCRIBE" === t.substr( o, 9 ) ? ( e = "SUBSCRIBE", o += 9 ) : ( e = null, l( '"SUBSCRIBE"' ) ), e } function st () { var e; return "NOTIFY" === t.substr( o, 6 ) ? ( e = "NOTIFY", o += 6 ) : ( e = null, l( '"NOTIFY"' ) ), e } function lt () { var e; return "REFER" === t.substr( o, 5 ) ? ( e = "REFER", o += 5 ) : ( e = null, l( '"REFER"' ) ), e } function at () { var e, n; return n = o, null === ( e = et() ) && null === ( e = tt() ) && null === ( e = nt() ) && null === ( e = rt() ) && null === ( e = it() ) && null === ( e = ot() ) && null === ( e = ut() ) && null === ( e = st() ) && null === ( e = lt() ) && ( e = k() ), null !== e && ( e = function ( e ) { return Fn.method = t.substring( o, e ), Fn.method }( n ) ), null === e && ( o = n ), e } function ct () { var e, t, n, r, i, u; return u = o, null !== ( e = Ze() ) && null !== ( t = v() ) && null !== ( n = ft() ) && null !== ( r = v() ) && null !== ( i = dt() ) ? e = [e, t, n, r, i] : ( e = null, o = u ), e } function ft () { var e, t, n; return t = o, null !== ( e = ht() ) && ( n = e, e = void ( Fn.status_code = parseInt( n.join( "" ) ) ) ), null === e && ( o = t ), e } function ht () { var e, t, n, r; return r = o, null !== ( e = c() ) && null !== ( t = c() ) && null !== ( n = c() ) ? e = [e, t, n] : ( e = null, o = r ), e } function dt () { var e, n, r; for ( r = o, e = [], null === ( n = y() ) && null === ( n = b() ) && null === ( n = S() ) && null === ( n = I() ) && null === ( n = O() ) && null === ( n = v() ) && ( n = m() ); null !== n; )e.push( n ), null === ( n = y() ) && null === ( n = b() ) && null === ( n = S() ) && null === ( n = I() ) && null === ( n = O() ) && null === ( n = v() ) && ( n = m() ); return null !== e && ( e = function ( e ) { Fn.reason_phrase = t.substring( o, e ) }( r ) ), null === e && ( o = r ), e } function _t () { var e, t, n, r, i, u, s; if ( i = o, u = o, null === ( e = J() ) && ( e = pt() ), null !== e ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = mt() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = mt() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return null !== e && ( e = function ( e ) { var t; Fn.multi_header || ( Fn.multi_header = [] ); try { t = new Ln( Fn.uri, Fn.display_name, Fn.params ), delete Fn.uri, delete Fn.display_name, delete Fn.params } catch ( e ) { t = null } Fn.multi_header.push( { possition: o, offset: e, parsed: t } ) }( i ) ), null === e && ( o = i ), e } function pt () { var e, t, n, r, i; return i = o, null !== ( e = null !== ( e = vt() ) ? e : "" ) && null !== ( t = L() ) && null !== ( n = X() ) && null !== ( r = q() ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function vt () { var e, t, n, r, i, u, s, l; if ( i = o, u = o, null !== ( e = k() ) ) { for ( t = [], s = o, null !== ( n = C() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = C() ) && null !== ( r = k() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return null === e && ( e = $() ), null !== e && ( l = e, e = void ( Fn.display_name = "string" == typeof l ? l : l[1].reduce( ( function ( e, t ) { return e + t[0] + t[1] } ), l[0] ) ) ), null === e && ( o = i ), e } function mt () { var e; return null === ( e = gt() ) && null === ( e = yt() ) && ( e = St() ), e } function gt () { var e, n, r, i, u, s; return i = o, u = o, "q" === t.substr( o, 1 ).toLowerCase() ? ( e = t.substr( o, 1 ), o++ ) : ( e = null, l( '"q"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = Tt() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.q = s ) ), null === e && ( o = i ), e } function yt () { var e, n, r, i, u, s; return i = o, u = o, "expires" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"expires"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = bt() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], Fn.params || ( Fn.params = {} ), e = void ( Fn.params.expires = s ) ), null === e && ( o = i ), e } function bt () { var e, t, n; if ( n = o, null !== ( t = c() ) ) for ( e = []; null !== t; )e.push( t ), t = c(); else e = null; return null !== e && ( e = parseInt( e.join( "" ) ) ), null === e && ( o = n ), e } function Tt () { var e, n, r, i, u, s, a, f; return s = o, a = o, 48 === t.charCodeAt( o ) ? ( e = "0", o++ ) : ( e = null, l( '"0"' ) ), null !== e ? ( f = o, 46 === t.charCodeAt( o ) ? ( n = ".", o++ ) : ( n = null, l( '"."' ) ), null !== n && null !== ( r = null !== ( r = c() ) ? r : "" ) && null !== ( i = null !== ( i = c() ) ? i : "" ) && null !== ( u = null !== ( u = c() ) ? u : "" ) ? n = [n, r, i, u] : ( n = null, o = f ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = a ) ) : ( e = null, o = a ), null !== e && ( e = function ( e ) { return parseFloat( t.substring( o, e ) ) }( s ) ), null === e && ( o = s ), e } function St () { var e, t, n, r, i, u, s, l; return r = o, i = o, null !== ( e = k() ) ? ( u = o, null !== ( t = U() ) && null !== ( n = Ct() ) ? t = [t, n] : ( t = null, o = u ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = i ) ) : ( e = null, o = i ), null !== e && ( s = e[0], l = e[1], Fn.params || ( Fn.params = {} ), l = void 0 === l ? void 0 : l[1], e = void ( Fn.params[s.toLowerCase()] = l ) ), null === e && ( o = r ), e } function Ct () { var e; return null === ( e = k() ) && null === ( e = ue() ) && ( e = V() ), e } function Et () { var e; return "render" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"render"' ) ), null === e && ( "session" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"session"' ) ), null === e && ( "icon" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"icon"' ) ), null === e && ( "alert" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"alert"' ) ), null === e && ( e = k() ) ) ) ), e } function At () { var e; return null === ( e = wt() ) && ( e = St() ), e } function wt () { var e, n, r, i; return i = o, "handling" === t.substr( o, 8 ).toLowerCase() ? ( e = t.substr( o, 8 ), o += 8 ) : ( e = null, l( '"handling"' ) ), null !== e && null !== ( n = U() ) ? ( "optional" === t.substr( o, 8 ).toLowerCase() ? ( r = t.substr( o, 8 ), o += 8 ) : ( r = null, l( '"optional"' ) ), null === r && ( "required" === t.substr( o, 8 ).toLowerCase() ? ( r = t.substr( o, 8 ), o += 8 ) : ( r = null, l( '"required"' ) ), null === r && ( r = k() ) ), null !== r ? e = [e, n, r] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function Rt () { var e, t, n, r, i, u, s, l; if ( s = o, null !== ( e = It() ) ) if ( null !== ( t = P() ) ) if ( null !== ( n = Dt() ) ) { for ( r = [], l = o, null !== ( i = H() ) && null !== ( u = Pt() ) ? i = [i, u] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = H() ) && null !== ( u = Pt() ) ? i = [i, u] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; else e = null, o = s; return e } function It () { var e; return null === ( e = Ot() ) && ( e = kt() ), e } function Ot () { var e; return "text" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"text"' ) ), null === e && ( "image" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"image"' ) ), null === e && ( "audio" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"audio"' ) ), null === e && ( "video" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"video"' ) ), null === e && ( "application" === t.substr( o, 11 ).toLowerCase() ? ( e = t.substr( o, 11 ), o += 11 ) : ( e = null, l( '"application"' ) ), null === e && ( e = Nt() ) ) ) ) ), e } function kt () { var e; return "message" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"message"' ) ), null === e && ( "multipart" === t.substr( o, 9 ).toLowerCase() ? ( e = t.substr( o, 9 ), o += 9 ) : ( e = null, l( '"multipart"' ) ), null === e && ( e = Nt() ) ), e } function Nt () { var e; return null === ( e = k() ) && ( e = xt() ), e } function xt () { var e, n, r; return r = o, "x-" === t.substr( o, 2 ).toLowerCase() ? ( e = t.substr( o, 2 ), o += 2 ) : ( e = null, l( '"x-"' ) ), null !== e && null !== ( n = k() ) ? e = [e, n] : ( e = null, o = r ), e } function Dt () { var e; return null === ( e = Nt() ) && ( e = k() ), e } function Pt () { var e, t, n, r; return r = o, null !== ( e = k() ) && null !== ( t = U() ) && null !== ( n = Ut() ) ? e = [e, t, n] : ( e = null, o = r ), e } function Ut () { var e; return null === ( e = k() ) && ( e = V() ), e } function jt () { var e, t, n, r; if ( n = o, null !== ( t = c() ) ) for ( e = []; null !== t; )e.push( t ), t = c(); else e = null; return null !== e && ( r = e, e = void ( Fn.value = parseInt( r.join( "" ) ) ) ), null === e && ( o = n ), e } function Mt () { var e, n, r, i, u, s; if ( u = o, null !== ( e = N() ) ) { for ( n = [], s = o, 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ), null !== r && null !== ( i = N() ) ? r = [r, i] : ( r = null, o = s ); null !== r; )n.push( r ), s = o, 46 === t.charCodeAt( o ) ? ( r = ".", o++ ) : ( r = null, l( '"."' ) ), null !== r && null !== ( i = N() ) ? r = [r, i] : ( r = null, o = s ); null !== n ? e = [e, n] : ( e = null, o = u ) } else e = null, o = u; return e } function qt () { var e; return null === ( e = Lt() ) && ( e = St() ), e } function Lt () { var e, n, r, i, u, s; return i = o, u = o, "tag" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"tag"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = k() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.tag = s ) ), null === e && ( o = i ), e } function Ft () { var e, n, r, i, u, s, a, c; if ( a = o, "digest" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"Digest"' ) ), null !== e ) if ( null !== ( n = C() ) ) if ( null !== ( r = Gt() ) ) { for ( i = [], c = o, null !== ( u = F() ) && null !== ( s = Gt() ) ? u = [u, s] : ( u = null, o = c ); null !== u; )i.push( u ), c = o, null !== ( u = F() ) && null !== ( s = Gt() ) ? u = [u, s] : ( u = null, o = c ); null !== i ? e = [e, n, r, i] : ( e = null, o = a ) } else e = null, o = a; else e = null, o = a; else e = null, o = a; return null === e && ( e = Ht() ), e } function Ht () { var e, t, n, r, i, u, s, l; if ( s = o, null !== ( e = k() ) ) if ( null !== ( t = C() ) ) if ( null !== ( n = Wt() ) ) { for ( r = [], l = o, null !== ( i = F() ) && null !== ( u = Wt() ) ? i = [i, u] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = F() ) && null !== ( u = Wt() ) ? i = [i, u] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; else e = null, o = s; return e } function Wt () { var e, t, n, r; return r = o, null !== ( e = k() ) && null !== ( t = U() ) ? ( null === ( n = k() ) && ( n = V() ), null !== n ? e = [e, t, n] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function Gt () { var e; return null === ( e = Bt() ) && null === ( e = Vt() ) && null === ( e = Kt() ) && null === ( e = Jt() ) && null === ( e = Xt() ) && null === ( e = Qt() ) && null === ( e = Zt() ) && ( e = Wt() ), e } function Bt () { var e, n, r, i; return i = o, "realm" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"realm"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = zt() ) ? e = [e, n, r] : ( e = null, o = i ), e } function zt () { var e, t, n; return t = o, null !== ( e = $() ) && ( n = e, e = void ( Fn.realm = n ) ), null === e && ( o = t ), e } function Vt () { var e, n, r, i, u, s, a, c, f; if ( c = o, "domain" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"domain"' ) ), null !== e ) if ( null !== ( n = U() ) ) if ( null !== ( r = G() ) ) if ( null !== ( i = $t() ) ) { if ( u = [], f = o, null !== ( a = v() ) ) for ( s = []; null !== a; )s.push( a ), a = v(); else s = null; for ( null !== s && null !== ( a = $t() ) ? s = [s, a] : ( s = null, o = f ); null !== s; ) { if ( u.push( s ), f = o, null !== ( a = v() ) ) for ( s = []; null !== a; )s.push( a ), a = v(); else s = null; null !== s && null !== ( a = $t() ) ? s = [s, a] : ( s = null, o = f ) } null !== u && null !== ( s = B() ) ? e = [e, n, r, i, u, s] : ( e = null, o = c ) } else e = null, o = c; else e = null, o = c; else e = null, o = c; else e = null, o = c; return e } function $t () { var e; return null === ( e = Me() ) && ( e = Fe() ), e } function Kt () { var e, n, r, i; return i = o, "nonce" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"nonce"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = Yt() ) ? e = [e, n, r] : ( e = null, o = i ), e } function Yt () { var e, t, n; return t = o, null !== ( e = $() ) && ( n = e, e = void ( Fn.nonce = n ) ), null === e && ( o = t ), e } function Jt () { var e, n, r, i, u, s; return i = o, u = o, "opaque" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"opaque"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = $() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.opaque = s ) ), null === e && ( o = i ), e } function Xt () { var e, n, r, i, u; return i = o, "stale" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"stale"' ) ), null !== e && null !== ( n = U() ) ? ( u = o, "true" === t.substr( o, 4 ).toLowerCase() ? ( r = t.substr( o, 4 ), o += 4 ) : ( r = null, l( '"true"' ) ), null !== r && ( r = void ( Fn.stale = !0 ) ), null === r && ( o = u ), null === r && ( u = o, "false" === t.substr( o, 5 ).toLowerCase() ? ( r = t.substr( o, 5 ), o += 5 ) : ( r = null, l( '"false"' ) ), null !== r && ( r = void ( Fn.stale = !1 ) ), null === r && ( o = u ) ), null !== r ? e = [e, n, r] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function Qt () { var e, n, r, i, u, s; return i = o, u = o, "algorithm" === t.substr( o, 9 ).toLowerCase() ? ( e = t.substr( o, 9 ), o += 9 ) : ( e = null, l( '"algorithm"' ) ), null !== e && null !== ( n = U() ) ? ( "md5" === t.substr( o, 3 ).toLowerCase() ? ( r = t.substr( o, 3 ), o += 3 ) : ( r = null, l( '"MD5"' ) ), null === r && ( "md5-sess" === t.substr( o, 8 ).toLowerCase() ? ( r = t.substr( o, 8 ), o += 8 ) : ( r = null, l( '"MD5-sess"' ) ), null === r && ( r = k() ) ), null !== r ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.algorithm = s.toUpperCase() ) ), null === e && ( o = i ), e } function Zt () { var e, n, r, i, u, s, a, c, f, h; if ( c = o, "qop" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"qop"' ) ), null !== e ) if ( null !== ( n = U() ) ) if ( null !== ( r = G() ) ) { if ( f = o, null !== ( i = en() ) ) { for ( u = [], h = o, 44 === t.charCodeAt( o ) ? ( s = ",", o++ ) : ( s = null, l( '","' ) ), null !== s && null !== ( a = en() ) ? s = [s, a] : ( s = null, o = h ); null !== s; )u.push( s ), h = o, 44 === t.charCodeAt( o ) ? ( s = ",", o++ ) : ( s = null, l( '","' ) ), null !== s && null !== ( a = en() ) ? s = [s, a] : ( s = null, o = h ); null !== u ? i = [i, u] : ( i = null, o = f ) } else i = null, o = f; null !== i && null !== ( u = B() ) ? e = [e, n, r, i, u] : ( e = null, o = c ) } else e = null, o = c; else e = null, o = c; else e = null, o = c; return e } function en () { var e, n, r; return n = o, "auth-int" === t.substr( o, 8 ).toLowerCase() ? ( e = t.substr( o, 8 ), o += 8 ) : ( e = null, l( '"auth-int"' ) ), null === e && ( "auth" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"auth"' ) ), null === e && ( e = k() ) ), null !== e && ( r = e, Fn.qop || ( Fn.qop = [] ), e = void Fn.qop.push( r.toLowerCase() ) ), null === e && ( o = n ), e } function tn () { var e, t, n, r, i, u, s; if ( i = o, u = o, null !== ( e = pt() ) ) { for ( t = [], s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== n; )t.push( n ), s = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = s ); null !== t ? e = [e, t] : ( e = null, o = u ) } else e = null, o = u; return null !== e && ( e = function ( e ) { var t; Fn.multi_header || ( Fn.multi_header = [] ); try { t = new Ln( Fn.uri, Fn.display_name, Fn.params ), delete Fn.uri, delete Fn.display_name, delete Fn.params } catch ( e ) { t = null } Fn.multi_header.push( { possition: o, offset: e, parsed: t } ) }( i ) ), null === e && ( o = i ), e } function nn () { var e; return null === ( e = rn() ) && ( e = St() ), e } function rn () { var e, n, r, i, u, s, a; if ( u = o, s = o, "cause" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"cause"' ) ), null !== e ) if ( null !== ( n = U() ) ) { if ( null !== ( i = c() ) ) for ( r = []; null !== i; )r.push( i ), i = c(); else r = null; null !== r ? e = [e, n, r] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; return null !== e && ( a = e[2], e = void ( Fn.cause = parseInt( a.join( "" ) ) ) ), null === e && ( o = u ), e } function on () { var e, t, n, r, i, u; if ( i = o, null !== ( e = pt() ) ) { for ( t = [], u = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = u ); null !== n; )t.push( n ), u = o, null !== ( n = H() ) && null !== ( r = St() ) ? n = [n, r] : ( n = null, o = u ); null !== t ? e = [e, t] : ( e = null, o = i ) } else e = null, o = i; return e } function un () { var e, n; return n = o, "active" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"active"' ) ), null === e && ( "pending" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"pending"' ) ), null === e && ( "terminated" === t.substr( o, 10 ).toLowerCase() ? ( e = t.substr( o, 10 ), o += 10 ) : ( e = null, l( '"terminated"' ) ), null === e && ( e = k() ) ) ), null !== e && ( e = function ( e ) { Fn.state = t.substring( o, e ) }( n ) ), null === e && ( o = n ), e } function sn () { var e, n, r, i, u, s, a, c; return i = o, u = o, "reason" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"reason"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = ln() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( s = e[2] ) && ( Fn.reason = s ) ) ), null === e && ( o = i ), null === e && ( i = o, u = o, "expires" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"expires"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = bt() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( c = e[2] ) && ( Fn.expires = c ) ) ), null === e && ( o = i ), null === e && ( i = o, u = o, "retry_after" === t.substr( o, 11 ).toLowerCase() ? ( e = t.substr( o, 11 ), o += 11 ) : ( e = null, l( '"retry_after"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = bt() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( e = void ( void 0 !== ( a = e[2] ) && ( Fn.retry_after = a ) ) ), null === e && ( o = i ), null === e && ( e = St() ) ) ), e } function ln () { var e; return "deactivated" === t.substr( o, 11 ).toLowerCase() ? ( e = t.substr( o, 11 ), o += 11 ) : ( e = null, l( '"deactivated"' ) ), null === e && ( "probation" === t.substr( o, 9 ).toLowerCase() ? ( e = t.substr( o, 9 ), o += 9 ) : ( e = null, l( '"probation"' ) ), null === e && ( "rejected" === t.substr( o, 8 ).toLowerCase() ? ( e = t.substr( o, 8 ), o += 8 ) : ( e = null, l( '"rejected"' ) ), null === e && ( "timeout" === t.substr( o, 7 ).toLowerCase() ? ( e = t.substr( o, 7 ), o += 7 ) : ( e = null, l( '"timeout"' ) ), null === e && ( "giveup" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"giveup"' ) ), null === e && ( "noresource" === t.substr( o, 10 ).toLowerCase() ? ( e = t.substr( o, 10 ), o += 10 ) : ( e = null, l( '"noresource"' ) ), null === e && ( "invariant" === t.substr( o, 9 ).toLowerCase() ? ( e = t.substr( o, 9 ), o += 9 ) : ( e = null, l( '"invariant"' ) ), null === e && ( e = k() ) ) ) ) ) ) ), e } function an () { var e; return null === ( e = Lt() ) && ( e = St() ), e } function cn () { var e, t, n, r, i, u, s, l; if ( s = o, null !== ( e = gn() ) ) if ( null !== ( t = C() ) ) if ( null !== ( n = Tn() ) ) { for ( r = [], l = o, null !== ( i = H() ) && null !== ( u = fn() ) ? i = [i, u] : ( i = null, o = l ); null !== i; )r.push( i ), l = o, null !== ( i = H() ) && null !== ( u = fn() ) ? i = [i, u] : ( i = null, o = l ); null !== r ? e = [e, t, n, r] : ( e = null, o = s ) } else e = null, o = s; else e = null, o = s; else e = null, o = s; return e } function fn () { var e; return null === ( e = hn() ) && null === ( e = dn() ) && null === ( e = _n() ) && null === ( e = pn() ) && null === ( e = vn() ) && ( e = St() ), e } function hn () { var e, n, r, i, u, s; return i = o, u = o, "ttl" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"ttl"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = En() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.ttl = s ) ), null === e && ( o = i ), e } function dn () { var e, n, r, i, u, s; return i = o, u = o, "maddr" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"maddr"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = ue() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.maddr = s ) ), null === e && ( o = i ), e } function _n () { var e, n, r, i, u, s; return i = o, u = o, "received" === t.substr( o, 8 ).toLowerCase() ? ( e = t.substr( o, 8 ), o += 8 ) : ( e = null, l( '"received"' ) ), null !== e && null !== ( n = U() ) ? ( null === ( r = _e() ) && ( r = fe() ), null !== r ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.received = s ) ), null === e && ( o = i ), e } function pn () { var e, n, r, i, u, s; return i = o, u = o, "branch" === t.substr( o, 6 ).toLowerCase() ? ( e = t.substr( o, 6 ), o += 6 ) : ( e = null, l( '"branch"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = k() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.branch = s ) ), null === e && ( o = i ), e } function vn () { var e, n, r, i, u; return i = o, "rport" === t.substr( o, 5 ).toLowerCase() ? ( e = t.substr( o, 5 ), o += 5 ) : ( e = null, l( '"rport"' ) ), null !== e ? ( u = o, null !== ( n = U() ) && null !== ( r = mn() ) ? n = [n, r] : ( n = null, o = u ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = i ) ) : ( e = null, o = i ), e } function mn () { var e, t, n, r, i, u, s, l; return u = o, s = o, null !== ( e = null !== ( e = c() ) ? e : "" ) && null !== ( t = null !== ( t = c() ) ? t : "" ) && null !== ( n = null !== ( n = c() ) ? n : "" ) && null !== ( r = null !== ( r = c() ) ? r : "" ) && null !== ( i = null !== ( i = c() ) ? i : "" ) ? e = [e, t, n, r, i] : ( e = null, o = s ), null !== e && ( l = e, e = void ( Fn.rport = parseInt( l.join( "" ) ) ) ), null === e && ( o = u ), e } function gn () { var e, t, n, r, i, u; return u = o, null !== ( e = yn() ) && null !== ( t = P() ) && null !== ( n = k() ) && null !== ( r = P() ) && null !== ( i = bn() ) ? e = [e, t, n, r, i] : ( e = null, o = u ), e } function yn () { var e, n, r; return n = o, "sip" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"SIP"' ) ), null === e && ( e = k() ), null !== e && ( r = e, e = void ( Fn.protocol = r ) ), null === e && ( o = n ), e } function bn () { var e, n, r; return n = o, "udp" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"UDP"' ) ), null === e && ( "tcp" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"TCP"' ) ), null === e && ( "tls" === t.substr( o, 3 ).toLowerCase() ? ( e = t.substr( o, 3 ), o += 3 ) : ( e = null, l( '"TLS"' ) ), null === e && ( "sctp" === t.substr( o, 4 ).toLowerCase() ? ( e = t.substr( o, 4 ), o += 4 ) : ( e = null, l( '"SCTP"' ) ), null === e && ( e = k() ) ) ) ), null !== e && ( r = e, e = void ( Fn.transport = r ) ), null === e && ( o = n ), e } function Tn () { var e, t, n, r, i; return r = o, null !== ( e = Sn() ) ? ( i = o, null !== ( t = W() ) && null !== ( n = Cn() ) ? t = [t, n] : ( t = null, o = i ), null !== ( t = null !== t ? t : "" ) ? e = [e, t] : ( e = null, o = r ) ) : ( e = null, o = r ), e } function Sn () { var e, n; return n = o, null === ( e = _e() ) && null === ( e = ce() ) && ( e = se() ), null !== e && ( e = function ( e ) { Fn.host = t.substring( o, e ) }( n ) ), null === e && ( o = n ), e } function Cn () { var e, t, n, r, i, u, s, l; return u = o, s = o, null !== ( e = null !== ( e = c() ) ? e : "" ) && null !== ( t = null !== ( t = c() ) ? t : "" ) && null !== ( n = null !== ( n = c() ) ? n : "" ) && null !== ( r = null !== ( r = c() ) ? r : "" ) && null !== ( i = null !== ( i = c() ) ? i : "" ) ? e = [e, t, n, r, i] : ( e = null, o = s ), null !== e && ( l = e, e = void ( Fn.port = parseInt( l.join( "" ) ) ) ), null === e && ( o = u ), e } function En () { var e, t, n, r, i; return r = o, i = o, null !== ( e = c() ) && null !== ( t = null !== ( t = c() ) ? t : "" ) && null !== ( n = null !== ( n = c() ) ? n : "" ) ? e = [e, t, n] : ( e = null, o = i ), null !== e && ( e = parseInt( e.join( "" ) ) ), null === e && ( o = r ), e } function An () { var e, t, n; return t = o, null !== ( e = bt() ) && ( n = e, e = void ( Fn.expires = n ) ), null === e && ( o = t ), e } function wn () { var e; return null === ( e = Rn() ) && ( e = St() ), e } function Rn () { var e, n, r, i, u, s; return i = o, u = o, "refresher" === t.substr( o, 9 ).toLowerCase() ? ( e = t.substr( o, 9 ), o += 9 ) : ( e = null, l( '"refresher"' ) ), null !== e && null !== ( n = U() ) ? ( "uac" === t.substr( o, 3 ).toLowerCase() ? ( r = t.substr( o, 3 ), o += 3 ) : ( r = null, l( '"uac"' ) ), null === r && ( "uas" === t.substr( o, 3 ).toLowerCase() ? ( r = t.substr( o, 3 ), o += 3 ) : ( r = null, l( '"uas"' ) ) ), null !== r ? e = [e, n, r] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.refresher = s.toLowerCase() ) ), null === e && ( o = i ), e } function In () { var e, t; for ( e = [], null === ( t = R() ) && null === ( t = O() ) && ( t = C() ); null !== t; )e.push( t ), null === ( t = R() ) && null === ( t = O() ) && ( t = C() ); return e } function On () { var e, n, r, i, u, s, a, c, f, h, d; return h = o, d = o, null !== ( e = Nn() ) ? ( 45 === t.charCodeAt( o ) ? ( n = "-", o++ ) : ( n = null, l( '"-"' ) ), null !== n && null !== ( r = kn() ) ? ( 45 === t.charCodeAt( o ) ? ( i = "-", o++ ) : ( i = null, l( '"-"' ) ), null !== i && null !== ( u = kn() ) ? ( 45 === t.charCodeAt( o ) ? ( s = "-", o++ ) : ( s = null, l( '"-"' ) ), null !== s && null !== ( a = kn() ) ? ( 45 === t.charCodeAt( o ) ? ( c = "-", o++ ) : ( c = null, l( '"-"' ) ), null !== c && null !== ( f = xn() ) ? e = [e, n, r, i, u, s, a, c, f] : ( e = null, o = d ) ) : ( e = null, o = d ) ) : ( e = null, o = d ) ) : ( e = null, o = d ) ) : ( e = null, o = d ), null !== e && ( e = function ( e, n ) { Fn = t.substring( o + 5, e ) }( h, e[0] ) ), null === e && ( o = h ), e } function kn () { var e, t, n, r, i; return i = o, null !== ( e = h() ) && null !== ( t = h() ) && null !== ( n = h() ) && null !== ( r = h() ) ? e = [e, t, n, r] : ( e = null, o = i ), e } function Nn () { var e, t, n; return n = o, null !== ( e = kn() ) && null !== ( t = kn() ) ? e = [e, t] : ( e = null, o = n ), e } function xn () { var e, t, n, r; return r = o, null !== ( e = kn() ) && null !== ( t = kn() ) && null !== ( n = kn() ) ? e = [e, t, n] : ( e = null, o = r ), e } function Dn () { var e, n, r, i, u, s; return i = o, u = o, null !== ( e = x() ) ? ( s = o, 64 === t.charCodeAt( o ) ? ( n = "@", o++ ) : ( n = null, l( '"@"' ) ), null !== n && null !== ( r = x() ) ? n = [n, r] : ( n = null, o = s ), null !== ( n = null !== n ? n : "" ) ? e = [e, n] : ( e = null, o = u ) ) : ( e = null, o = u ), null !== e && ( e = function ( e ) { Fn.call_id = t.substring( o, e ) }( i ) ), null === e && ( o = i ), e } function Pn () { var e; return null === ( e = Un() ) && null === ( e = jn() ) && null === ( e = Mn() ) && ( e = St() ), e } function Un () { var e, n, r, i, u, s; return i = o, u = o, "to-tag" === t.substr( o, 6 ) ? ( e = "to-tag", o += 6 ) : ( e = null, l( '"to-tag"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = k() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.to_tag = s ) ), null === e && ( o = i ), e } function jn () { var e, n, r, i, u, s; return i = o, u = o, "from-tag" === t.substr( o, 8 ) ? ( e = "from-tag", o += 8 ) : ( e = null, l( '"from-tag"' ) ), null !== e && null !== ( n = U() ) && null !== ( r = k() ) ? e = [e, n, r] : ( e = null, o = u ), null !== e && ( s = e[2], e = void ( Fn.from_tag = s ) ), null === e && ( o = i ), e } function Mn () { var e, n; return n = o, "early-only" === t.substr( o, 10 ) ? ( e = "early-only", o += 10 ) : ( e = null, l( '"early-only"' ) ), null !== e && ( e = void ( Fn.early_only = !0 ) ), null === e && ( o = n ), e } var qn = n( 9 ), Ln = n( 14 ), Fn = {}; if ( null === i[r]() || o !== t.length ) { var Hn = Math.max( o, u ), Wn = Hn < t.length ? t.charAt( Hn ) : null, Gn = function () { for ( var e = 1, n = 1, r = !1, i = 0; i < Math.max( o, u ); i++ ) { var s = t.charAt( i ); "\n" === s ? ( r || e++, n = 1, r = !1 ) : "\r" === s || "\u2028" === s || "\u2029" === s ? ( e++, n = 1, r = !0 ) : ( n++, r = !1 ) } return { line: e, column: n } }(); return new this.SyntaxError( function ( e ) { e.sort(); for ( var t = null, n = [], r = 0; r < e.length; r++ )e[r] !== t && ( n.push( e[r] ), t = e[r] ); return n }( s ), Wn, Hn, Gn.line, Gn.column ), -1 } return Fn }, toSource: function () { return this._source }, SyntaxError: function ( t, n, r, i, o ) { this.name = "SyntaxError", this.expected = t, this.found = n, this.message = function ( t, n ) { var r; switch ( t.length ) { case 0: r = "end of input"; break; case 1: r = t[0]; break; default: r = t.slice( 0, t.length - 1 ).join( ", " ) + " or " + t[t.length - 1] }return "Expected " + r + " but " + ( n ? e( n ) : "end of input" ) + " found." }( t, n ), this.offset = r, this.line = i, this.column = o } }; return t.SyntaxError.prototype = Error.prototype, t }() }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } function a ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return c( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return c( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, i = function () { }; return { s: i, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: i } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var o, u = !0, s = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return u = e.done, e }, e: function ( e ) { s = !0, o = e }, f: function () { try { u || null == n.return || n.return() } finally { if ( s ) throw o } } } } function c ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } function f ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function h ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function d ( e, t, n ) { return t && h( e.prototype, t ), n && h( e, n ), e } var _ = n( 20 ), p = n( 2 ), v = n( 1 ), m = n( 3 ), g = n( 14 ), y = n( 6 ), b = new p( "SIPMessage" ), T = function () { function e ( t, n, r, i, o, u ) { if ( f( this, e ), !t || !n || !r ) return null; i = i || {}, this.ua = r, this.headers = {}, this.method = t, this.ruri = n, this.body = u, this.extraHeaders = m.cloneArray( o ), i.route_set ? this.setHeader( "route", i.route_set ) : r.configuration.use_preloaded_route && this.setHeader( "route", "<".concat( r.transport.sip_uri, ";lr>" ) ), this.setHeader( "via", "" ), this.setHeader( "max-forwards", v.MAX_FORWARDS ); var s = i.to_uri || n, l = i.to_tag ? { tag: i.to_tag } : null, a = void 0 !== i.to_display_name ? i.to_display_name : null; this.to = new g( s, a, l ), this.setHeader( "to", this.to.toString() ); var c, h = i.from_uri || r.configuration.uri, d = { tag: i.from_tag || m.newTag() }; c = void 0 !== i.from_display_name ? i.from_display_name : r.configuration.display_name ? r.configuration.display_name : null, this.from = new g( h, c, d ), this.setHeader( "from", this.from.toString() ); var _ = i.call_id || r.configuration.jssip_id + m.createRandomToken( 15 ); this.call_id = _, this.setHeader( "call-id", _ ); var p = i.cseq || Math.floor( 1e4 * Math.random() ); this.cseq = p, this.setHeader( "cseq", "".concat( p, " " ).concat( t ) ) } return d( e, [{ key: "setHeader", value: function ( e, t ) { for ( var n = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), r = 0; r < this.extraHeaders.length; r++ )n.test( this.extraHeaders[r] ) && this.extraHeaders.splice( r, 1 ); this.headers[m.headerize( e )] = Array.isArray( t ) ? t : [t] } }, { key: "getHeader", value: function ( e ) { var t = this.headers[m.headerize( e )]; if ( t ) { if ( t[0] ) return t[0] } else { var n, r = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), i = a( this.extraHeaders ); try { for ( i.s(); !( n = i.n() ).done; ) { var o = n.value; if ( r.test( o ) ) return o.substring( o.indexOf( ":" ) + 1 ).trim() } } catch ( e ) { i.e( e ) } finally { i.f() } } } }, { key: "getHeaders", value: function ( e ) { var t = this.headers[m.headerize( e )], n = []; if ( t ) { var r, i = a( t ); try { for ( i.s(); !( r = i.n() ).done; ) { var o = r.value; n.push( o ) } } catch ( e ) { i.e( e ) } finally { i.f() } return n } var u, s = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), l = a( this.extraHeaders ); try { for ( l.s(); !( u = l.n() ).done; ) { var c = u.value; s.test( c ) && n.push( c.substring( c.indexOf( ":" ) + 1 ).trim() ) } } catch ( e ) { l.e( e ) } finally { l.f() } return n } }, { key: "hasHeader", value: function ( e ) { if ( this.headers[m.headerize( e )] ) return !0; var t, n = new RegExp( "^\\s*".concat( e, "\\s*:" ), "i" ), r = a( this.extraHeaders ); try { for ( r.s(); !( t = r.n() ).done; ) { var i = t.value; if ( n.test( i ) ) return !0 } } catch ( e ) { r.e( e ) } finally { r.f() } return !1 } }, { key: "parseSDP", value: function ( e ) { return !e && this.sdp || ( this.sdp = _.parse( this.body || "" ) ), this.sdp } }, { key: "toString", value: function () { var e = "".concat( this.method, " " ).concat( this.ruri, " SIP/2.0\r\n" ); for ( var t in this.headers ) if ( Object.prototype.hasOwnProperty.call( this.headers, t ) ) { var n, r = a( this.headers[t] ); try { for ( r.s(); !( n = r.n() ).done; ) { var i = n.value; e += "".concat( t, ": " ).concat( i, "\r\n" ) } } catch ( e ) { r.e( e ) } finally { r.f() } } var o, u = a( this.extraHeaders ); try { for ( u.s(); !( o = u.n() ).done; ) { var s = o.value; e += "".concat( s.trim(), "\r\n" ) } } catch ( e ) { u.e( e ) } finally { u.f() } var l = []; switch ( this.method ) { case v.REGISTER: l.push( "path", "gruu" ); break; case v.INVITE: this.ua.configuration.session_timers && l.push( "timer" ), ( this.ua.contact.pub_gruu || this.ua.contact.temp_gruu ) && l.push( "gruu" ), l.push( "ice", "replaces" ); break; case v.UPDATE: this.ua.configuration.session_timers && l.push( "timer" ), l.push( "ice" ) }l.push( "outbound" ); var c = this.ua.configuration.user_agent || v.USER_AGENT; if ( e += "Allow: ".concat( v.ALLOWED_METHODS, "\r\n" ), e += "Supported: ".concat( l, "\r\n" ), e += "User-Agent: ".concat( c, "\r\n" ), this.body ) { var f = m.str_utf8_length( this.body ); e += "Content-Length: ".concat( f, "\r\n\r\n" ), e += this.body } else e += "Content-Length: 0\r\n\r\n"; return e } }, { key: "clone", value: function () { var t = new e( this.method, this.ruri, this.ua ); return Object.keys( this.headers ).forEach( ( function ( e ) { t.headers[e] = this.headers[e].slice() } ), this ), t.body = this.body, t.extraHeaders = m.cloneArray( this.extraHeaders ), t.to = this.to, t.from = this.from, t.call_id = this.call_id, t.cseq = this.cseq, t } }] ), e }(), S = function ( e ) { i( n, e ); var t = u( n ); function n ( e, r, i, o, u ) { var s; return f( this, n ), ( s = t.call( this, v.INVITE, e, r, i, o, u ) ).transaction = null, s } return d( n, [{ key: "cancel", value: function ( e ) { this.transaction.cancel( e ) } }, { key: "clone", value: function () { var e = new n( this.ruri, this.ua ); return Object.keys( this.headers ).forEach( ( function ( t ) { e.headers[t] = this.headers[t].slice() } ), this ), e.body = this.body, e.extraHeaders = m.cloneArray( this.extraHeaders ), e.to = this.to, e.from = this.from, e.call_id = this.call_id, e.cseq = this.cseq, e.transaction = this.transaction, e } }] ), n }( T ), C = function () { function e () { f( this, e ), this.data = null, this.headers = null, this.method = null, this.via = null, this.via_branch = null, this.call_id = null, this.cseq = null, this.from = null, this.from_tag = null, this.to = null, this.to_tag = null, this.body = null, this.sdp = null } return d( e, [{ key: "addHeader", value: function ( e, t ) { var n = { raw: t }; e = m.headerize( e ), this.headers[e] ? this.headers[e].push( n ) : this.headers[e] = [n] } }, { key: "getHeader", value: function ( e ) { var t = this.headers[m.headerize( e )]; if ( t ) return t[0] ? t[0].raw : void 0 } }, { key: "getHeaders", value: function ( e ) { var t = this.headers[m.headerize( e )], n = []; if ( !t ) return []; var r, i = a( t ); try { for ( i.s(); !( r = i.n() ).done; ) { var o = r.value; n.push( o.raw ) } } catch ( e ) { i.e( e ) } finally { i.f() } return n } }, { key: "hasHeader", value: function ( e ) { return !!this.headers[m.headerize( e )] } }, { key: "parseHeader", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0; if ( e = m.headerize( e ), this.headers[e] ) { if ( !( t >= this.headers[e].length ) ) { var n = this.headers[e][t], r = n.raw; if ( n.parsed ) return n.parsed; var i = y.parse( r, e.replace( /-/g, "_" ) ); return -1 === i ? ( this.headers[e].splice( t, 1 ), void b.debug( 'error parsing "'.concat( e, '" header field with value "' ).concat( r, '"' ) ) ) : ( n.parsed = i, i ) } b.debug( 'not so many "'.concat( e, '" headers present' ) ) } else b.debug( 'header "'.concat( e, '" not present' ) ) } }, { key: "s", value: function ( e, t ) { return this.parseHeader( e, t ) } }, { key: "setHeader", value: function ( e, t ) { var n = { raw: t }; this.headers[m.headerize( e )] = [n] } }, { key: "parseSDP", value: function ( e ) { return !e && this.sdp || ( this.sdp = _.parse( this.body || "" ) ), this.sdp } }, { key: "toString", value: function () { return this.data } }] ), e }(), E = function ( e ) { i( n, e ); var t = u( n ); function n ( e ) { var r; return f( this, n ), ( r = t.call( this ) ).ua = e, r.headers = {}, r.ruri = null, r.transport = null, r.server_transaction = null, r } return d( n, [{ key: "reply", value: function ( e, t, n, r, i, o ) { var u = [], s = this.getHeader( "To" ); if ( t = t || null, !( e = e || null ) || e < 100 || e > 699 ) throw new TypeError( "Invalid status_code: ".concat( e ) ); if ( t && "string" != typeof t && !( t instanceof String ) ) throw new TypeError( "Invalid reason_phrase: ".concat( t ) ); t = t || v.REASON_PHRASE[e] || "", n = m.cloneArray( n ); var l = "SIP/2.0 ".concat( e, " " ).concat( t, "\r\n" ); if ( this.method === v.INVITE && e > 100 && e <= 200 ) { var c, f = a( this.getHeaders( "record-route" ) ); try { for ( f.s(); !( c = f.n() ).done; ) { var h = c.value; l += "Record-Route: ".concat( h, "\r\n" ) } } catch ( e ) { f.e( e ) } finally { f.f() } } var d, _ = a( this.getHeaders( "via" ) ); try { for ( _.s(); !( d = _.n() ).done; ) { var p = d.value; l += "Via: ".concat( p, "\r\n" ) } } catch ( e ) { _.e( e ) } finally { _.f() } !this.to_tag && e > 100 ? s += ";tag=".concat( m.newTag() ) : this.to_tag && !this.s( "to" ).hasParam( "tag" ) && ( s += ";tag=".concat( this.to_tag ) ), l += "To: ".concat( s, "\r\n" ), l += "From: ".concat( this.getHeader( "From" ), "\r\n" ), l += "Call-ID: ".concat( this.call_id, "\r\n" ), l += "CSeq: ".concat( this.cseq, " " ).concat( this.method, "\r\n" ); var g, y = a( n ); try { for ( y.s(); !( g = y.n() ).done; ) { var b = g.value; l += "".concat( b.trim(), "\r\n" ) } } catch ( e ) { y.e( e ) } finally { y.f() } switch ( this.method ) { case v.INVITE: this.ua.configuration.session_timers && u.push( "timer" ), ( this.ua.contact.pub_gruu || this.ua.contact.temp_gruu ) && u.push( "gruu" ), u.push( "ice", "replaces" ); break; case v.UPDATE: this.ua.configuration.session_timers && u.push( "timer" ), r && u.push( "ice" ), u.push( "replaces" ) }if ( u.push( "outbound" ), this.method === v.OPTIONS ? ( l += "Allow: ".concat( v.ALLOWED_METHODS, "\r\n" ), l += "Accept: ".concat( v.ACCEPTED_BODY_TYPES, "\r\n" ) ) : 405 === e ? l += "Allow: ".concat( v.ALLOWED_METHODS, "\r\n" ) : 415 === e && ( l += "Accept: ".concat( v.ACCEPTED_BODY_TYPES, "\r\n" ) ), l += "Supported: ".concat( u, "\r\n" ), r ) { var T = m.str_utf8_length( r ); l += "Content-Type: application/sdp\r\n", l += "Content-Length: ".concat( T, "\r\n\r\n" ), l += r } else l += "Content-Length: ".concat( 0, "\r\n\r\n" ); this.server_transaction.receiveResponse( e, l, i, o ) } }, { key: "reply_sl", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : null, t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : null, n = this.getHeaders( "via" ); if ( !e || e < 100 || e > 699 ) throw new TypeError( "Invalid status_code: ".concat( e ) ); if ( t && "string" != typeof t && !( t instanceof String ) ) throw new TypeError( "Invalid reason_phrase: ".concat( t ) ); t = t || v.REASON_PHRASE[e] || ""; var r, i = "SIP/2.0 ".concat( e, " " ).concat( t, "\r\n" ), o = a( n ); try { for ( o.s(); !( r = o.n() ).done; ) { var u = r.value; i += "Via: ".concat( u, "\r\n" ) } } catch ( e ) { o.e( e ) } finally { o.f() } var s = this.getHeader( "To" ); !this.to_tag && e > 100 ? s += ";tag=".concat( m.newTag() ) : this.to_tag && !this.s( "to" ).hasParam( "tag" ) && ( s += ";tag=".concat( this.to_tag ) ), i += "To: ".concat( s, "\r\n" ), i += "From: ".concat( this.getHeader( "From" ), "\r\n" ), i += "Call-ID: ".concat( this.call_id, "\r\n" ), i += "CSeq: ".concat( this.cseq, " " ).concat( this.method, "\r\n" ), i += "Content-Length: ".concat( 0, "\r\n\r\n" ), this.transport.send( i ) } }] ), n }( C ), A = function ( e ) { i( n, e ); var t = u( n ); function n () { var e; return f( this, n ), ( e = t.call( this ) ).headers = {}, e.status_code = null, e.reason_phrase = null, e } return n }( C ); e.exports = { OutgoingRequest: T, InitialOutgoingInviteRequest: S, IncomingRequest: E, IncomingResponse: A } }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function o ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && f( e, t ) } function u ( e ) { var t = c(); return function () { var n, r = h( e ); if ( t ) { var i = h( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { var t = "function" == typeof Map ? new Map : void 0; return ( l = function ( e ) { if ( null === e || ( n = e, -1 === Function.toString.call( n ).indexOf( "[native code]" ) ) ) return e; var n; if ( "function" != typeof e ) throw new TypeError( "Super expression must either be null or a function" ); if ( void 0 !== t ) { if ( t.has( e ) ) return t.get( e ); t.set( e, r ) } function r () { return a( e, arguments, h( this ).constructor ) } return r.prototype = Object.create( e.prototype, { constructor: { value: r, enumerable: !1, writable: !0, configurable: !0 } } ), f( r, e ) } )( e ) } function a ( e, t, n ) { return ( a = c() ? Reflect.construct : function ( e, t, n ) { var r = [null]; r.push.apply( r, t ); var i = new ( Function.bind.apply( e, r ) ); return n && f( i, n.prototype ), i } ).apply( null, arguments ) } function c () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } } function f ( e, t ) { return ( f = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function h ( e ) { return ( h = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var d = function ( e ) { o( n, e ); var t = u( n ); function n ( e, r ) { var o; return i( this, n ), ( o = t.call( this ) ).code = 1, o.name = "CONFIGURATION_ERROR", o.parameter = e, o.value = r, o.message = o.value ? "Invalid value ".concat( JSON.stringify( o.value ), ' for parameter "' ).concat( o.parameter, '"' ) : "Missing parameter: ".concat( o.parameter ), o } return n }( l( Error ) ), _ = function ( e ) { o( n, e ); var t = u( n ); function n ( e ) { var r; return i( this, n ), ( r = t.call( this ) ).code = 2, r.name = "INVALID_STATE_ERROR", r.status = e, r.message = "Invalid status: ".concat( e ), r } return n }( l( Error ) ), p = function ( e ) { o( n, e ); var t = u( n ); function n ( e ) { var r; return i( this, n ), ( r = t.call( this ) ).code = 3, r.name = "NOT_SUPPORTED_ERROR", r.message = e, r } return n }( l( Error ) ), v = function ( e ) { o( n, e ); var t = u( n ); function n ( e ) { var r; return i( this, n ), ( r = t.call( this ) ).code = 4, r.name = "NOT_READY_ERROR", r.message = e, r } return n }( l( Error ) ); e.exports = { ConfigurationError: d, InvalidStateError: _, NotSupportedError: p, NotReadyError: v } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return i( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return i( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, o = function () { }; return { s: o, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: o } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function i ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } function o ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function u ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function s ( e, t, n ) { return t && u( e.prototype, t ), n && u( e, n ), e } var l = n( 1 ), a = n( 3 ), c = n( 6 ); e.exports = function () { function e ( t, n, r, i ) { var u = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : {}, s = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {}; if ( o( this, e ), !r ) throw new TypeError( 'missing or invalid "host" parameter' ); for ( var a in this._parameters = {}, this._headers = {}, this._scheme = t || l.SIP, this._user = n, this._host = r, this._port = i, u ) Object.prototype.hasOwnProperty.call( u, a ) && this.setParam( a, u[a] ); for ( var c in s ) Object.prototype.hasOwnProperty.call( s, c ) && this.setHeader( c, s[c] ) } return s( e, null, [{ key: "parse", value: function ( e ) { return -1 !== ( e = c.parse( e, "SIP_URI" ) ) ? e : void 0 } }] ), s( e, [{ key: "setParam", value: function ( e, t ) { e && ( this._parameters[e.toLowerCase()] = null == t ? null : t.toString() ) } }, { key: "getParam", value: function ( e ) { if ( e ) return this._parameters[e.toLowerCase()] } }, { key: "hasParam", value: function ( e ) { if ( e ) return !!this._parameters.hasOwnProperty( e.toLowerCase() ) } }, { key: "deleteParam", value: function ( e ) { if ( e = e.toLowerCase(), this._parameters.hasOwnProperty( e ) ) { var t = this._parameters[e]; return delete this._parameters[e], t } } }, { key: "clearParams", value: function () { this._parameters = {} } }, { key: "setHeader", value: function ( e, t ) { this._headers[a.headerize( e )] = Array.isArray( t ) ? t : [t] } }, { key: "getHeader", value: function ( e ) { if ( e ) return this._headers[a.headerize( e )] } }, { key: "hasHeader", value: function ( e ) { if ( e ) return !!this._headers.hasOwnProperty( a.headerize( e ) ) } }, { key: "deleteHeader", value: function ( e ) { if ( e = a.headerize( e ), this._headers.hasOwnProperty( e ) ) { var t = this._headers[e]; return delete this._headers[e], t } } }, { key: "clearHeaders", value: function () { this._headers = {} } }, { key: "clone", value: function () { return new e( this._scheme, this._user, this._host, this._port, JSON.parse( JSON.stringify( this._parameters ) ), JSON.parse( JSON.stringify( this._headers ) ) ) } }, { key: "toString", value: function () { var e = [], t = "".concat( this._scheme, ":" ); for ( var n in this._user && ( t += "".concat( a.escapeUser( this._user ), "@" ) ), t += this._host, ( this._port || 0 === this._port ) && ( t += ":".concat( this._port ) ), this._parameters ) Object.prototype.hasOwnProperty.call( this._parameters, n ) && ( t += ";".concat( n ), null !== this._parameters[n] && ( t += "=".concat( this._parameters[n] ) ) ); for ( var i in this._headers ) if ( Object.prototype.hasOwnProperty.call( this._headers, i ) ) { var o, u = r( this._headers[i] ); try { for ( u.s(); !( o = u.n() ).done; ) { var s = o.value; e.push( "".concat( i, "=" ).concat( s ) ) } } catch ( e ) { u.e( e ) } finally { u.f() } } return e.length > 0 && ( t += "?".concat( e.join( "&" ) ) ), t } }, { key: "toAor", value: function ( e ) { var t = "".concat( this._scheme, ":" ); return this._user && ( t += "".concat( a.escapeUser( this._user ), "@" ) ), t += this._host, e && ( this._port || 0 === this._port ) && ( t += ":".concat( this._port ) ), t } }, { key: "scheme", get: function () { return this._scheme }, set: function ( e ) { this._scheme = e.toLowerCase() } }, { key: "user", get: function () { return this._user }, set: function ( e ) { this._user = e } }, { key: "host", get: function () { return this._host }, set: function ( e ) { this._host = e.toLowerCase() } }, { key: "port", get: function () { return this._port }, set: function ( e ) { this._port = 0 === e ? e : parseInt( e, 10 ) || null } }] ), e }() }, function ( e, t, n ) { "use strict"; var r = n( 19 ), i = n( 1 ), o = n( 8 ), u = n( 3 ), s = n( 29 ), l = n( 9 ), a = n( 14 ), c = n( 6 ), f = n( 49 ); n( 15 )( "JsSIP" )( "version %s", r.version ), e.exports = { C: i, Exceptions: o, Utils: u, UA: s, URI: l, NameAddrHeader: a, WebSocketInterface: f, Grammar: c, debug: n( 15 ), get name () { return r.title }, get version () { return r.version } } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 2 ), o = n( 1 ), u = n( 36 ), s = n( 12 ), l = new i( "RequestSender" ), a = { onRequestTimeout: function () { }, onTransportError: function () { }, onReceiveResponse: function () { }, onAuthenticated: function () { } }; e.exports = function () { function e ( t, n, r ) { for ( var i in function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._ua = t, this._eventHandlers = r, this._method = n.method, this._request = n, this._auth = null, this._challenged = !1, this._staled = !1, a ) Object.prototype.hasOwnProperty.call( a, i ) && ( this._eventHandlers[i] || ( this._eventHandlers[i] = a[i] ) ); t.status !== t.C.STATUS_USER_CLOSED || this._method === o.BYE && this._method === o.ACK || this._eventHandlers.onTransportError() } var t, n, i; return t = e, ( n = [{ key: "send", value: function () { var e = this, t = { onRequestTimeout: function () { e._eventHandlers.onRequestTimeout() }, onTransportError: function () { e._eventHandlers.onTransportError() }, onReceiveResponse: function ( t ) { e._receiveResponse( t ) } }; switch ( this._method ) { case "INVITE": this.clientTransaction = new s.InviteClientTransaction( this._ua, this._ua.transport, this._request, t ); break; case "ACK": this.clientTransaction = new s.AckClientTransaction( this._ua, this._ua.transport, this._request, t ); break; default: this.clientTransaction = new s.NonInviteClientTransaction( this._ua, this._ua.transport, this._request, t ) }this._ua._configuration.authorization_jwt && this._request.setHeader( "Authorization", this._ua._configuration.authorization_jwt ), this.clientTransaction.send() } }, { key: "_receiveResponse", value: function ( e ) { var t, n, r = e.status_code; if ( 401 !== r && 407 !== r || null === this._ua.configuration.password && null === this._ua.configuration.ha1 ) this._eventHandlers.onReceiveResponse( e ); else { if ( 401 === e.status_code ? ( t = e.parseHeader( "www-authenticate" ), n = "authorization" ) : ( t = e.parseHeader( "proxy-authenticate" ), n = "proxy-authorization" ), !t ) return l.debug( "".concat( e.status_code, " with wrong or missing challenge, cannot authenticate" ) ), void this._eventHandlers.onReceiveResponse( e ); if ( !this._challenged || !this._staled && !0 === t.stale ) { if ( this._auth || ( this._auth = new u( { username: this._ua.configuration.authorization_user, password: this._ua.configuration.password, realm: this._ua.configuration.realm, ha1: this._ua.configuration.ha1 } ) ), !this._auth.authenticate( this._request, t ) ) return void this._eventHandlers.onReceiveResponse( e ); this._challenged = !0, this._ua.set( "realm", this._auth.get( "realm" ) ), this._ua.set( "ha1", this._auth.get( "ha1" ) ), t.stale && ( this._staled = !0 ), this._request = this._request.clone(), this._request.cseq += 1, this._request.setHeader( "cseq", "".concat( this._request.cseq, " " ).concat( this._method ) ), this._request.setHeader( n, this._auth.toString() ), this._eventHandlers.onAuthenticated( this._request ), this.send() } else this._eventHandlers.onReceiveResponse( e ) } } }] ) && r( t.prototype, n ), i && r( t, i ), e }() }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function o ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function u ( e, t, n ) { return t && o( e.prototype, t ), n && o( e, n ), e } function s ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && l( e, t ) } function l ( e, t ) { return ( l = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function a ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = h( e ); if ( t ) { var i = h( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return c( this, n ) } } function c ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? f( e ) : t } function f ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e } function h ( e ) { return ( h = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var d = n( 5 ).EventEmitter, _ = n( 2 ), p = n( 1 ), v = n( 7 ), m = n( 22 ), g = new _( "NonInviteClientTransaction" ), y = new _( "InviteClientTransaction" ), b = new _( "AckClientTransaction" ), T = new _( "NonInviteServerTransaction" ), S = new _( "InviteServerTransaction" ), C = { STATUS_TRYING: 1, STATUS_PROCEEDING: 2, STATUS_CALLING: 3, STATUS_ACCEPTED: 4, STATUS_COMPLETED: 5, STATUS_TERMINATED: 6, STATUS_CONFIRMED: 7, NON_INVITE_CLIENT: "nict", NON_INVITE_SERVER: "nist", INVITE_CLIENT: "ict", INVITE_SERVER: "ist" }, E = function ( e ) { s( n, e ); var t = a( n ); function n ( e, r, o, u ) { var s; i( this, n ), ( s = t.call( this ) ).type = C.NON_INVITE_CLIENT, s.id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.ua = e, s.transport = r, s.request = o, s.eventHandlers = u; var l = "SIP/2.0/".concat( r.via_transport ); return l += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", l ), s.ua.newTransaction( f( s ) ), s } return u( n, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "send", value: function () { var e = this; this.stateChanged( C.STATUS_TRYING ), this.F = setTimeout( ( function () { e.timer_F() } ), m.TIMER_F ), this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { g.debug( "transport error occurred, deleting transaction ".concat( this.id ) ), clearTimeout( this.F ), clearTimeout( this.K ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onTransportError() } }, { key: "timer_F", value: function () { g.debug( "Timer F expired for transaction ".concat( this.id ) ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onRequestTimeout() } }, { key: "timer_K", value: function () { this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "receiveResponse", value: function ( e ) { var t = this, n = e.status_code; if ( n < 200 ) switch ( this.state ) { case C.STATUS_TRYING: case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_PROCEEDING ), this.eventHandlers.onReceiveResponse( e ) } else switch ( this.state ) { case C.STATUS_TRYING: case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_COMPLETED ), clearTimeout( this.F ), 408 === n ? this.eventHandlers.onRequestTimeout() : this.eventHandlers.onReceiveResponse( e ), this.K = setTimeout( ( function () { t.timer_K() } ), m.TIMER_K ) } } }, { key: "C", get: function () { return C } }] ), n }( d ), A = function ( e ) { s( n, e ); var t = a( n ); function n ( e, r, o, u ) { var s; i( this, n ), ( s = t.call( this ) ).type = C.INVITE_CLIENT, s.id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.ua = e, s.transport = r, s.request = o, s.eventHandlers = u, o.transaction = f( s ); var l = "SIP/2.0/".concat( r.via_transport ); return l += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", l ), s.ua.newTransaction( f( s ) ), s } return u( n, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "send", value: function () { var e = this; this.stateChanged( C.STATUS_CALLING ), this.B = setTimeout( ( function () { e.timer_B() } ), m.TIMER_B ), this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { clearTimeout( this.B ), clearTimeout( this.D ), clearTimeout( this.M ), this.state !== C.STATUS_ACCEPTED && ( y.debug( "transport error occurred, deleting transaction ".concat( this.id ) ), this.eventHandlers.onTransportError() ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "timer_M", value: function () { y.debug( "Timer M expired for transaction ".concat( this.id ) ), this.state === C.STATUS_ACCEPTED && ( clearTimeout( this.B ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "timer_B", value: function () { y.debug( "Timer B expired for transaction ".concat( this.id ) ), this.state === C.STATUS_CALLING && ( this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ), this.eventHandlers.onRequestTimeout() ) } }, { key: "timer_D", value: function () { y.debug( "Timer D expired for transaction ".concat( this.id ) ), clearTimeout( this.B ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "sendACK", value: function ( e ) { var t = this, n = new v.OutgoingRequest( p.ACK, this.request.ruri, this.ua, { route_set: this.request.getHeaders( "route" ), call_id: this.request.getHeader( "call-id" ), cseq: this.request.cseq } ); n.setHeader( "from", this.request.getHeader( "from" ) ), n.setHeader( "via", this.request.getHeader( "via" ) ), n.setHeader( "to", e.getHeader( "to" ) ), this.D = setTimeout( ( function () { t.timer_D() } ), m.TIMER_D ), this.transport.send( n ) } }, { key: "cancel", value: function ( e ) { if ( this.state === C.STATUS_PROCEEDING ) { var t = new v.OutgoingRequest( p.CANCEL, this.request.ruri, this.ua, { route_set: this.request.getHeaders( "route" ), call_id: this.request.getHeader( "call-id" ), cseq: this.request.cseq } ); t.setHeader( "from", this.request.getHeader( "from" ) ), t.setHeader( "via", this.request.getHeader( "via" ) ), t.setHeader( "to", this.request.getHeader( "to" ) ), e && t.setHeader( "reason", e ), this.transport.send( t ) } } }, { key: "receiveResponse", value: function ( e ) { var t = this, n = e.status_code; if ( n >= 100 && n <= 199 ) switch ( this.state ) { case C.STATUS_CALLING: this.stateChanged( C.STATUS_PROCEEDING ), this.eventHandlers.onReceiveResponse( e ); break; case C.STATUS_PROCEEDING: this.eventHandlers.onReceiveResponse( e ) } else if ( n >= 200 && n <= 299 ) switch ( this.state ) { case C.STATUS_CALLING: case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_ACCEPTED ), this.M = setTimeout( ( function () { t.timer_M() } ), m.TIMER_M ), this.eventHandlers.onReceiveResponse( e ); break; case C.STATUS_ACCEPTED: this.eventHandlers.onReceiveResponse( e ) } else if ( n >= 300 && n <= 699 ) switch ( this.state ) { case C.STATUS_CALLING: case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_COMPLETED ), this.sendACK( e ), this.eventHandlers.onReceiveResponse( e ); break; case C.STATUS_COMPLETED: this.sendACK( e ) } } }, { key: "C", get: function () { return C } }] ), n }( d ), w = function ( e ) { s( n, e ); var t = a( n ); function n ( e, r, o, u ) { var s; i( this, n ), ( s = t.call( this ) ).id = "z9hG4bK".concat( Math.floor( 1e7 * Math.random() ) ), s.transport = r, s.request = o, s.eventHandlers = u; var l = "SIP/2.0/".concat( r.via_transport ); return l += " ".concat( e.configuration.via_host, ";branch=" ).concat( s.id ), s.request.setHeader( "via", l ), s } return u( n, [{ key: "send", value: function () { this.transport.send( this.request ) || this.onTransportError() } }, { key: "onTransportError", value: function () { b.debug( "transport error occurred for transaction ".concat( this.id ) ), this.eventHandlers.onTransportError() } }, { key: "C", get: function () { return C } }] ), n }( d ), R = function ( e ) { s( n, e ); var t = a( n ); function n ( e, r, o ) { var u; return i( this, n ), ( u = t.call( this ) ).type = C.NON_INVITE_SERVER, u.id = o.via_branch, u.ua = e, u.transport = r, u.request = o, u.last_response = "", o.server_transaction = f( u ), u.state = C.STATUS_TRYING, e.newTransaction( f( u ) ), u } return u( n, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "timer_J", value: function () { T.debug( "Timer J expired for transaction ".concat( this.id ) ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "onTransportError", value: function () { this.transportError || ( this.transportError = !0, T.debug( "transport error occurred, deleting transaction ".concat( this.id ) ), clearTimeout( this.J ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "receiveResponse", value: function ( e, t, n, r ) { var i = this; if ( 100 === e ) switch ( this.state ) { case C.STATUS_TRYING: this.stateChanged( C.STATUS_PROCEEDING ), this.transport.send( t ) || this.onTransportError(); break; case C.STATUS_PROCEEDING: this.last_response = t, this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } else if ( e >= 200 && e <= 699 ) switch ( this.state ) { case C.STATUS_TRYING: case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_COMPLETED ), this.last_response = t, this.J = setTimeout( ( function () { i.timer_J() } ), m.TIMER_J ), this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } } }, { key: "C", get: function () { return C } }] ), n }( d ), I = function ( e ) { s( n, e ); var t = a( n ); function n ( e, r, o ) { var u; return i( this, n ), ( u = t.call( this ) ).type = C.INVITE_SERVER, u.id = o.via_branch, u.ua = e, u.transport = r, u.request = o, u.last_response = "", o.server_transaction = f( u ), u.state = C.STATUS_PROCEEDING, e.newTransaction( f( u ) ), u.resendProvisionalTimer = null, o.reply( 100 ), u } return u( n, [{ key: "stateChanged", value: function ( e ) { this.state = e, this.emit( "stateChanged" ) } }, { key: "timer_H", value: function () { S.debug( "Timer H expired for transaction ".concat( this.id ) ), this.state === C.STATUS_COMPLETED && S.debug( "ACK not received, dialog will be terminated" ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "timer_I", value: function () { this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) } }, { key: "timer_L", value: function () { S.debug( "Timer L expired for transaction ".concat( this.id ) ), this.state === C.STATUS_ACCEPTED && ( this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "onTransportError", value: function () { this.transportError || ( this.transportError = !0, S.debug( "transport error occurred, deleting transaction ".concat( this.id ) ), null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ), clearTimeout( this.L ), clearTimeout( this.H ), clearTimeout( this.I ), this.stateChanged( C.STATUS_TERMINATED ), this.ua.destroyTransaction( this ) ) } }, { key: "resend_provisional", value: function () { this.transport.send( this.last_response ) || this.onTransportError() } }, { key: "receiveResponse", value: function ( e, t, n, r ) { var i = this; if ( e >= 100 && e <= 199 ) switch ( this.state ) { case C.STATUS_PROCEEDING: this.transport.send( t ) || this.onTransportError(), this.last_response = t }if ( e > 100 && e <= 199 && this.state === C.STATUS_PROCEEDING ) null === this.resendProvisionalTimer && ( this.resendProvisionalTimer = setInterval( ( function () { i.resend_provisional() } ), m.PROVISIONAL_RESPONSE_INTERVAL ) ); else if ( e >= 200 && e <= 299 ) switch ( this.state ) { case C.STATUS_PROCEEDING: this.stateChanged( C.STATUS_ACCEPTED ), this.last_response = t, this.L = setTimeout( ( function () { i.timer_L() } ), m.TIMER_L ), null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ); case C.STATUS_ACCEPTED: this.transport.send( t ) ? n && n() : ( this.onTransportError(), r && r() ) } else if ( e >= 300 && e <= 699 ) switch ( this.state ) { case C.STATUS_PROCEEDING: null !== this.resendProvisionalTimer && ( clearInterval( this.resendProvisionalTimer ), this.resendProvisionalTimer = null ), this.transport.send( t ) ? ( this.stateChanged( C.STATUS_COMPLETED ), this.H = setTimeout( ( function () { i.timer_H() } ), m.TIMER_H ), n && n() ) : ( this.onTransportError(), r && r() ) } } }, { key: "C", get: function () { return C } }] ), n }( d ); e.exports = { C: C, NonInviteClientTransaction: E, InviteClientTransaction: A, AckClientTransaction: w, NonInviteServerTransaction: R, InviteServerTransaction: I, checkTransaction: function ( e, t ) { var n, r = e._transactions; switch ( t.method ) { case p.INVITE: if ( n = r.ist[t.via_branch] ) { switch ( n.state ) { case C.STATUS_PROCEEDING: n.transport.send( n.last_response ) }return !0 } break; case p.ACK: if ( !( n = r.ist[t.via_branch] ) ) return !1; if ( n.state === C.STATUS_ACCEPTED ) return !1; if ( n.state === C.STATUS_COMPLETED ) return n.state = C.STATUS_CONFIRMED, n.I = setTimeout( ( function () { n.timer_I() } ), m.TIMER_I ), !0; break; case p.CANCEL: return ( n = r.ist[t.via_branch] ) ? ( t.reply_sl( 200 ), n.state !== C.STATUS_PROCEEDING ) : ( t.reply_sl( 481 ), !0 ); default: if ( n = r.nist[t.via_branch] ) { switch ( n.state ) { case C.STATUS_TRYING: break; case C.STATUS_PROCEEDING: case C.STATUS_COMPLETED: n.transport.send( n.last_response ) }return !0 } } } } }, function ( e, t, n ) { "use strict"; ( function ( e ) { var n = "object" == typeof e && e && e.Object === Object && e; t.a = n } ).call( this, n( 17 ) ) }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function i ( e, t, n ) { return t && r( e.prototype, t ), n && r( e, n ), e } var o = n( 9 ), u = n( 6 ); e.exports = function () { function e ( t, n, r ) { if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), !( t && t instanceof o ) ) throw new TypeError( 'missing or invalid "uri" parameter' ); for ( var i in this._uri = t, this._parameters = {}, this.display_name = n, r ) Object.prototype.hasOwnProperty.call( r, i ) && this.setParam( i, r[i] ) } return i( e, null, [{ key: "parse", value: function ( e ) { return -1 !== ( e = u.parse( e, "Name_Addr_Header" ) ) ? e : void 0 } }] ), i( e, [{ key: "setParam", value: function ( e, t ) { e && ( this._parameters[e.toLowerCase()] = null == t ? null : t.toString() ) } }, { key: "getParam", value: function ( e ) { if ( e ) return this._parameters[e.toLowerCase()] } }, { key: "hasParam", value: function ( e ) { if ( e ) return !!this._parameters.hasOwnProperty( e.toLowerCase() ) } }, { key: "deleteParam", value: function ( e ) { if ( e = e.toLowerCase(), this._parameters.hasOwnProperty( e ) ) { var t = this._parameters[e]; return delete this._parameters[e], t } } }, { key: "clearParams", value: function () { this._parameters = {} } }, { key: "clone", value: function () { return new e( this._uri.clone(), this._display_name, JSON.parse( JSON.stringify( this._parameters ) ) ) } }, { key: "_quote", value: function ( e ) { return e.replace( /\\/g, "\\\\" ).replace( /"/g, '\\"' ) } }, { key: "toString", value: function () { var e = this._display_name ? '"'.concat( this._quote( this._display_name ), '" ' ) : ""; for ( var t in e += "<".concat( this._uri.toString(), ">" ), this._parameters ) Object.prototype.hasOwnProperty.call( this._parameters, t ) && ( e += ";".concat( t ), null !== this._parameters[t] && ( e += "=".concat( this._parameters[t] ) ) ); return e } }, { key: "uri", get: function () { return this._uri } }, { key: "display_name", get: function () { return this._display_name }, set: function ( e ) { this._display_name = 0 === e ? "0" : e } }] ), e }() }, function ( e, t, n ) { ( function ( r ) { t.formatArgs = function ( t ) { if ( t[0] = ( this.useColors ? "%c" : "" ) + this.namespace + ( this.useColors ? " %c" : " " ) + t[0] + ( this.useColors ? "%c " : " " ) + "+" + e.exports.humanize( this.diff ), !this.useColors ) return; const n = "color: " + this.color; t.splice( 1, 0, n, "color: inherit" ); let r = 0, i = 0; t[0].replace( /%[a-zA-Z%]/g, e => { "%%" !== e && ( r++, "%c" === e && ( i = r ) ) } ), t.splice( i, 0, n ) }, t.save = function ( e ) { try { e ? t.storage.setItem( "debug", e ) : t.storage.removeItem( "debug" ) } catch ( e ) { } }, t.load = function () { let e; try { e = t.storage.getItem( "debug" ) } catch ( e ) { } !e && void 0 !== r && "env" in r && ( e = r.env.DEBUG ); return e }, t.useColors = function () { if ( "undefined" != typeof window && window.process && ( "renderer" === window.process.type || window.process.__nwjs ) ) return !0; if ( "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match( /(edge|trident)\/(\d+)/ ) ) return !1; return "undefined" != typeof document && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || "undefined" != typeof window && window.console && ( window.console.firebug || window.console.exception && window.console.table ) || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match( /firefox\/(\d+)/ ) && parseInt( RegExp.$1, 10 ) >= 31 || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match( /applewebkit\/(\d+)/ ) }, t.storage = function () { try { return localStorage } catch ( e ) { } }(), t.destroy = ( () => { let e = !1; return () => { e || ( e = !0, console.warn( "Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`." ) ) } } )(), t.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"], t.log = console.debug || console.log || ( () => { } ), e.exports = n( 31 )( t ); const { formatters: i } = e.exports; i.j = function ( e ) { try { return JSON.stringify( e ) } catch ( e ) { return "[UnexpectedJSONParseError]: " + e.message } } } ).call( this, n( 30 ) ) }, function ( e, t, n ) { "use strict"; ( function ( e ) { var r = n( 13 ), i = "object" == typeof exports && exports && !exports.nodeType && exports, o = i && "object" == typeof e && e && !e.nodeType && e, u = o && o.exports === i && r.a.process, s = function () { try { var e = o && o.require && o.require( "util" ).types; return e || u && u.binding && u.binding( "util" ) } catch ( e ) { } }(); t.a = s } ).call( this, n( 18 )( e ) ) }, function ( e, t ) { var n; n = function () { return this }(); try { n = n || new Function( "return this" )() } catch ( e ) { "object" == typeof window && ( n = window ) } e.exports = n }, function ( e, t ) { e.exports = function ( e ) { if ( !e.webpackPolyfill ) { var t = Object.create( e ); t.children || ( t.children = [] ), Object.defineProperty( t, "loaded", { enumerable: !0, get: function () { return t.l } } ), Object.defineProperty( t, "id", { enumerable: !0, get: function () { return t.i } } ), Object.defineProperty( t, "exports", { enumerable: !0 } ), t.webpackPolyfill = 1 } return t } }, function ( e ) { e.exports = JSON.parse( '{"name":"jssip","title":"JsSIP","description":"the Javascript SIP library","version":"3.9.0","homepage":"https://jssip.net","contributors":["José Luis Millán <jmillan@aliax.net> (https://github.com/jmillan)","Iñaki Baz Castillo <ibc@aliax.net> (https://inakibaz.me)"],"types":"lib/JsSIP.d.ts","main":"lib-es5/JsSIP.js","keywords":["sip","websocket","webrtc","node","browser","library"],"license":"MIT","repository":{"type":"git","url":"https://github.com/versatica/JsSIP.git"},"bugs":{"url":"https://github.com/versatica/JsSIP/issues"},"dependencies":{"@types/debug":"^4.1.5","@types/node":"^14.14.34","debug":"^4.3.1","events":"^3.3.0","sdp-transform":"^2.14.1"},"devDependencies":{"@babel/core":"^7.13.10","@babel/preset-env":"^7.13.10","ansi-colors":"^3.2.4","browserify":"^16.5.1","eslint":"^5.16.0","fancy-log":"^1.3.3","gulp":"^4.0.2","gulp-babel":"^8.0.0","gulp-eslint":"^5.0.0","gulp-expect-file":"^1.0.2","gulp-header":"^2.0.9","gulp-nodeunit-runner":"^0.2.2","gulp-plumber":"^1.2.1","gulp-rename":"^1.4.0","gulp-uglify-es":"^1.0.4","pegjs":"^0.7.0","vinyl-buffer":"^1.0.1","vinyl-source-stream":"^2.0.0"},"scripts":{"lint":"gulp lint","test":"gulp test","prepublishOnly":"gulp babel"}}' ) }, function ( e, t, n ) { var r = n( 34 ), i = n( 35 ); t.write = i, t.parse = r.parse, t.parseParams = r.parseParams, t.parseFmtpConfig = r.parseFmtpConfig, t.parsePayloads = r.parsePayloads, t.parseRemoteCandidates = r.parseRemoteCandidates, t.parseImageAttributes = r.parseImageAttributes, t.parseSimulcastStreamList = r.parseSimulcastStreamList }, function ( e, t ) { var n = e.exports = { v: [{ name: "version", reg: /^(\d*)$/ }], o: [{ name: "origin", reg: /^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/, names: ["username", "sessionId", "sessionVersion", "netType", "ipVer", "address"], format: "%s %s %d %s IP%d %s" }], s: [{ name: "name" }], i: [{ name: "description" }], u: [{ name: "uri" }], e: [{ name: "email" }], p: [{ name: "phone" }], z: [{ name: "timezones" }], r: [{ name: "repeats" }], t: [{ name: "timing", reg: /^(\d*) (\d*)/, names: ["start", "stop"], format: "%d %d" }], c: [{ name: "connection", reg: /^IN IP(\d) (\S*)/, names: ["version", "ip"], format: "IN IP%d %s" }], b: [{ push: "bandwidth", reg: /^(TIAS|AS|CT|RR|RS):(\d*)/, names: ["type", "limit"], format: "%s:%s" }], m: [{ reg: /^(\w*) (\d*) ([\w/]*)(?: (.*))?/, names: ["type", "port", "protocol", "payloads"], format: "%s %d %s %s" }], a: [{ push: "rtp", reg: /^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/, names: ["payload", "codec", "rate", "encoding"], format: function ( e ) { return e.encoding ? "rtpmap:%d %s/%s/%s" : e.rate ? "rtpmap:%d %s/%s" : "rtpmap:%d %s" } }, { push: "fmtp", reg: /^fmtp:(\d*) ([\S| ]*)/, names: ["payload", "config"], format: "fmtp:%d %s" }, { name: "control", reg: /^control:(.*)/, format: "control:%s" }, { name: "rtcp", reg: /^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/, names: ["port", "netType", "ipVer", "address"], format: function ( e ) { return null != e.address ? "rtcp:%d %s IP%d %s" : "rtcp:%d" } }, { push: "rtcpFbTrrInt", reg: /^rtcp-fb:(\*|\d*) trr-int (\d*)/, names: ["payload", "value"], format: "rtcp-fb:%s trr-int %d" }, { push: "rtcpFb", reg: /^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/, names: ["payload", "type", "subtype"], format: function ( e ) { return null != e.subtype ? "rtcp-fb:%s %s %s" : "rtcp-fb:%s %s" } }, { push: "ext", reg: /^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/, names: ["value", "direction", "encrypt-uri", "uri", "config"], format: function ( e ) { return "extmap:%d" + ( e.direction ? "/%s" : "%v" ) + ( e["encrypt-uri"] ? " %s" : "%v" ) + " %s" + ( e.config ? " %s" : "" ) } }, { name: "extmapAllowMixed", reg: /^(extmap-allow-mixed)/ }, { push: "crypto", reg: /^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/, names: ["id", "suite", "config", "sessionConfig"], format: function ( e ) { return null != e.sessionConfig ? "crypto:%d %s %s %s" : "crypto:%d %s %s" } }, { name: "setup", reg: /^setup:(\w*)/, format: "setup:%s" }, { name: "connectionType", reg: /^connection:(new|existing)/, format: "connection:%s" }, { name: "mid", reg: /^mid:([^\s]*)/, format: "mid:%s" }, { name: "msid", reg: /^msid:(.*)/, format: "msid:%s" }, { name: "ptime", reg: /^ptime:(\d*(?:\.\d*)*)/, format: "ptime:%d" }, { name: "maxptime", reg: /^maxptime:(\d*(?:\.\d*)*)/, format: "maxptime:%d" }, { name: "direction", reg: /^(sendrecv|recvonly|sendonly|inactive)/ }, { name: "icelite", reg: /^(ice-lite)/ }, { name: "iceUfrag", reg: /^ice-ufrag:(\S*)/, format: "ice-ufrag:%s" }, { name: "icePwd", reg: /^ice-pwd:(\S*)/, format: "ice-pwd:%s" }, { name: "fingerprint", reg: /^fingerprint:(\S*) (\S*)/, names: ["type", "hash"], format: "fingerprint:%s %s" }, { push: "candidates", reg: /^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/, names: ["foundation", "component", "transport", "priority", "ip", "port", "type", "raddr", "rport", "tcptype", "generation", "network-id", "network-cost"], format: function ( e ) { var t = "candidate:%s %d %s %d %s %d typ %s"; return t += null != e.raddr ? " raddr %s rport %d" : "%v%v", t += null != e.tcptype ? " tcptype %s" : "%v", null != e.generation && ( t += " generation %d" ), t += null != e["network-id"] ? " network-id %d" : "%v", t += null != e["network-cost"] ? " network-cost %d" : "%v" } }, { name: "endOfCandidates", reg: /^(end-of-candidates)/ }, { name: "remoteCandidates", reg: /^remote-candidates:(.*)/, format: "remote-candidates:%s" }, { name: "iceOptions", reg: /^ice-options:(\S*)/, format: "ice-options:%s" }, { push: "ssrcs", reg: /^ssrc:(\d*) ([\w_-]*)(?::(.*))?/, names: ["id", "attribute", "value"], format: function ( e ) { var t = "ssrc:%d"; return null != e.attribute && ( t += " %s", null != e.value && ( t += ":%s" ) ), t } }, { push: "ssrcGroups", reg: /^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/, names: ["semantics", "ssrcs"], format: "ssrc-group:%s %s" }, { name: "msidSemantic", reg: /^msid-semantic:\s?(\w*) (\S*)/, names: ["semantic", "token"], format: "msid-semantic: %s %s" }, { push: "groups", reg: /^group:(\w*) (.*)/, names: ["type", "mids"], format: "group:%s %s" }, { name: "rtcpMux", reg: /^(rtcp-mux)/ }, { name: "rtcpRsize", reg: /^(rtcp-rsize)/ }, { name: "sctpmap", reg: /^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/, names: ["sctpmapNumber", "app", "maxMessageSize"], format: function ( e ) { return null != e.maxMessageSize ? "sctpmap:%s %s %s" : "sctpmap:%s %s" } }, { name: "xGoogleFlag", reg: /^x-google-flag:([^\s]*)/, format: "x-google-flag:%s" }, { push: "rids", reg: /^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/, names: ["id", "direction", "params"], format: function ( e ) { return e.params ? "rid:%s %s %s" : "rid:%s %s" } }, { push: "imageattrs", reg: new RegExp( "^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?" ), names: ["pt", "dir1", "attrs1", "dir2", "attrs2"], format: function ( e ) { return "imageattr:%s %s %s" + ( e.dir2 ? " %s %s" : "" ) } }, { name: "simulcast", reg: new RegExp( "^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$" ), names: ["dir1", "list1", "dir2", "list2"], format: function ( e ) { return "simulcast:%s %s" + ( e.dir2 ? " %s %s" : "" ) } }, { name: "simulcast_03", reg: /^simulcast:[\s\t]+([\S+\s\t]+)$/, names: ["value"], format: "simulcast: %s" }, { name: "framerate", reg: /^framerate:(\d+(?:$|\.\d+))/, format: "framerate:%s" }, { name: "sourceFilter", reg: /^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/, names: ["filterMode", "netType", "addressTypes", "destAddress", "srcList"], format: "source-filter: %s %s %s %s %s" }, { name: "bundleOnly", reg: /^(bundle-only)/ }, { name: "label", reg: /^label:(.+)/, format: "label:%s" }, { name: "sctpPort", reg: /^sctp-port:(\d+)$/, format: "sctp-port:%s" }, { name: "maxMessageSize", reg: /^max-message-size:(\d+)$/, format: "max-message-size:%s" }, { push: "tsRefClocks", reg: /^ts-refclk:([^\s=]*)(?:=(\S*))?/, names: ["clksrc", "clksrcExt"], format: function ( e ) { return "ts-refclk:%s" + ( null != e.clksrcExt ? "=%s" : "" ) } }, { name: "mediaClk", reg: /^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/, names: ["id", "mediaClockName", "mediaClockValue", "rateNumerator", "rateDenominator"], format: function ( e ) { var t = "mediaclk:"; return t += null != e.id ? "id=%s %s" : "%v%s", t += null != e.mediaClockValue ? "=%s" : "", t += null != e.rateNumerator ? " rate=%s" : "", t += null != e.rateDenominator ? "/%s" : "" } }, { name: "keywords", reg: /^keywds:(.+)$/, format: "keywds:%s" }, { name: "content", reg: /^content:(.+)/, format: "content:%s" }, { name: "bfcpFloorCtrl", reg: /^floorctrl:(c-only|s-only|c-s)/, format: "floorctrl:%s" }, { name: "bfcpConfId", reg: /^confid:(\d+)/, format: "confid:%s" }, { name: "bfcpUserId", reg: /^userid:(\d+)/, format: "userid:%s" }, { name: "bfcpFloorId", reg: /^floorid:(.+) (?:m-stream|mstrm):(.+)/, names: ["id", "mStream"], format: "floorid:%s mstrm:%s" }, { push: "invalid", names: ["value"] }] }; Object.keys( n ).forEach( ( function ( e ) { n[e].forEach( ( function ( e ) { e.reg || ( e.reg = /(.*)/ ), e.format || ( e.format = "%s" ) } ) ) } ) ) }, function ( e, t, n ) { "use strict"; var r = 500; e.exports = { T1: r, T2: 4e3, T4: 5e3, TIMER_B: 32e3, TIMER_D: 0, TIMER_F: 32e3, TIMER_H: 32e3, TIMER_I: 0, TIMER_J: 0, TIMER_K: 0, TIMER_L: 32e3, TIMER_M: 32e3, PROVISIONAL_RESPONSE_INTERVAL: 6e4 } }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return o( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return o( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, i = function () { }; return { s: i, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: i } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function o ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } function u ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function s ( e, t, n ) { return t && u( e.prototype, t ), n && u( e, n ), e } function l ( e, t ) { return ( l = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function a ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = f( e ); if ( t ) { var i = f( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return c( this, n ) } } function c ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function f ( e ) { return ( f = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var h = n( 5 ).EventEmitter, d = n( 20 ), _ = n( 2 ), p = n( 1 ), v = n( 8 ), m = n( 12 ), g = n( 3 ), y = n( 22 ), b = n( 7 ), T = n( 37 ), S = n( 11 ), C = n( 39 ), E = n( 40 ), A = n( 41 ), w = n( 42 ), R = n( 9 ), I = new _( "RTCSession" ), O = { STATUS_NULL: 0, STATUS_INVITE_SENT: 1, STATUS_1XX_RECEIVED: 2, STATUS_INVITE_RECEIVED: 3, STATUS_WAITING_FOR_ANSWER: 4, STATUS_ANSWERED: 5, STATUS_WAITING_FOR_ACK: 6, STATUS_CANCELED: 7, STATUS_TERMINATED: 8, STATUS_CONFIRMED: 9 }, k = ["audio", "video"]; e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && l( e, t ) }( n, e ); var t = a( n ); function n ( e ) { var r; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, n ), I.debug( "new" ), ( r = t.call( this ) )._id = null, r._ua = e, r._status = O.STATUS_NULL, r._dialog = null, r._earlyDialogs = {}, r._contact = null, r._from_tag = null, r._to_tag = null, r._connection = null, r._connectionPromiseQueue = Promise.resolve(), r._request = null, r._is_canceled = !1, r._cancel_reason = "", r._is_confirmed = !1, r._late_sdp = !1, r._rtcOfferConstraints = null, r._rtcAnswerConstraints = null, r._localMediaStream = null, r._localMediaStreamLocallyGenerated = !1, r._rtcReady = !0, r._iceReady = !1, r._timers = { ackTimer: null, expiresTimer: null, invite2xxTimer: null, userNoAnswerTimer: null }, r._direction = null, r._local_identity = null, r._remote_identity = null, r._start_time = null, r._end_time = null, r._tones = null, r._audioMuted = !1, r._videoMuted = !1, r._localHold = !1, r._remoteHold = !1, r._sessionTimers = { enabled: r._ua.configuration.session_timers, refreshMethod: r._ua.configuration.session_timers_refresh_method, defaultExpires: p.SESSION_EXPIRES, currentExpires: null, running: !1, refresher: !1, timer: null }, r._referSubscribers = {}, r._data = {}, r } return s( n, null, [{ key: "C", get: function () { return O } }] ), s( n, [{ key: "isInProgress", value: function () { switch ( this._status ) { case O.STATUS_NULL: case O.STATUS_INVITE_SENT: case O.STATUS_1XX_RECEIVED: case O.STATUS_INVITE_RECEIVED: case O.STATUS_WAITING_FOR_ANSWER: return !0; default: return !1 } } }, { key: "isEstablished", value: function () { switch ( this._status ) { case O.STATUS_ANSWERED: case O.STATUS_WAITING_FOR_ACK: case O.STATUS_CONFIRMED: return !0; default: return !1 } } }, { key: "isEnded", value: function () { switch ( this._status ) { case O.STATUS_CANCELED: case O.STATUS_TERMINATED: return !0; default: return !1 } } }, { key: "isMuted", value: function () { return { audio: this._audioMuted, video: this._videoMuted } } }, { key: "isOnHold", value: function () { return { local: this._localHold, remote: this._remoteHold } } }, { key: "connect", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, n = arguments.length > 2 ? arguments[2] : void 0; I.debug( "connect()" ); var r = e, i = g.cloneObject( t.eventHandlers ), o = g.cloneArray( t.extraHeaders ), u = g.cloneObject( t.mediaConstraints, { audio: !0, video: !0 } ), s = t.mediaStream || null, l = g.cloneObject( t.pcConfig, { iceServers: [] } ), a = t.rtcConstraints || null, c = t.rtcOfferConstraints || null; if ( this._rtcOfferConstraints = c, this._rtcAnswerConstraints = t.rtcAnswerConstraints || null, this._data = t.data || this._data, void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._status !== O.STATUS_NULL ) throw new v.InvalidStateError( this._status ); if ( !window.RTCPeerConnection ) throw new v.NotSupportedError( "WebRTC not supported" ); if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( r ) ); for ( var f in this._sessionTimers.enabled && g.isDecimal( t.sessionTimersExpires ) && ( t.sessionTimersExpires >= p.MIN_SESSION_EXPIRES ? this._sessionTimers.defaultExpires = t.sessionTimersExpires : this._sessionTimers.defaultExpires = p.SESSION_EXPIRES ), i ) Object.prototype.hasOwnProperty.call( i, f ) && this.on( f, i[f] ); this._from_tag = g.newTag(); var h = t.anonymous || !1, d = { from_tag: this._from_tag }; this._contact = this._ua.contact.toString( { anonymous: h, outbound: !0 } ), h ? ( d.from_display_name = "Anonymous", d.from_uri = new R( "sip", "anonymous", "anonymous.invalid" ), o.push( "P-Preferred-Identity: ".concat( this._ua.configuration.uri.toString() ) ), o.push( "Privacy: id" ) ) : t.fromUserName && ( d.from_uri = new R( "sip", t.fromUserName, this._ua.configuration.uri.host ), o.push( "P-Preferred-Identity: ".concat( this._ua.configuration.uri.toString() ) ) ), t.fromDisplayName && ( d.from_display_name = t.fromDisplayName ), o.push( "Contact: ".concat( this._contact ) ), o.push( "Content-Type: application/sdp" ), this._sessionTimers.enabled && o.push( "Session-Expires: ".concat( this._sessionTimers.defaultExpires ).concat( this._ua.configuration.session_timers_force_refresher ? ";refresher=uac" : "" ) ), this._request = new b.InitialOutgoingInviteRequest( e, this._ua, d, o ), this._id = this._request.call_id + this._from_tag, this._createRTCConnection( l, a ), this._direction = "outgoing", this._local_identity = this._request.from, this._remote_identity = this._request.to, n && n( this ), this._newRTCSession( "local", this._request ), this._sendInitialRequest( u, c, s ) } }, { key: "init_incoming", value: function ( e, t ) { var n, r = this; I.debug( "init_incoming()" ); var i = e.hasHeader( "Content-Type" ) ? e.getHeader( "Content-Type" ).toLowerCase() : void 0; e.body && "application/sdp" !== i ? e.reply( 415 ) : ( this._status = O.STATUS_INVITE_RECEIVED, this._from_tag = e.from_tag, this._id = e.call_id + this._from_tag, this._request = e, this._contact = this._ua.contact.toString(), e.hasHeader( "expires" ) && ( n = 1e3 * e.getHeader( "expires" ) ), e.to_tag = g.newTag(), this._createDialog( e, "UAS", !0 ) ? ( e.body ? this._late_sdp = !1 : this._late_sdp = !0, this._status = O.STATUS_WAITING_FOR_ANSWER, this._timers.userNoAnswerTimer = setTimeout( ( function () { e.reply( 408 ), r._failed( "local", null, p.causes.NO_ANSWER ) } ), this._ua.configuration.no_answer_timeout ), n && ( this._timers.expiresTimer = setTimeout( ( function () { r._status === O.STATUS_WAITING_FOR_ANSWER && ( e.reply( 487 ), r._failed( "system", null, p.causes.EXPIRES ) ) } ), n ) ), this._direction = "incoming", this._local_identity = e.to, this._remote_identity = e.from, t && t( this ), this._newRTCSession( "remote", e ), this._status !== O.STATUS_TERMINATED && ( e.reply( 180, null, ["Contact: ".concat( this._contact )] ), this._progress( "local", null ) ) ) : e.reply( 500, "Missing Contact header field" ) ) } }, { key: "answer", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; I.debug( "answer()" ); var n = this._request, r = g.cloneArray( t.extraHeaders ), o = g.cloneObject( t.mediaConstraints ), u = t.mediaStream || null, s = g.cloneObject( t.pcConfig, { iceServers: [] } ), l = t.rtcConstraints || null, a = t.rtcAnswerConstraints || null, c = g.cloneObject( t.rtcOfferConstraints ), f = !1, h = !1, d = !1, _ = !1; if ( this._rtcAnswerConstraints = a, this._rtcOfferConstraints = t.rtcOfferConstraints || null, this._data = t.data || this._data, "incoming" !== this._direction ) throw new v.NotSupportedError( '"answer" not supported for outgoing RTCSession' ); if ( this._status !== O.STATUS_WAITING_FOR_ANSWER ) throw new v.InvalidStateError( this._status ); if ( this._sessionTimers.enabled && g.isDecimal( t.sessionTimersExpires ) && ( t.sessionTimersExpires >= p.MIN_SESSION_EXPIRES ? this._sessionTimers.defaultExpires = t.sessionTimersExpires : this._sessionTimers.defaultExpires = p.SESSION_EXPIRES ), this._status = O.STATUS_ANSWERED, this._createDialog( n, "UAS" ) ) { clearTimeout( this._timers.userNoAnswerTimer ), r.unshift( "Contact: ".concat( this._contact ) ); var m = n.parseSDP(); Array.isArray( m.media ) || ( m.media = [m.media] ); var y, b = i( m.media ); try { for ( b.s(); !( y = b.n() ).done; ) { var T = y.value; "audio" === T.type && ( f = !0, T.direction && "sendrecv" !== T.direction || ( d = !0 ) ), "video" === T.type && ( h = !0, T.direction && "sendrecv" !== T.direction || ( _ = !0 ) ) } } catch ( e ) { b.e( e ) } finally { b.f() } if ( u && !1 === o.audio ) { var S, C = i( u.getAudioTracks() ); try { for ( C.s(); !( S = C.n() ).done; ) { var E = S.value; u.removeTrack( E ) } } catch ( e ) { C.e( e ) } finally { C.f() } } if ( u && !1 === o.video ) { var A, w = i( u.getVideoTracks() ); try { for ( w.s(); !( A = w.n() ).done; ) { var R = A.value; u.removeTrack( R ) } } catch ( e ) { w.e( e ) } finally { w.f() } } u || void 0 !== o.audio || ( o.audio = d ), u || void 0 !== o.video || ( o.video = _ ), u || f || c.offerToReceiveAudio || ( o.audio = !1 ), u || h || c.offerToReceiveVideo || ( o.video = !1 ), this._createRTCConnection( s, l ), Promise.resolve().then( ( function () { return u || ( o.audio || o.video ? ( e._localMediaStreamLocallyGenerated = !0, navigator.mediaDevices.getUserMedia( o ).catch( ( function ( t ) { if ( e._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); throw n.reply( 480 ), e._failed( "local", null, p.causes.USER_DENIED_MEDIA_ACCESS ), I.warn( 'emit "getusermediafailed" [error:%o]', t ), e.emit( "getusermediafailed", t ), new Error( "getUserMedia() failed" ) } ) ) ) : void 0 ) } ) ).then( ( function ( t ) { if ( e._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); e._localMediaStream = t, t && t.getTracks().forEach( ( function ( n ) { e._connection.addTrack( n, t ) } ) ) } ) ).then( ( function () { if ( !e._late_sdp ) { var t = { originator: "remote", type: "offer", sdp: n.body }; I.debug( 'emit "sdp"' ), e.emit( "sdp", t ); var r = new RTCSessionDescription( { type: "offer", sdp: t.sdp } ); return e._connectionPromiseQueue = e._connectionPromiseQueue.then( ( function () { return e._connection.setRemoteDescription( r ) } ) ).catch( ( function ( t ) { throw n.reply( 488 ), e._failed( "system", null, p.causes.WEBRTC_ERROR ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', t ), e.emit( "peerconnection:setremotedescriptionfailed", t ), new Error( "peerconnection.setRemoteDescription() failed" ) } ) ), e._connectionPromiseQueue } } ) ).then( ( function () { if ( e._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); return e._connecting( n ), e._late_sdp ? e._createLocalDescription( "offer", e._rtcOfferConstraints ).catch( ( function () { throw n.reply( 500 ), new Error( "_createLocalDescription() failed" ) } ) ) : e._createLocalDescription( "answer", a ).catch( ( function () { throw n.reply( 500 ), new Error( "_createLocalDescription() failed" ) } ) ) } ) ).then( ( function ( t ) { if ( e._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); e._handleSessionTimersInIncomingRequest( n, r ), n.reply( 200, null, r, t, ( function () { e._status = O.STATUS_WAITING_FOR_ACK, e._setInvite2xxTimer( n, t ), e._setACKTimer(), e._accepted( "local" ) } ), ( function () { e._failed( "system", null, p.causes.CONNECTION_ERROR ) } ) ) } ) ).catch( ( function ( t ) { e._status !== O.STATUS_TERMINATED && I.warn( t ) } ) ) } else n.reply( 500, "Error creating dialog" ) } }, { key: "terminate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; I.debug( "terminate()" ); var n, r = t.cause || p.causes.BYE, i = g.cloneArray( t.extraHeaders ), o = t.body, u = t.status_code, s = t.reason_phrase; if ( this._status === O.STATUS_TERMINATED ) throw new v.InvalidStateError( this._status ); switch ( this._status ) { case O.STATUS_NULL: case O.STATUS_INVITE_SENT: case O.STATUS_1XX_RECEIVED: if ( I.debug( "canceling session" ), u && ( u < 200 || u >= 700 ) ) throw new TypeError( "Invalid status_code: ".concat( u ) ); u && ( s = s || p.REASON_PHRASE[u] || "", n = "SIP ;cause=".concat( u, ' ;text="' ).concat( s, '"' ) ), this._status === O.STATUS_NULL || this._status === O.STATUS_INVITE_SENT ? ( this._is_canceled = !0, this._cancel_reason = n ) : this._status === O.STATUS_1XX_RECEIVED && this._request.cancel( n ), this._status = O.STATUS_CANCELED, this._failed( "local", null, p.causes.CANCELED ); break; case O.STATUS_WAITING_FOR_ANSWER: case O.STATUS_ANSWERED: if ( I.debug( "rejecting session" ), ( u = u || 480 ) < 300 || u >= 700 ) throw new TypeError( "Invalid status_code: ".concat( u ) ); this._request.reply( u, s, i, o ), this._failed( "local", null, p.causes.REJECTED ); break; case O.STATUS_WAITING_FOR_ACK: case O.STATUS_CONFIRMED: if ( I.debug( "terminating session" ), s = t.reason_phrase || p.REASON_PHRASE[u] || "", u && ( u < 200 || u >= 700 ) ) throw new TypeError( "Invalid status_code: ".concat( u ) ); if ( u && i.push( "Reason: SIP ;cause=".concat( u, '; text="' ).concat( s, '"' ) ), this._status === O.STATUS_WAITING_FOR_ACK && "incoming" === this._direction && this._request.server_transaction.state !== m.C.STATUS_TERMINATED ) { var l = this._dialog; this.receiveRequest = function ( t ) { t.method === p.ACK && ( e.sendRequest( p.BYE, { extraHeaders: i, body: o } ), l.terminate() ) }, this._request.server_transaction.on( "stateChanged", ( function () { e._request.server_transaction.state === m.C.STATUS_TERMINATED && ( e.sendRequest( p.BYE, { extraHeaders: i, body: o } ), l.terminate() ) } ) ), this._ended( "local", null, r ), this._dialog = l, this._ua.newDialog( l ) } else this.sendRequest( p.BYE, { extraHeaders: i, body: o } ), this._ended( "local", null, r ) } } }, { key: "sendDTMF", value: function ( e ) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; I.debug( "sendDTMF() | tones: %s", e ); var n = 0, r = t.duration || null, i = t.interToneGap || null, o = t.transportType || p.DTMF_TRANSPORT.INFO; if ( void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._status !== O.STATUS_CONFIRMED && this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_1XX_RECEIVED ) throw new v.InvalidStateError( this._status ); if ( o !== p.DTMF_TRANSPORT.INFO && o !== p.DTMF_TRANSPORT.RFC2833 ) throw new TypeError( "invalid transportType: ".concat( o ) ); if ( "number" == typeof e && ( e = e.toString() ), !e || "string" != typeof e || !e.match( /^[0-9A-DR#*,]+$/i ) ) throw new TypeError( "Invalid tones: ".concat( e ) ); if ( r && !g.isDecimal( r ) ) throw new TypeError( "Invalid tone duration: ".concat( r ) ); if ( r ? r < C.C.MIN_DURATION ? ( I.debug( '"duration" value is lower than the minimum allowed, setting it to '.concat( C.C.MIN_DURATION, " milliseconds" ) ), r = C.C.MIN_DURATION ) : r > C.C.MAX_DURATION ? ( I.debug( '"duration" value is greater than the maximum allowed, setting it to '.concat( C.C.MAX_DURATION, " milliseconds" ) ), r = C.C.MAX_DURATION ) : r = Math.abs( r ) : r = C.C.DEFAULT_DURATION, t.duration = r, i && !g.isDecimal( i ) ) throw new TypeError( "Invalid interToneGap: ".concat( i ) ); if ( i ? i < C.C.MIN_INTER_TONE_GAP ? ( I.debug( '"interToneGap" value is lower than the minimum allowed, setting it to '.concat( C.C.MIN_INTER_TONE_GAP, " milliseconds" ) ), i = C.C.MIN_INTER_TONE_GAP ) : i = Math.abs( i ) : i = C.C.DEFAULT_INTER_TONE_GAP, o !== p.DTMF_TRANSPORT.RFC2833 ) this._tones ? this._tones += e : ( this._tones = e, s.call( this ) ); else { var u = this._getDTMFRTPSender(); u && ( e = u.toneBuffer + e, u.insertDTMF( e, r, i ) ) } function s () { var e, o = this; if ( this._status === O.STATUS_TERMINATED || !this._tones || n >= this._tones.length ) this._tones = null; else { var u = this._tones[n]; if ( n += 1, "," === u ) e = 2e3; else { var l = new C( this ); t.eventHandlers = { onFailed: function () { o._tones = null } }, l.send( u, t ), e = r + i } setTimeout( s.bind( this ), e ) } } } }, { key: "sendInfo", value: function ( e, t ) { var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; if ( I.debug( "sendInfo()" ), this._status !== O.STATUS_CONFIRMED && this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_1XX_RECEIVED ) throw new v.InvalidStateError( this._status ); var r = new E( this ); r.send( e, t, n ) } }, { key: "mute", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : { audio: !0, video: !1 }; I.debug( "mute()" ); var t = !1, n = !1; !1 === this._audioMuted && e.audio && ( t = !0, this._audioMuted = !0, this._toggleMuteAudio( !0 ) ), !1 === this._videoMuted && e.video && ( n = !0, this._videoMuted = !0, this._toggleMuteVideo( !0 ) ), !0 !== t && !0 !== n || this._onmute( { audio: t, video: n } ) } }, { key: "unmute", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : { audio: !0, video: !0 }; I.debug( "unmute()" ); var t = !1, n = !1; !0 === this._audioMuted && e.audio && ( t = !0, this._audioMuted = !1, !1 === this._localHold && this._toggleMuteAudio( !1 ) ), !0 === this._videoMuted && e.video && ( n = !0, this._videoMuted = !1, !1 === this._localHold && this._toggleMuteVideo( !1 ) ), !0 !== t && !0 !== n || this._onunmute( { audio: t, video: n } ) } }, { key: "hold", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; if ( I.debug( "hold()" ), this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; if ( !0 === this._localHold ) return !1; if ( !this._isReadyToReOffer() ) return !1; this._localHold = !0, this._onhold( "local" ); var r = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: p.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Hold Failed" } ) } }; return t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "unhold", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; if ( I.debug( "unhold()" ), this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; if ( !1 === this._localHold ) return !1; if ( !this._isReadyToReOffer() ) return !1; this._localHold = !1, this._onunhold( "local" ); var r = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: p.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Unhold Failed" } ) } }; return t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "renegotiate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = arguments.length > 1 ? arguments[1] : void 0; I.debug( "renegotiate()" ); var r = t.rtcOfferConstraints || null; if ( this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; if ( !this._isReadyToReOffer() ) return !1; var i = { succeeded: function () { n && n() }, failed: function () { e.terminate( { cause: p.causes.WEBRTC_ERROR, status_code: 500, reason_phrase: "Media Renegotiation Failed" } ) } }; return this._setLocalMediaStatus(), t.useUpdate ? this._sendUpdate( { sdpOffer: !0, eventHandlers: i, rtcOfferConstraints: r, extraHeaders: t.extraHeaders } ) : this._sendReinvite( { eventHandlers: i, rtcOfferConstraints: r, extraHeaders: t.extraHeaders } ), !0 } }, { key: "refer", value: function ( e, t ) { var n = this; I.debug( "refer()" ); var r = e; if ( this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( r ) ); var i = new w( this ); i.sendRefer( e, t ); var o = i.id; return this._referSubscribers[o] = i, i.on( "requestFailed", ( function () { delete n._referSubscribers[o] } ) ), i.on( "accepted", ( function () { delete n._referSubscribers[o] } ) ), i.on( "failed", ( function () { delete n._referSubscribers[o] } ) ), i } }, { key: "sendRequest", value: function ( e, t ) { return I.debug( "sendRequest()" ), this._dialog.sendRequest( e, t ) } }, { key: "receiveRequest", value: function ( e ) { var t = this; if ( I.debug( "receiveRequest()" ), e.method === p.CANCEL ) this._status !== O.STATUS_WAITING_FOR_ANSWER && this._status !== O.STATUS_ANSWERED || ( this._status = O.STATUS_CANCELED, this._request.reply( 487 ), this._failed( "remote", e, p.causes.CANCELED ) ); else switch ( e.method ) { case p.ACK: if ( this._status !== O.STATUS_WAITING_FOR_ACK ) return; if ( this._status = O.STATUS_CONFIRMED, clearTimeout( this._timers.ackTimer ), clearTimeout( this._timers.invite2xxTimer ), this._late_sdp ) { if ( !e.body ) { this.terminate( { cause: p.causes.MISSING_SDP, status_code: 400 } ); break } var n = { originator: "remote", type: "answer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", n ); var r = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( r ) } ) ).then( ( function () { t._is_confirmed || t._confirmed( "remote", e ) } ) ).catch( ( function ( e ) { t.terminate( { cause: p.causes.BAD_MEDIA_DESCRIPTION, status_code: 488 } ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else this._is_confirmed || this._confirmed( "remote", e ); break; case p.BYE: this._status === O.STATUS_CONFIRMED || this._status === O.STATUS_WAITING_FOR_ACK ? ( e.reply( 200 ), this._ended( "remote", e, p.causes.BYE ) ) : this._status === O.STATUS_INVITE_RECEIVED || this._status === O.STATUS_WAITING_FOR_ANSWER ? ( e.reply( 200 ), this._request.reply( 487, "BYE Received" ), this._ended( "remote", e, p.causes.BYE ) ) : e.reply( 403, "Wrong Status" ); break; case p.INVITE: this._status === O.STATUS_CONFIRMED ? e.hasHeader( "replaces" ) ? this._receiveReplaces( e ) : this._receiveReinvite( e ) : e.reply( 403, "Wrong Status" ); break; case p.INFO: if ( this._status === O.STATUS_1XX_RECEIVED || this._status === O.STATUS_WAITING_FOR_ANSWER || this._status === O.STATUS_ANSWERED || this._status === O.STATUS_WAITING_FOR_ACK || this._status === O.STATUS_CONFIRMED ) { var i = e.hasHeader( "Content-Type" ) ? e.getHeader( "Content-Type" ).toLowerCase() : void 0; i && i.match( /^application\/dtmf-relay/i ) ? new C( this ).init_incoming( e ) : void 0 !== i ? new E( this ).init_incoming( e ) : e.reply( 415 ) } else e.reply( 403, "Wrong Status" ); break; case p.UPDATE: this._status === O.STATUS_CONFIRMED ? this._receiveUpdate( e ) : e.reply( 403, "Wrong Status" ); break; case p.REFER: this._status === O.STATUS_CONFIRMED ? this._receiveRefer( e ) : e.reply( 403, "Wrong Status" ); break; case p.NOTIFY: this._status === O.STATUS_CONFIRMED ? this._receiveNotify( e ) : e.reply( 403, "Wrong Status" ); break; default: e.reply( 501 ) } } }, { key: "onTransportError", value: function () { I.warn( "onTransportError()" ), this._status !== O.STATUS_TERMINATED && this.terminate( { status_code: 500, reason_phrase: p.causes.CONNECTION_ERROR, cause: p.causes.CONNECTION_ERROR } ) } }, { key: "onRequestTimeout", value: function () { I.warn( "onRequestTimeout()" ), this._status !== O.STATUS_TERMINATED && this.terminate( { status_code: 408, reason_phrase: p.causes.REQUEST_TIMEOUT, cause: p.causes.REQUEST_TIMEOUT } ) } }, { key: "onDialogError", value: function () { I.warn( "onDialogError()" ), this._status !== O.STATUS_TERMINATED && this.terminate( { status_code: 500, reason_phrase: p.causes.DIALOG_ERROR, cause: p.causes.DIALOG_ERROR } ) } }, { key: "newDTMF", value: function ( e ) { I.debug( "newDTMF()" ), this.emit( "newDTMF", e ) } }, { key: "newInfo", value: function ( e ) { I.debug( "newInfo()" ), this.emit( "newInfo", e ) } }, { key: "_isReadyToReOffer", value: function () { return this._rtcReady ? this._dialog ? !0 !== this._dialog.uac_pending_reply && !0 !== this._dialog.uas_pending_reply || ( I.debug( "_isReadyToReOffer() | there is another INVITE/UPDATE transaction in progress" ), !1 ) : ( I.debug( "_isReadyToReOffer() | session not established yet" ), !1 ) : ( I.debug( "_isReadyToReOffer() | internal WebRTC status not ready" ), !1 ) } }, { key: "_close", value: function () { if ( I.debug( "close()" ), this._localMediaStream && this._localMediaStreamLocallyGenerated && ( I.debug( "close() | closing local MediaStream" ), g.closeMediaStream( this._localMediaStream ) ), this._status !== O.STATUS_TERMINATED ) { if ( this._status = O.STATUS_TERMINATED, this._connection ) try { this._connection.close() } catch ( e ) { I.warn( "close() | error closing the RTCPeerConnection: %o", e ) } for ( var e in this._timers ) Object.prototype.hasOwnProperty.call( this._timers, e ) && clearTimeout( this._timers[e] ); for ( var t in clearTimeout( this._sessionTimers.timer ), this._dialog && ( this._dialog.terminate(), delete this._dialog ), this._earlyDialogs ) Object.prototype.hasOwnProperty.call( this._earlyDialogs, t ) && ( this._earlyDialogs[t].terminate(), delete this._earlyDialogs[t] ); for ( var n in this._referSubscribers ) Object.prototype.hasOwnProperty.call( this._referSubscribers, n ) && delete this._referSubscribers[n]; this._ua.destroyRTCSession( this ) } } }, { key: "_setInvite2xxTimer", value: function ( e, t ) { var n = y.T1; this._timers.invite2xxTimer = setTimeout( function r () { this._status === O.STATUS_WAITING_FOR_ACK && ( e.reply( 200, null, ["Contact: ".concat( this._contact )], t ), n < y.T2 && ( n *= 2 ) > y.T2 && ( n = y.T2 ), this._timers.invite2xxTimer = setTimeout( r.bind( this ), n ) ) }.bind( this ), n ) } }, { key: "_setACKTimer", value: function () { var e = this; this._timers.ackTimer = setTimeout( ( function () { e._status === O.STATUS_WAITING_FOR_ACK && ( I.debug( "no ACK received, terminating the session" ), clearTimeout( e._timers.invite2xxTimer ), e.sendRequest( p.BYE ), e._ended( "remote", null, p.causes.NO_ACK ) ) } ), y.TIMER_H ) } }, { key: "_createRTCConnection", value: function ( e, t ) { var n = this; this._connection = new RTCPeerConnection( e, t ), this._connection.addEventListener( "iceconnectionstatechange", ( function () { "failed" === n._connection.iceConnectionState && n.terminate( { cause: p.causes.RTP_TIMEOUT, status_code: 408, reason_phrase: p.causes.RTP_TIMEOUT } ) } ) ), I.debug( 'emit "peerconnection"' ), this.emit( "peerconnection", { peerconnection: this._connection } ) } }, { key: "_createLocalDescription", value: function ( e, t ) { var n = this; if ( I.debug( "createLocalDescription()" ), "offer" !== e && "answer" !== e ) throw new Error( 'createLocalDescription() | invalid type "'.concat( e, '"' ) ); var r = this._connection; return this._rtcReady = !1, Promise.resolve().then( ( function () { return "offer" === e ? r.createOffer( t ).catch( ( function ( e ) { return I.warn( 'emit "peerconnection:createofferfailed" [error:%o]', e ), n.emit( "peerconnection:createofferfailed", e ), Promise.reject( e ) } ) ) : r.createAnswer( t ).catch( ( function ( e ) { return I.warn( 'emit "peerconnection:createanswerfailed" [error:%o]', e ), n.emit( "peerconnection:createanswerfailed", e ), Promise.reject( e ) } ) ) } ) ).then( ( function ( e ) { return r.setLocalDescription( e ).catch( ( function ( e ) { return n._rtcReady = !0, I.warn( 'emit "peerconnection:setlocaldescriptionfailed" [error:%o]', e ), n.emit( "peerconnection:setlocaldescriptionfailed", e ), Promise.reject( e ) } ) ) } ) ).then( ( function () { var i = t && t.iceRestart; if ( "complete" === r.iceGatheringState && !i || "gathering" === r.iceGatheringState && n._iceReady ) { n._rtcReady = !0; var o = { originator: "local", type: e, sdp: r.localDescription.sdp }; return I.debug( 'emit "sdp"' ), n.emit( "sdp", o ), Promise.resolve( o.sdp ) } return new Promise( ( function ( t ) { var i, o, u = !1; n._iceReady = !1; var s = function () { r.removeEventListener( "icecandidate", i ), r.removeEventListener( "icegatheringstatechange", o ), u = !0, n._rtcReady = !0, n._iceReady = !0; var s = { originator: "local", type: e, sdp: r.localDescription.sdp }; I.debug( 'emit "sdp"' ), n.emit( "sdp", s ), t( s.sdp ) }; r.addEventListener( "icecandidate", i = function ( e ) { var t = e.candidate; t ? n.emit( "icecandidate", { candidate: t, ready: s } ) : u || s() } ), r.addEventListener( "icegatheringstatechange", o = function () { "complete" !== r.iceGatheringState || u || s() } ) } ) ) } ) ) } }, { key: "_createDialog", value: function ( e, t, n ) { var r = "UAS" === t ? e.to_tag : e.from_tag, i = "UAS" === t ? e.from_tag : e.to_tag, o = e.call_id + r + i, u = this._earlyDialogs[o]; if ( n ) return !!u || ( ( u = new T( this, e, t, T.C.STATUS_EARLY ) ).error ? ( I.debug( u.error ), this._failed( "remote", e, p.causes.INTERNAL_ERROR ), !1 ) : ( this._earlyDialogs[o] = u, !0 ) ); if ( this._from_tag = e.from_tag, this._to_tag = e.to_tag, u ) return u.update( e, t ), this._dialog = u, delete this._earlyDialogs[o], !0; var s = new T( this, e, t ); return s.error ? ( I.debug( s.error ), this._failed( "remote", e, p.causes.INTERNAL_ERROR ), !1 ) : ( this._dialog = s, !0 ) } }, { key: "_receiveReinvite", value: function ( e ) { var t = this; I.debug( "receiveReinvite()" ); var n = e.hasHeader( "Content-Type" ) ? e.getHeader( "Content-Type" ).toLowerCase() : void 0, r = { request: e, callback: void 0, reject: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; i = !0; var n = t.status_code || 403, r = t.reason_phrase || "", o = g.cloneArray( t.extraHeaders ); if ( this._status !== O.STATUS_CONFIRMED ) return !1; if ( n < 300 || n >= 700 ) throw new TypeError( "Invalid status_code: ".concat( n ) ); e.reply( n, r, o ) }.bind( this ) }, i = !1; if ( this.emit( "reinvite", r ), !i ) { if ( this._late_sdp = !1, !e.body ) return this._late_sdp = !0, this._remoteHold && ( this._remoteHold = !1, this._onunhold( "remote" ) ), void ( this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._createLocalDescription( "offer", t._rtcOfferConstraints ) } ) ).then( ( function ( e ) { o.call( t, e ) } ) ).catch( ( function () { e.reply( 500 ) } ) ) ); if ( "application/sdp" !== n ) return I.debug( "invalid Content-Type" ), void e.reply( 415 ); this._processInDialogSdpOffer( e ).then( ( function ( e ) { t._status !== O.STATUS_TERMINATED && o.call( t, e ) } ) ).catch( ( function ( e ) { I.warn( e ) } ) ) } function o ( t ) { var n = this, i = ["Contact: ".concat( this._contact )]; this._handleSessionTimersInIncomingRequest( e, i ), this._late_sdp && ( t = this._mangleOffer( t ) ), e.reply( 200, null, i, t, ( function () { n._status = O.STATUS_WAITING_FOR_ACK, n._setInvite2xxTimer( e, t ), n._setACKTimer() } ) ), "function" == typeof r.callback && r.callback() } } }, { key: "_receiveUpdate", value: function ( e ) { var t = this; I.debug( "receiveUpdate()" ); var n = e.hasHeader( "Content-Type" ) ? e.getHeader( "Content-Type" ).toLowerCase() : void 0, r = { request: e, callback: void 0, reject: function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; i = !0; var n = t.status_code || 403, r = t.reason_phrase || "", o = g.cloneArray( t.extraHeaders ); if ( this._status !== O.STATUS_CONFIRMED ) return !1; if ( n < 300 || n >= 700 ) throw new TypeError( "Invalid status_code: ".concat( n ) ); e.reply( n, r, o ) }.bind( this ) }, i = !1; if ( this.emit( "update", r ), !i ) if ( e.body ) { if ( "application/sdp" !== n ) return I.debug( "invalid Content-Type" ), void e.reply( 415 ); this._processInDialogSdpOffer( e ).then( ( function ( e ) { t._status !== O.STATUS_TERMINATED && o.call( t, e ) } ) ).catch( ( function ( e ) { I.warn( e ) } ) ) } else o.call( this, null ); function o ( t ) { var n = ["Contact: ".concat( this._contact )]; this._handleSessionTimersInIncomingRequest( e, n ), e.reply( 200, null, n, t ), "function" == typeof r.callback && r.callback() } } }, { key: "_processInDialogSdpOffer", value: function ( e ) { var t = this; I.debug( "_processInDialogSdpOffer()" ); var n, r = e.parseSDP(), o = !1, u = i( r.media ); try { for ( u.s(); !( n = u.n() ).done; ) { var s = n.value; if ( -1 !== k.indexOf( s.type ) ) { var l = s.direction || r.direction || "sendrecv"; if ( "sendonly" !== l && "inactive" !== l ) { o = !1; break } o = !0 } } } catch ( e ) { u.e( e ) } finally { u.f() } var a = { originator: "remote", type: "offer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", a ); var c = new RTCSessionDescription( { type: "offer", sdp: a.sdp } ); return this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { if ( t._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); return t._connection.setRemoteDescription( c ).catch( ( function ( n ) { throw e.reply( 488 ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', n ), t.emit( "peerconnection:setremotedescriptionfailed", n ), n } ) ) } ) ).then( ( function () { if ( t._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); !0 === t._remoteHold && !1 === o ? ( t._remoteHold = !1, t._onunhold( "remote" ) ) : !1 === t._remoteHold && !0 === o && ( t._remoteHold = !0, t._onhold( "remote" ) ) } ) ).then( ( function () { if ( t._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); return t._createLocalDescription( "answer", t._rtcAnswerConstraints ).catch( ( function ( t ) { throw e.reply( 500 ), I.warn( 'emit "peerconnection:createtelocaldescriptionfailed" [error:%o]', t ), t } ) ) } ) ).catch( ( function ( e ) { I.warn( "_processInDialogSdpOffer() failed [error: %o]", e ) } ) ), this._connectionPromiseQueue } }, { key: "_receiveRefer", value: function ( e ) { var t = this; if ( I.debug( "receiveRefer()" ), !e.refer_to ) return I.debug( "no Refer-To header field present in REFER" ), void e.reply( 400 ); if ( e.refer_to.uri.scheme !== p.SIP ) return I.debug( "Refer-To header field points to a non-SIP URI scheme" ), void e.reply( 416 ); e.reply( 202 ); var r = new A( this, e.cseq ); function i ( t ) { var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if ( t = "function" == typeof t ? t : null, this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; var o = new n( this._ua ); if ( o.on( "progress", ( function ( e ) { var t = e.response; r.notify( t.status_code, t.reason_phrase ) } ) ), o.on( "accepted", ( function ( e ) { var t = e.response; r.notify( t.status_code, t.reason_phrase ) } ) ), o.on( "_failed", ( function ( e ) { var t = e.message, n = e.cause; t ? r.notify( t.status_code, t.reason_phrase ) : r.notify( 487, n ) } ) ), e.refer_to.uri.hasHeader( "replaces" ) ) { var u = decodeURIComponent( e.refer_to.uri.getHeader( "replaces" ) ); i.extraHeaders = g.cloneArray( i.extraHeaders ), i.extraHeaders.push( "Replaces: ".concat( u ) ) } o.connect( e.refer_to.uri.toAor(), i, t ) } function o () { r.notify( 603 ) } I.debug( 'emit "refer"' ), this.emit( "refer", { request: e, accept: function ( e, n ) { i.call( t, e, n ) }, reject: function () { o.call( t ) } } ) } }, { key: "_receiveNotify", value: function ( e ) { switch ( I.debug( "receiveNotify()" ), e.event || e.reply( 400 ), e.event.event ) { case "refer": var t, n; if ( e.event.params && e.event.params.id ) t = e.event.params.id, n = this._referSubscribers[t]; else { if ( 1 !== Object.keys( this._referSubscribers ).length ) return void e.reply( 400, "Missing event id parameter" ); n = this._referSubscribers[Object.keys( this._referSubscribers )[0]] } if ( !n ) return void e.reply( 481, "Subscription does not exist" ); n.receiveNotify( e ), e.reply( 200 ); break; default: e.reply( 489 ) } } }, { key: "_receiveReplaces", value: function ( e ) { var t = this; function r ( t ) { var r = this; if ( this._status !== O.STATUS_WAITING_FOR_ACK && this._status !== O.STATUS_CONFIRMED ) return !1; var i = new n( this._ua ); i.on( "confirmed", ( function () { r.terminate() } ) ), i.init_incoming( e, t ) } function i () { I.debug( "Replaced INVITE rejected by the user" ), e.reply( 486 ) } I.debug( "receiveReplaces()" ), this.emit( "replaces", { request: e, accept: function ( e ) { r.call( t, e ) }, reject: function () { i.call( t ) } } ) } }, { key: "_sendInitialRequest", value: function ( e, t, n ) { var r = this, i = new S( this._ua, this._request, { onRequestTimeout: function () { r.onRequestTimeout() }, onTransportError: function () { r.onTransportError() }, onAuthenticated: function ( e ) { r._request = e }, onReceiveResponse: function ( e ) { r._receiveInviteResponse( e ) } } ); Promise.resolve().then( ( function () { return n || ( e.audio || e.video ? ( r._localMediaStreamLocallyGenerated = !0, navigator.mediaDevices.getUserMedia( e ).catch( ( function ( e ) { if ( r._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); throw r._failed( "local", null, p.causes.USER_DENIED_MEDIA_ACCESS ), I.warn( 'emit "getusermediafailed" [error:%o]', e ), r.emit( "getusermediafailed", e ), e } ) ) ) : void 0 ) } ) ).then( ( function ( e ) { if ( r._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); return r._localMediaStream = e, e && e.getTracks().forEach( ( function ( t ) { r._connection.addTrack( t, e ) } ) ), r._connecting( r._request ), r._createLocalDescription( "offer", t ).catch( ( function ( e ) { throw r._failed( "local", null, p.causes.WEBRTC_ERROR ), e } ) ) } ) ).then( ( function ( e ) { if ( r._is_canceled || r._status === O.STATUS_TERMINATED ) throw new Error( "terminated" ); r._request.body = e, r._status = O.STATUS_INVITE_SENT, I.debug( 'emit "sending" [request:%o]', r._request ), r.emit( "sending", { request: r._request } ), i.send() } ) ).catch( ( function ( e ) { r._status !== O.STATUS_TERMINATED && I.warn( e ) } ) ) } }, { key: "_getDTMFRTPSender", value: function () { var e = this._connection.getSenders().find( ( function ( e ) { return e.track && "audio" === e.track.kind } ) ); if ( e && e.dtmf ) return e.dtmf; I.warn( "sendDTMF() | no local audio track to send DTMF with" ) } }, { key: "_receiveInviteResponse", value: function ( e ) { var t = this; if ( I.debug( "receiveInviteResponse()" ), this._dialog && e.status_code >= 200 && e.status_code <= 299 ) { if ( this._dialog.id.call_id === e.call_id && this._dialog.id.local_tag === e.from_tag && this._dialog.id.remote_tag === e.to_tag ) return void this.sendRequest( p.ACK ); var n = new T( this, e, "UAC" ); return void 0 !== n.error ? void I.debug( n.error ) : ( this.sendRequest( p.ACK ), void this.sendRequest( p.BYE ) ) } if ( this._is_canceled ) e.status_code >= 100 && e.status_code < 200 ? this._request.cancel( this._cancel_reason ) : e.status_code >= 200 && e.status_code < 299 && this._acceptAndTerminate( e ); else if ( this._status === O.STATUS_INVITE_SENT || this._status === O.STATUS_1XX_RECEIVED ) switch ( !0 ) { case /^100$/.test( e.status_code ): this._status = O.STATUS_1XX_RECEIVED; break; case /^1[0-9]{2}$/.test( e.status_code ): if ( !e.to_tag ) { I.debug( "1xx response received without to tag" ); break } if ( e.hasHeader( "contact" ) && !this._createDialog( e, "UAC", !0 ) ) break; if ( this._status = O.STATUS_1XX_RECEIVED, !e.body ) { this._progress( "remote", e ); break } var r = { originator: "remote", type: "answer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", r ); var i = new RTCSessionDescription( { type: "answer", sdp: r.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).then( ( function () { return t._progress( "remote", e ) } ) ).catch( ( function ( e ) { I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ); break; case /^2[0-9]{2}$/.test( e.status_code ): if ( this._status = O.STATUS_CONFIRMED, !e.body ) { this._acceptAndTerminate( e, 400, p.causes.MISSING_SDP ), this._failed( "remote", e, p.causes.BAD_MEDIA_DESCRIPTION ); break } if ( !this._createDialog( e, "UAC" ) ) break; var o = { originator: "remote", type: "answer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", o ); var u = new RTCSessionDescription( { type: "answer", sdp: o.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { if ( "stable" === t._connection.signalingState ) return t._connection.createOffer( t._rtcOfferConstraints ).then( ( function ( e ) { return t._connection.setLocalDescription( e ) } ) ).catch( ( function ( n ) { t._acceptAndTerminate( e, 500, n.toString() ), t._failed( "local", e, p.causes.WEBRTC_ERROR ) } ) ) } ) ).then( ( function () { t._connection.setRemoteDescription( u ).then( ( function () { t._handleSessionTimersInIncomingResponse( e ), t._accepted( "remote", e ), t.sendRequest( p.ACK ), t._confirmed( "local", null ) } ) ).catch( ( function ( n ) { t._acceptAndTerminate( e, 488, "Not Acceptable Here" ), t._failed( "remote", e, p.causes.BAD_MEDIA_DESCRIPTION ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', n ), t.emit( "peerconnection:setremotedescriptionfailed", n ) } ) ) } ) ); break; default: var s = g.sipErrorCause( e.status_code ); this._failed( "remote", e, s ) } } }, { key: "_sendReinvite", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; I.debug( "sendReinvite()" ); var n = g.cloneArray( t.extraHeaders ), r = g.cloneObject( t.eventHandlers ), i = t.rtcOfferConstraints || this._rtcOfferConstraints || null, o = !1; function u ( e ) { var t = this; if ( this._status !== O.STATUS_TERMINATED && ( this.sendRequest( p.ACK ), !o ) ) if ( this._handleSessionTimersInIncomingResponse( e ), e.body ) if ( e.hasHeader( "Content-Type" ) && "application/sdp" === e.getHeader( "Content-Type" ).toLowerCase() ) { var n = { originator: "remote", type: "answer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", n ); var i = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).then( ( function () { r.succeeded && r.succeeded( e ) } ) ).catch( ( function ( e ) { s.call( t ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else s.call( this ); else s.call( this ) } function s ( e ) { r.failed && r.failed( e ) } n.push( "Contact: ".concat( this._contact ) ), n.push( "Content-Type: application/sdp" ), this._sessionTimers.running && n.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( this._sessionTimers.refresher ? "uac" : "uas" ) ), this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return e._createLocalDescription( "offer", i ) } ) ).then( ( function ( t ) { var r = { originator: "local", type: "offer", sdp: t = e._mangleOffer( t ) }; I.debug( 'emit "sdp"' ), e.emit( "sdp", r ), e.sendRequest( p.INVITE, { extraHeaders: n, body: t, eventHandlers: { onSuccessResponse: function ( t ) { u.call( e, t ), o = !0 }, onErrorResponse: function ( t ) { s.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } ) ).catch( ( function () { s() } ) ) } }, { key: "_sendUpdate", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; I.debug( "sendUpdate()" ); var n = g.cloneArray( t.extraHeaders ), r = g.cloneObject( t.eventHandlers ), i = t.rtcOfferConstraints || this._rtcOfferConstraints || null, o = t.sdpOffer || !1, u = !1; function s ( e ) { var t = this; if ( this._status !== O.STATUS_TERMINATED && !u ) if ( this._handleSessionTimersInIncomingResponse( e ), o ) { if ( !e.body ) return void l.call( this ); if ( !e.hasHeader( "Content-Type" ) || "application/sdp" !== e.getHeader( "Content-Type" ).toLowerCase() ) return void l.call( this ); var n = { originator: "remote", type: "answer", sdp: e.body }; I.debug( 'emit "sdp"' ), this.emit( "sdp", n ); var i = new RTCSessionDescription( { type: "answer", sdp: n.sdp } ); this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return t._connection.setRemoteDescription( i ) } ) ).then( ( function () { r.succeeded && r.succeeded( e ) } ) ).catch( ( function ( e ) { l.call( t ), I.warn( 'emit "peerconnection:setremotedescriptionfailed" [error:%o]', e ), t.emit( "peerconnection:setremotedescriptionfailed", e ) } ) ) } else r.succeeded && r.succeeded( e ) } function l ( e ) { r.failed && r.failed( e ) } n.push( "Contact: ".concat( this._contact ) ), this._sessionTimers.running && n.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( this._sessionTimers.refresher ? "uac" : "uas" ) ), o ? ( n.push( "Content-Type: application/sdp" ), this._connectionPromiseQueue = this._connectionPromiseQueue.then( ( function () { return e._createLocalDescription( "offer", i ) } ) ).then( ( function ( t ) { var r = { originator: "local", type: "offer", sdp: t = e._mangleOffer( t ) }; I.debug( 'emit "sdp"' ), e.emit( "sdp", r ), e.sendRequest( p.UPDATE, { extraHeaders: n, body: t, eventHandlers: { onSuccessResponse: function ( t ) { s.call( e, t ), u = !0 }, onErrorResponse: function ( t ) { l.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } ) ).catch( ( function () { l.call( e ) } ) ) ) : this.sendRequest( p.UPDATE, { extraHeaders: n, eventHandlers: { onSuccessResponse: function ( t ) { s.call( e, t ) }, onErrorResponse: function ( t ) { l.call( e, t ) }, onTransportError: function () { e.onTransportError() }, onRequestTimeout: function () { e.onRequestTimeout() }, onDialogError: function () { e.onDialogError() } } } ) } }, { key: "_acceptAndTerminate", value: function ( e, t, n ) { I.debug( "acceptAndTerminate()" ); var r = []; t && ( n = n || p.REASON_PHRASE[t] || "", r.push( "Reason: SIP ;cause=".concat( t, '; text="' ).concat( n, '"' ) ) ), ( this._dialog || this._createDialog( e, "UAC" ) ) && ( this.sendRequest( p.ACK ), this.sendRequest( p.BYE, { extraHeaders: r } ) ), this._status = O.STATUS_TERMINATED } }, { key: "_mangleOffer", value: function ( e ) { if ( !this._localHold && !this._remoteHold ) return e; if ( e = d.parse( e ), this._localHold && !this._remoteHold ) { I.debug( "mangleOffer() | me on hold, mangling offer" ); var t, n = i( e.media ); try { for ( n.s(); !( t = n.n() ).done; ) { var r = t.value; -1 !== k.indexOf( r.type ) && ( r.direction ? "sendrecv" === r.direction ? r.direction = "sendonly" : "recvonly" === r.direction && ( r.direction = "inactive" ) : r.direction = "sendonly" ) } } catch ( e ) { n.e( e ) } finally { n.f() } } else if ( this._localHold && this._remoteHold ) { I.debug( "mangleOffer() | both on hold, mangling offer" ); var o, u = i( e.media ); try { for ( u.s(); !( o = u.n() ).done; ) { var s = o.value; -1 !== k.indexOf( s.type ) && ( s.direction = "inactive" ) } } catch ( e ) { u.e( e ) } finally { u.f() } } else if ( this._remoteHold ) { I.debug( "mangleOffer() | remote on hold, mangling offer" ); var l, a = i( e.media ); try { for ( a.s(); !( l = a.n() ).done; ) { var c = l.value; -1 !== k.indexOf( c.type ) && ( c.direction ? "sendrecv" === c.direction ? c.direction = "recvonly" : "recvonly" === c.direction && ( c.direction = "inactive" ) : c.direction = "recvonly" ) } } catch ( e ) { a.e( e ) } finally { a.f() } } return d.write( e ) } }, { key: "_setLocalMediaStatus", value: function () { var e = !0, t = !0; ( this._localHold || this._remoteHold ) && ( e = !1, t = !1 ), this._audioMuted && ( e = !1 ), this._videoMuted && ( t = !1 ), this._toggleMuteAudio( !e ), this._toggleMuteVideo( !t ) } }, { key: "_handleSessionTimersInIncomingRequest", value: function ( e, t ) { var n; this._sessionTimers.enabled && ( e.session_expires && e.session_expires >= p.MIN_SESSION_EXPIRES ? ( this._sessionTimers.currentExpires = e.session_expires, n = e.session_expires_refresher || "uas" ) : ( this._sessionTimers.currentExpires = this._sessionTimers.defaultExpires, n = "uas" ), t.push( "Session-Expires: ".concat( this._sessionTimers.currentExpires, ";refresher=" ).concat( n ) ), this._sessionTimers.refresher = "uas" === n, this._runSessionTimer() ) } }, { key: "_handleSessionTimersInIncomingResponse", value: function ( e ) { var t; this._sessionTimers.enabled && ( e.session_expires && e.session_expires >= p.MIN_SESSION_EXPIRES ? ( this._sessionTimers.currentExpires = e.session_expires, t = e.session_expires_refresher || "uac" ) : ( this._sessionTimers.currentExpires = this._sessionTimers.defaultExpires, t = "uac" ), this._sessionTimers.refresher = "uac" === t, this._runSessionTimer() ) } }, { key: "_runSessionTimer", value: function () { var e = this, t = this._sessionTimers.currentExpires; this._sessionTimers.running = !0, clearTimeout( this._sessionTimers.timer ), this._sessionTimers.refresher ? this._sessionTimers.timer = setTimeout( ( function () { e._status !== O.STATUS_TERMINATED && e._isReadyToReOffer() && ( I.debug( "runSessionTimer() | sending session refresh request" ), e._sessionTimers.refreshMethod === p.UPDATE ? e._sendUpdate() : e._sendReinvite() ) } ), 500 * t ) : this._sessionTimers.timer = setTimeout( ( function () { e._status !== O.STATUS_TERMINATED && ( I.warn( "runSessionTimer() | timer expired, terminating the session" ), e.terminate( { cause: p.causes.REQUEST_TIMEOUT, status_code: 408, reason_phrase: "Session Timer Expired" } ) ) } ), 1100 * t ) } }, { key: "_toggleMuteAudio", value: function ( e ) { var t, n = i( this._connection.getSenders().filter( ( function ( e ) { return e.track && "audio" === e.track.kind } ) ) ); try { for ( n.s(); !( t = n.n() ).done; ) { t.value.track.enabled = !e } } catch ( e ) { n.e( e ) } finally { n.f() } } }, { key: "_toggleMuteVideo", value: function ( e ) { var t, n = i( this._connection.getSenders().filter( ( function ( e ) { return e.track && "video" === e.track.kind } ) ) ); try { for ( n.s(); !( t = n.n() ).done; ) { t.value.track.enabled = !e } } catch ( e ) { n.e( e ) } finally { n.f() } } }, { key: "_newRTCSession", value: function ( e, t ) { I.debug( "newRTCSession()" ), this._ua.newRTCSession( this, { originator: e, session: this, request: t } ) } }, { key: "_connecting", value: function ( e ) { I.debug( "session connecting" ), I.debug( 'emit "connecting"' ), this.emit( "connecting", { request: e } ) } }, { key: "_progress", value: function ( e, t ) { I.debug( "session progress" ), I.debug( 'emit "progress"' ), this.emit( "progress", { originator: e, response: t || null } ) } }, { key: "_accepted", value: function ( e, t ) { I.debug( "session accepted" ), this._start_time = new Date, I.debug( 'emit "accepted"' ), this.emit( "accepted", { originator: e, response: t || null } ) } }, { key: "_confirmed", value: function ( e, t ) { I.debug( "session confirmed" ), this._is_confirmed = !0, I.debug( 'emit "confirmed"' ), this.emit( "confirmed", { originator: e, ack: t || null } ) } }, { key: "_ended", value: function ( e, t, n ) { I.debug( "session ended" ), this._end_time = new Date, this._close(), I.debug( 'emit "ended"' ), this.emit( "ended", { originator: e, message: t || null, cause: n } ) } }, { key: "_failed", value: function ( e, t, n ) { I.debug( "session failed" ), I.debug( 'emit "_failed"' ), this.emit( "_failed", { originator: e, message: t || null, cause: n } ), this._close(), I.debug( 'emit "failed"' ), this.emit( "failed", { originator: e, message: t || null, cause: n } ) } }, { key: "_onhold", value: function ( e ) { I.debug( "session onhold" ), this._setLocalMediaStatus(), I.debug( 'emit "hold"' ), this.emit( "hold", { originator: e } ) } }, { key: "_onunhold", value: function ( e ) { I.debug( "session onunhold" ), this._setLocalMediaStatus(), I.debug( 'emit "unhold"' ), this.emit( "unhold", { originator: e } ) } }, { key: "_onmute", value: function ( e ) { var t = e.audio, n = e.video; I.debug( "session onmute" ), this._setLocalMediaStatus(), I.debug( 'emit "muted"' ), this.emit( "muted", { audio: t, video: n } ) } }, { key: "_onunmute", value: function ( e ) { var t = e.audio, n = e.video; I.debug( "session onunmute" ), this._setLocalMediaStatus(), I.debug( 'emit "unmuted"' ), this.emit( "unmuted", { audio: t, video: n } ) } }, { key: "C", get: function () { return O } }, { key: "causes", get: function () { return p.causes } }, { key: "id", get: function () { return this._id } }, { key: "connection", get: function () { return this._connection } }, { key: "contact", get: function () { return this._contact } }, { key: "direction", get: function () { return this._direction } }, { key: "local_identity", get: function () { return this._local_identity } }, { key: "remote_identity", get: function () { return this._remote_identity } }, { key: "start_time", get: function () { return this._start_time } }, { key: "end_time", get: function () { return this._end_time } }, { key: "data", get: function () { return this._data }, set: function ( e ) { this._data = e } }, { key: "status", get: function () { return this._status } }] ), n }( h ) }, function ( e, t, n ) { "use strict"; var r = n( 2 ), i = n( 3 ), o = n( 6 ), u = new r( "Socket" ); t.isSocket = function ( e ) { if ( Array.isArray( e ) ) return !1; if ( void 0 === e ) return u.warn( "undefined JsSIP.Socket instance" ), !1; try { if ( !i.isString( e.url ) ) throw u.warn( "missing or invalid JsSIP.Socket url property" ), new Error( "Missing or invalid JsSIP.Socket url property" ); if ( !i.isString( e.via_transport ) ) throw u.warn( "missing or invalid JsSIP.Socket via_transport property" ), new Error( "Missing or invalid JsSIP.Socket via_transport property" ); if ( -1 === o.parse( e.sip_uri, "SIP_URI" ) ) throw u.warn( "missing or invalid JsSIP.Socket sip_uri property" ), new Error( "missing or invalid JsSIP.Socket sip_uri property" ) } catch ( e ) { return !1 } try { ["connect", "disconnect", "send"].forEach( ( function ( t ) { if ( !i.isFunction( e[t] ) ) throw u.warn( "missing or invalid JsSIP.Socket method: ".concat( t ) ), new Error( "Missing or invalid JsSIP.Socket method: ".concat( t ) ) } ) ) } catch ( e ) { return !1 } return !0 } }, function ( e, t, n ) { "use strict"; ( function ( e ) { var r = n( 4 ), i = n( 26 ), o = "object" == typeof exports && exports && !exports.nodeType && exports, u = o && "object" == typeof e && e && !e.nodeType && e, s = u && u.exports === o ? r.a.Buffer : void 0, l = ( s ? s.isBuffer : void 0 ) || i.a; t.a = l } ).call( this, n( 18 )( e ) ) }, function ( e, t, n ) { "use strict"; t.a = function () { return !1 } }, function ( e, t, n ) { const r = n( 51 ).default; e.exports = r }, function ( e, t ) { e.exports = function ( e ) { return e.webpackPolyfill || ( e.deprecate = function () { }, e.paths = [], e.children || ( e.children = [] ), Object.defineProperty( e, "loaded", { enumerable: !0, get: function () { return e.l } } ), Object.defineProperty( e, "id", { enumerable: !0, get: function () { return e.i } } ), e.webpackPolyfill = 1 ), e } }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t, n ) { return t && i( e.prototype, t ), n && i( e, n ), e } function u ( e, t ) { return ( u = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function s ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = c( e ); if ( t ) { var i = c( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return l( this, n ) } } function l ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? a( e ) : t } function a ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e } function c ( e ) { return ( c = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var f = n( 5 ).EventEmitter, h = n( 2 ), d = n( 1 ), _ = n( 33 ), p = n( 23 ), v = n( 43 ), m = n( 44 ), g = n( 12 ), y = n( 45 ), b = n( 3 ), T = n( 8 ), S = n( 9 ), C = n( 46 ), E = n( 7 ), A = n( 47 ), w = n( 48 ), R = new h( "UA" ), I = { STATUS_INIT: 0, STATUS_READY: 1, STATUS_USER_CLOSED: 2, STATUS_NOT_READY: 3, CONFIGURATION_ERROR: 1, NETWORK_ERROR: 2 }; function O ( e ) { this.emit( "connecting", e ) } function k ( e ) { this._status !== I.STATUS_USER_CLOSED && ( this._status = I.STATUS_READY, this._error = null, this.emit( "connected", e ), this._dynConfiguration.register && this._registrator.register() ) } function N ( e ) { for ( var t = 0, n = ["nict", "ict", "nist", "ist"]; t < n.length; t++ ) { var r = n[t]; for ( var i in this._transactions[r] ) Object.prototype.hasOwnProperty.call( this._transactions[r], i ) && this._transactions[r][i].onTransportError() } this.emit( "disconnected", e ), this._registrator.onTransportClosed(), this._status !== I.STATUS_USER_CLOSED && ( this._status = I.STATUS_NOT_READY, this._error = I.NETWORK_ERROR ) } function x ( e ) { var t = e.transport, n = e.message; if ( ( n = C.parseMessage( n, this ) ) && !( this._status === I.STATUS_USER_CLOSED && n instanceof E.IncomingRequest ) && A( n, this, t ) ) if ( n instanceof E.IncomingRequest ) n.transport = t, this.receiveRequest( n ); else if ( n instanceof E.IncomingResponse ) { var r; switch ( n.method ) { case d.INVITE: ( r = this._transactions.ict[n.via_branch] ) && r.receiveResponse( n ); break; case d.ACK: break; default: ( r = this._transactions.nict[n.via_branch] ) && r.receiveResponse( n ) } } } e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && u( e, t ) }( n, e ); var t = s( n ); function n ( e ) { var r; if ( function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, n ), R.debug( "new() [configuration:%o]", e ), ( r = t.call( this ) )._cache = { credentials: {} }, r._configuration = Object.assign( {}, w.settings ), r._dynConfiguration = {}, r._dialogs = {}, r._applicants = {}, r._sessions = {}, r._transport = null, r._contact = null, r._status = I.STATUS_INIT, r._error = null, r._transactions = { nist: {}, nict: {}, ist: {}, ict: {} }, r._data = {}, r._closeTimer = null, void 0 === e ) throw new TypeError( "Not enough arguments" ); try { r._loadConfig( e ) } catch ( e ) { throw r._status = I.STATUS_NOT_READY, r._error = I.CONFIGURATION_ERROR, e } return r._registrator = new _( a( r ) ), r } return o( n, null, [{ key: "C", get: function () { return I } }] ), o( n, [{ key: "start", value: function () { R.debug( "start()" ), this._status === I.STATUS_INIT ? this._transport.connect() : this._status === I.STATUS_USER_CLOSED ? ( R.debug( "restarting UA" ), null !== this._closeTimer && ( clearTimeout( this._closeTimer ), this._closeTimer = null, this._transport.disconnect() ), this._status = I.STATUS_INIT, this._transport.connect() ) : this._status === I.STATUS_READY ? R.debug( "UA is in READY status, not restarted" ) : R.debug( "ERROR: connection is down, Auto-Recovery system is trying to reconnect" ), this._dynConfiguration.register = this._configuration.register } }, { key: "register", value: function () { R.debug( "register()" ), this._dynConfiguration.register = !0, this._registrator.register() } }, { key: "unregister", value: function ( e ) { R.debug( "unregister()" ), this._dynConfiguration.register = !1, this._registrator.unregister( e ) } }, { key: "registrator", value: function () { return this._registrator } }, { key: "isRegistered", value: function () { return this._registrator.registered } }, { key: "isConnected", value: function () { return this._transport.isConnected() } }, { key: "call", value: function ( e, t ) { R.debug( "call()" ); var n = new p( this ); return n.connect( e, t ), n } }, { key: "sendMessage", value: function ( e, t, n ) { R.debug( "sendMessage()" ); var r = new v( this ); return r.send( e, t, n ), r } }, { key: "sendOptions", value: function ( e, t, n ) { R.debug( "sendOptions()" ); var r = new m( this ); return r.send( e, t, n ), r } }, { key: "terminateSessions", value: function ( e ) { for ( var t in R.debug( "terminateSessions()" ), this._sessions ) this._sessions[t].isEnded() || this._sessions[t].terminate( e ) } }, { key: "stop", value: function () { var e = this; if ( R.debug( "stop()" ), this._dynConfiguration = {}, this._status !== I.STATUS_USER_CLOSED ) { this._registrator.close(); var t = Object.keys( this._sessions ).length; for ( var n in this._sessions ) if ( Object.prototype.hasOwnProperty.call( this._sessions, n ) ) { R.debug( "closing session ".concat( n ) ); try { this._sessions[n].terminate() } catch ( e ) { } } for ( var r in this._applicants ) if ( Object.prototype.hasOwnProperty.call( this._applicants, r ) ) try { this._applicants[r].close() } catch ( e ) { } this._status = I.STATUS_USER_CLOSED, 0 === Object.keys( this._transactions.nict ).length + Object.keys( this._transactions.nist ).length + Object.keys( this._transactions.ict ).length + Object.keys( this._transactions.ist ).length && 0 === t ? this._transport.disconnect() : this._closeTimer = setTimeout( ( function () { e._closeTimer = null, e._transport.disconnect() } ), 2e3 ) } else R.debug( "UA already closed" ) } }, { key: "normalizeTarget", value: function ( e ) { return b.normalizeTarget( e, this._configuration.hostport_params ) } }, { key: "get", value: function ( e ) { switch ( e ) { case "authorization_user": return this._configuration.authorization_user; case "realm": return this._configuration.realm; case "ha1": return this._configuration.ha1; case "authorization_jwt": return this._configuration.authorization_jwt; default: return void R.warn( 'get() | cannot get "%s" parameter in runtime', e ) } } }, { key: "set", value: function ( e, t ) { switch ( e ) { case "authorization_user": this._configuration.authorization_user = String( t ); break; case "password": this._configuration.password = String( t ); break; case "realm": this._configuration.realm = String( t ); break; case "ha1": this._configuration.ha1 = String( t ), this._configuration.password = null; break; case "authorization_jwt": this._configuration.authorization_jwt = String( t ); break; case "display_name": this._configuration.display_name = t; break; default: return R.warn( 'set() | cannot set "%s" parameter in runtime', e ), !1 }return !0 } }, { key: "newTransaction", value: function ( e ) { this._transactions[e.type][e.id] = e, this.emit( "newTransaction", { transaction: e } ) } }, { key: "destroyTransaction", value: function ( e ) { delete this._transactions[e.type][e.id], this.emit( "transactionDestroyed", { transaction: e } ) } }, { key: "newDialog", value: function ( e ) { this._dialogs[e.id] = e } }, { key: "destroyDialog", value: function ( e ) { delete this._dialogs[e.id] } }, { key: "newMessage", value: function ( e, t ) { this._applicants[e] = e, this.emit( "newMessage", t ) } }, { key: "newOptions", value: function ( e, t ) { this._applicants[e] = e, this.emit( "newOptions", t ) } }, { key: "destroyMessage", value: function ( e ) { delete this._applicants[e] } }, { key: "newRTCSession", value: function ( e, t ) { this._sessions[e.id] = e, this.emit( "newRTCSession", t ) } }, { key: "destroyRTCSession", value: function ( e ) { delete this._sessions[e.id] } }, { key: "registered", value: function ( e ) { this.emit( "registered", e ) } }, { key: "unregistered", value: function ( e ) { this.emit( "unregistered", e ) } }, { key: "registrationFailed", value: function ( e ) { this.emit( "registrationFailed", e ) } }, { key: "receiveRequest", value: function ( e ) { var t = e.method; if ( e.ruri.user !== this._configuration.uri.user && e.ruri.user !== this._contact.uri.user ) return R.debug( "Request-URI does not point to us" ), void ( e.method !== d.ACK && e.reply_sl( 404 ) ); if ( e.ruri.scheme !== d.SIPS ) { if ( !g.checkTransaction( this, e ) ) { if ( t === d.INVITE ? new g.InviteServerTransaction( this, this._transport, e ) : t !== d.ACK && t !== d.CANCEL && new g.NonInviteServerTransaction( this, this._transport, e ), t === d.OPTIONS ) { if ( 0 === this.listeners( "newOptions" ).length ) return void e.reply( 200 ); new m( this ).init_incoming( e ) } else if ( t === d.MESSAGE ) { if ( 0 === this.listeners( "newMessage" ).length ) return void e.reply( 405 ); new v( this ).init_incoming( e ) } else if ( t === d.INVITE && !e.to_tag && 0 === this.listeners( "newRTCSession" ).length ) return void e.reply( 405 ); var n, r; if ( e.to_tag ) ( n = this._findDialog( e.call_id, e.from_tag, e.to_tag ) ) ? n.receiveRequest( e ) : t === d.NOTIFY ? ( r = this._findSession( e ) ) ? r.receiveRequest( e ) : ( R.debug( "received NOTIFY request for a non existent subscription" ), e.reply( 481, "Subscription does not exist" ) ) : t !== d.ACK && e.reply( 481 ); else switch ( t ) { case d.INVITE: if ( window.RTCPeerConnection ) if ( e.hasHeader( "replaces" ) ) { var i = e.replaces; ( n = this._findDialog( i.call_id, i.from_tag, i.to_tag ) ) ? ( r = n.owner ).isEnded() ? e.reply( 603 ) : r.receiveRequest( e ) : e.reply( 481 ) } else ( r = new p( this ) ).init_incoming( e ); else R.warn( "INVITE received but WebRTC is not supported" ), e.reply( 488 ); break; case d.BYE: e.reply( 481 ); break; case d.CANCEL: ( r = this._findSession( e ) ) ? r.receiveRequest( e ) : R.debug( "received CANCEL request for a non existent session" ); break; case d.ACK: break; case d.NOTIFY: this.emit( "sipEvent", { event: e.event, request: e } ), e.reply( 200 ); break; default: e.reply( 405 ) } } } else e.reply_sl( 416 ) } }, { key: "_findSession", value: function ( e ) { var t = e.call_id, n = e.from_tag, r = e.to_tag, i = t + n, o = this._sessions[i], u = t + r, s = this._sessions[u]; return o || ( s || null ) } }, { key: "_findDialog", value: function ( e, t, n ) { var r = e + t + n, i = this._dialogs[r]; return i || ( r = e + n + t, ( i = this._dialogs[r] ) || null ) } }, { key: "_loadConfig", value: function ( e ) { try { w.load( this._configuration, e ) } catch ( e ) { throw e } 0 === this._configuration.display_name && ( this._configuration.display_name = "0" ), this._configuration.instance_id || ( this._configuration.instance_id = b.newUUID() ), this._configuration.jssip_id = b.createRandomToken( 5 ); var t = this._configuration.uri.clone(); t.user = null, this._configuration.hostport_params = t.toString().replace( /^sip:/i, "" ); try { this._transport = new y( this._configuration.sockets, { max_interval: this._configuration.connection_recovery_max_interval, min_interval: this._configuration.connection_recovery_min_interval } ), this._transport.onconnecting = O.bind( this ), this._transport.onconnect = k.bind( this ), this._transport.ondisconnect = N.bind( this ), this._transport.ondata = x.bind( this ) } catch ( e ) { throw R.warn( e ), new T.ConfigurationError( "sockets", this._configuration.sockets ) } if ( delete this._configuration.sockets, this._configuration.authorization_user || ( this._configuration.authorization_user = this._configuration.uri.user ), !this._configuration.registrar_server ) { var n = this._configuration.uri.clone(); n.user = null, n.clearParams(), n.clearHeaders(), this._configuration.registrar_server = n } this._configuration.no_answer_timeout *= 1e3, this._configuration.contact_uri ? this._configuration.via_host = this._configuration.contact_uri.host : this._configuration.contact_uri = new S( "sip", b.createRandomToken( 8 ), this._configuration.via_host, null, { transport: "ws" } ), this._contact = { pub_gruu: null, temp_gruu: null, uri: this._configuration.contact_uri, toString: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.anonymous || null, n = e.outbound || null, r = "<"; return r += t ? this.temp_gruu || "sip:anonymous@anonymous.invalid;transport=ws" : this.pub_gruu || this.uri.toString(), !n || ( t ? this.temp_gruu : this.pub_gruu ) || ( r += ";ob" ), r += ">" } }; var r = ["authorization_user", "password", "realm", "ha1", "authorization_jwt", "display_name", "register"]; for ( var i in this._configuration ) Object.prototype.hasOwnProperty.call( this._configuration, i ) && ( -1 !== r.indexOf( i ) ? Object.defineProperty( this._configuration, i, { writable: !0, configurable: !1 } ) : Object.defineProperty( this._configuration, i, { writable: !1, configurable: !1 } ) ); for ( var o in R.debug( "configuration parameters after validation:" ), this._configuration ) if ( Object.prototype.hasOwnProperty.call( w.settings, o ) ) switch ( o ) { case "uri": case "registrar_server": R.debug( "- ".concat( o, ": " ).concat( this._configuration[o] ) ); break; case "password": case "ha1": case "authorization_jwt": R.debug( "- ".concat( o, ": NOT SHOWN" ) ); break; default: R.debug( "- ".concat( o, ": " ).concat( JSON.stringify( this._configuration[o] ) ) ) } } }, { key: "C", get: function () { return I } }, { key: "status", get: function () { return this._status } }, { key: "contact", get: function () { return this._contact } }, { key: "configuration", get: function () { return this._configuration } }, { key: "transport", get: function () { return this._transport } }] ), n }( f ) }, function ( e, t ) { var n, r, i = e.exports = {}; function o () { throw new Error( "setTimeout has not been defined" ) } function u () { throw new Error( "clearTimeout has not been defined" ) } function s ( e ) { if ( n === setTimeout ) return setTimeout( e, 0 ); if ( ( n === o || !n ) && setTimeout ) return n = setTimeout, setTimeout( e, 0 ); try { return n( e, 0 ) } catch ( t ) { try { return n.call( null, e, 0 ) } catch ( t ) { return n.call( this, e, 0 ) } } } !function () { try { n = "function" == typeof setTimeout ? setTimeout : o } catch ( e ) { n = o } try { r = "function" == typeof clearTimeout ? clearTimeout : u } catch ( e ) { r = u } }(); var l, a = [], c = !1, f = -1; function h () { c && l && ( c = !1, l.length ? a = l.concat( a ) : f = -1, a.length && d() ) } function d () { if ( !c ) { var e = s( h ); c = !0; for ( var t = a.length; t; ) { for ( l = a, a = []; ++f < t; )l && l[f].run(); f = -1, t = a.length } l = null, c = !1, function ( e ) { if ( r === clearTimeout ) return clearTimeout( e ); if ( ( r === u || !r ) && clearTimeout ) return r = clearTimeout, clearTimeout( e ); try { r( e ) } catch ( t ) { try { return r.call( null, e ) } catch ( t ) { return r.call( this, e ) } } }( e ) } } function _ ( e, t ) { this.fun = e, this.array = t } function p () { } i.nextTick = function ( e ) { var t = new Array( arguments.length - 1 ); if ( arguments.length > 1 ) for ( var n = 1; n < arguments.length; n++ )t[n - 1] = arguments[n]; a.push( new _( e, t ) ), 1 !== a.length || c || s( d ) }, _.prototype.run = function () { this.fun.apply( null, this.array ) }, i.title = "browser", i.browser = !0, i.env = {}, i.argv = [], i.version = "", i.versions = {}, i.on = p, i.addListener = p, i.once = p, i.off = p, i.removeListener = p, i.removeAllListeners = p, i.emit = p, i.prependListener = p, i.prependOnceListener = p, i.listeners = function ( e ) { return [] }, i.binding = function ( e ) { throw new Error( "process.binding is not supported" ) }, i.cwd = function () { return "/" }, i.chdir = function ( e ) { throw new Error( "process.chdir is not supported" ) }, i.umask = function () { return 0 } }, function ( e, t, n ) { e.exports = function ( e ) { function t ( e ) { let n, i, o, u = null; function s ( ...e ) { if ( !s.enabled ) return; const r = s, i = Number( new Date ), o = i - ( n || i ); r.diff = o, r.prev = n, r.curr = i, n = i, e[0] = t.coerce( e[0] ), "string" != typeof e[0] && e.unshift( "%O" ); let u = 0; e[0] = e[0].replace( /%([a-zA-Z%])/g, ( n, i ) => { if ( "%%" === n ) return "%"; u++; const o = t.formatters[i]; if ( "function" == typeof o ) { const t = e[u]; n = o.call( r, t ), e.splice( u, 1 ), u-- } return n } ), t.formatArgs.call( r, e ), ( r.log || t.log ).apply( r, e ) } return s.namespace = e, s.useColors = t.useColors(), s.color = t.selectColor( e ), s.extend = r, s.destroy = t.destroy, Object.defineProperty( s, "enabled", { enumerable: !0, configurable: !1, get: () => null !== u ? u : ( i !== t.namespaces && ( i = t.namespaces, o = t.enabled( e ) ), o ), set: e => { u = e } } ), "function" == typeof t.init && t.init( s ), s } function r ( e, n ) { const r = t( this.namespace + ( void 0 === n ? ":" : n ) + e ); return r.log = this.log, r } function i ( e ) { return e.toString().substring( 2, e.toString().length - 2 ).replace( /\.\*\?$/, "*" ) } return t.debug = t, t.default = t, t.coerce = function ( e ) { if ( e instanceof Error ) return e.stack || e.message; return e }, t.disable = function () { const e = [...t.names.map( i ), ...t.skips.map( i ).map( e => "-" + e )].join( "," ); return t.enable( "" ), e }, t.enable = function ( e ) { let n; t.save( e ), t.namespaces = e, t.names = [], t.skips = []; const r = ( "string" == typeof e ? e : "" ).split( /[\s,]+/ ), i = r.length; for ( n = 0; n < i; n++ )r[n] && ( "-" === ( e = r[n].replace( /\*/g, ".*?" ) )[0] ? t.skips.push( new RegExp( "^" + e.substr( 1 ) + "$" ) ) : t.names.push( new RegExp( "^" + e + "$" ) ) ) }, t.enabled = function ( e ) { if ( "*" === e[e.length - 1] ) return !0; let n, r; for ( n = 0, r = t.skips.length; n < r; n++ )if ( t.skips[n].test( e ) ) return !1; for ( n = 0, r = t.names.length; n < r; n++ )if ( t.names[n].test( e ) ) return !0; return !1 }, t.humanize = n( 32 ), t.destroy = function () { console.warn( "Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`." ) }, Object.keys( e ).forEach( n => { t[n] = e[n] } ), t.names = [], t.skips = [], t.formatters = {}, t.selectColor = function ( e ) { let n = 0; for ( let t = 0; t < e.length; t++ )n = ( n << 5 ) - n + e.charCodeAt( t ), n |= 0; return t.colors[Math.abs( n ) % t.colors.length] }, t.enable( t.load() ), t } }, function ( e, t ) { var n = 1e3, r = 6e4, i = 36e5, o = 24 * i; function u ( e, t, n, r ) { var i = t >= 1.5 * n; return Math.round( e / n ) + " " + r + ( i ? "s" : "" ) } e.exports = function ( e, t ) { t = t || {}; var s = typeof e; if ( "string" === s && e.length > 0 ) return function ( e ) { if ( ( e = String( e ) ).length > 100 ) return; var t = /^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec( e ); if ( !t ) return; var u = parseFloat( t[1] ); switch ( ( t[2] || "ms" ).toLowerCase() ) { case "years": case "year": case "yrs": case "yr": case "y": return 315576e5 * u; case "weeks": case "week": case "w": return 6048e5 * u; case "days": case "day": case "d": return u * o; case "hours": case "hour": case "hrs": case "hr": case "h": return u * i; case "minutes": case "minute": case "mins": case "min": case "m": return u * r; case "seconds": case "second": case "secs": case "sec": case "s": return u * n; case "milliseconds": case "millisecond": case "msecs": case "msec": case "ms": return u; default: return } }( e ); if ( "number" === s && isFinite( e ) ) return t.long ? function ( e ) { var t = Math.abs( e ); if ( t >= o ) return u( e, t, o, "day" ); if ( t >= i ) return u( e, t, i, "hour" ); if ( t >= r ) return u( e, t, r, "minute" ); if ( t >= n ) return u( e, t, n, "second" ); return e + " ms" }( e ) : function ( e ) { var t = Math.abs( e ); if ( t >= o ) return Math.round( e / o ) + "d"; if ( t >= i ) return Math.round( e / i ) + "h"; if ( t >= r ) return Math.round( e / r ) + "m"; if ( t >= n ) return Math.round( e / n ) + "s"; return e + "ms" }( e ); throw new Error( "val is not a non-empty string or a valid number. val=" + JSON.stringify( e ) ) } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 2 ), o = n( 3 ), u = n( 1 ), s = n( 7 ), l = n( 11 ), a = new i( "Registrator" ); e.exports = function () { function e ( t, n ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._reg_id = 1, this._ua = t, this._transport = n, this._registrar = t.configuration.registrar_server, this._expires = t.configuration.register_expires, this._call_id = o.createRandomToken( 22 ), this._cseq = 0, this._to_uri = t.configuration.uri, this._registrationTimer = null, this._registering = !1, this._registered = !1, this._contact = this._ua.contact.toString(), this._contact += ";+sip.ice", this._extraHeaders = [], this._extraContactParams = "", this._sipInstance = '"<urn:uuid:'.concat( this._ua.configuration.instance_id, '>"' ), this._contact += ";reg-id=".concat( this._reg_id ), this._contact += ";+sip.instance=".concat( this._sipInstance ) } var t, n, i; return t = e, ( n = [{ key: "setExtraHeaders", value: function ( e ) { Array.isArray( e ) || ( e = [] ), this._extraHeaders = e.slice() } }, { key: "setExtraContactParams", value: function ( e ) { for ( var t in e instanceof Object || ( e = {} ), this._extraContactParams = "", e ) if ( Object.prototype.hasOwnProperty.call( e, t ) ) { var n = e[t]; this._extraContactParams += ";".concat( t ), n && ( this._extraContactParams += "=".concat( n ) ) } } }, { key: "register", value: function () { var e = this; if ( this._registering ) a.debug( "Register request in progress..." ); else { var t = this._extraHeaders.slice(); t.push( "Contact: ".concat( this._contact, ";expires=" ).concat( this._expires ).concat( this._extraContactParams ) ), t.push( "Expires: ".concat( this._expires ) ); var n = new s.OutgoingRequest( u.REGISTER, this._registrar, this._ua, { to_uri: this._to_uri, call_id: this._call_id, cseq: this._cseq += 1 }, t ), r = new l( this._ua, n, { onRequestTimeout: function () { e._registrationFailure( null, u.causes.REQUEST_TIMEOUT ) }, onTransportError: function () { e._registrationFailure( null, u.causes.CONNECTION_ERROR ) }, onAuthenticated: function () { e._cseq += 1 }, onReceiveResponse: function ( t ) { if ( t.cseq === e._cseq ) switch ( null !== e._registrationTimer && ( clearTimeout( e._registrationTimer ), e._registrationTimer = null ), !0 ) { case /^1[0-9]{2}$/.test( t.status_code ): break; case /^2[0-9]{2}$/.test( t.status_code ): if ( e._registering = !1, !t.hasHeader( "Contact" ) ) { a.debug( "no Contact header in response to REGISTER, response ignored" ); break } var n = t.headers.Contact.reduce( ( function ( e, t ) { return e.concat( t.parsed ) } ), [] ), r = n.find( ( function ( t ) { return e._sipInstance === t.getParam( "+sip.instance" ) && e._reg_id === parseInt( t.getParam( "reg-id" ) ) } ) ); if ( r || ( r = n.find( ( function ( t ) { return t.uri.user === e._ua.contact.uri.user } ) ) ), !r ) { a.debug( "no Contact header pointing to us, response ignored" ); break } var i = r.getParam( "expires" ); !i && t.hasHeader( "expires" ) && ( i = t.getHeader( "expires" ) ), i || ( i = e._expires ), ( i = Number( i ) ) < 10 && ( i = 10 ); var s = i > 64 ? 1e3 * i / 2 + Math.floor( 1e3 * ( i / 2 - 32 ) * Math.random() ) : 1e3 * i - 5e3; e._registrationTimer = setTimeout( ( function () { e._registrationTimer = null, 0 === e._ua.listeners( "registrationExpiring" ).length ? e.register() : e._ua.emit( "registrationExpiring" ) } ), s ), r.hasParam( "temp-gruu" ) && ( e._ua.contact.temp_gruu = r.getParam( "temp-gruu" ).replace( /"/g, "" ) ), r.hasParam( "pub-gruu" ) && ( e._ua.contact.pub_gruu = r.getParam( "pub-gruu" ).replace( /"/g, "" ) ), e._registered || ( e._registered = !0, e._ua.registered( { response: t } ) ); break; case /^423$/.test( t.status_code ): t.hasHeader( "min-expires" ) ? ( e._expires = Number( t.getHeader( "min-expires" ) ), e._expires < 10 && ( e._expires = 10 ), e.register() ) : ( a.debug( "423 response received for REGISTER without Min-Expires" ), e._registrationFailure( t, u.causes.SIP_FAILURE_CODE ) ); break; default: var l = o.sipErrorCause( t.status_code ); e._registrationFailure( t, l ) } } } ); this._registering = !0, r.send() } } }, { key: "unregister", value: function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; if ( this._registered ) { this._registered = !1, null !== this._registrationTimer && ( clearTimeout( this._registrationTimer ), this._registrationTimer = null ); var n = this._extraHeaders.slice(); t.all ? n.push( "Contact: *".concat( this._extraContactParams ) ) : n.push( "Contact: ".concat( this._contact, ";expires=0" ).concat( this._extraContactParams ) ), n.push( "Expires: 0" ); var r = new s.OutgoingRequest( u.REGISTER, this._registrar, this._ua, { to_uri: this._to_uri, call_id: this._call_id, cseq: this._cseq += 1 }, n ), i = new l( this._ua, r, { onRequestTimeout: function () { e._unregistered( null, u.causes.REQUEST_TIMEOUT ) }, onTransportError: function () { e._unregistered( null, u.causes.CONNECTION_ERROR ) }, onAuthenticated: function () { e._cseq += 1 }, onReceiveResponse: function ( t ) { switch ( !0 ) { case /^1[0-9]{2}$/.test( t.status_code ): break; case /^2[0-9]{2}$/.test( t.status_code ): e._unregistered( t ); break; default: var n = o.sipErrorCause( t.status_code ); e._unregistered( t, n ) } } } ); i.send() } else a.debug( "already unregistered" ) } }, { key: "close", value: function () { this._registered && this.unregister() } }, { key: "onTransportClosed", value: function () { this._registering = !1, null !== this._registrationTimer && ( clearTimeout( this._registrationTimer ), this._registrationTimer = null ), this._registered && ( this._registered = !1, this._ua.unregistered( {} ) ) } }, { key: "_registrationFailure", value: function ( e, t ) { this._registering = !1, this._ua.registrationFailed( { response: e || null, cause: t } ), this._registered && ( this._registered = !1, this._ua.unregistered( { response: e || null, cause: t } ) ) } }, { key: "_unregistered", value: function ( e, t ) { this._registering = !1, this._registered = !1, this._ua.unregistered( { response: e || null, cause: t || null } ) } }, { key: "registered", get: function () { return this._registered } }] ) && r( t.prototype, n ), i && r( t, i ), e }() }, function ( e, t, n ) { var r = function ( e ) { return String( Number( e ) ) === e ? Number( e ) : e }, i = function ( e, t, n ) { var i = e.name && e.names; e.push && !t[e.push] ? t[e.push] = [] : i && !t[e.name] && ( t[e.name] = {} ); var o = e.push ? {} : i ? t[e.name] : t; !function ( e, t, n, i ) { if ( i && !n ) t[i] = r( e[1] ); else for ( var o = 0; o < n.length; o += 1 )null != e[o + 1] && ( t[n[o]] = r( e[o + 1] ) ) }( n.match( e.reg ), o, e.names, e.name ), e.push && t[e.push].push( o ) }, o = n( 21 ), u = RegExp.prototype.test.bind( /^([a-z])=(.*)/ ); t.parse = function ( e ) { var t = {}, n = [], r = t; return e.split( /(\r\n|\r|\n)/ ).filter( u ).forEach( ( function ( e ) { var t = e[0], u = e.slice( 2 ); "m" === t && ( n.push( { rtp: [], fmtp: [] } ), r = n[n.length - 1] ); for ( var s = 0; s < ( o[t] || [] ).length; s += 1 ) { var l = o[t][s]; if ( l.reg.test( u ) ) return i( l, r, u ) } } ) ), t.media = n, t }; var s = function ( e, t ) { var n = t.split( /=(.+)/, 2 ); return 2 === n.length ? e[n[0]] = r( n[1] ) : 1 === n.length && t.length > 1 && ( e[n[0]] = void 0 ), e }; t.parseParams = function ( e ) { return e.split( /;\s?/ ).reduce( s, {} ) }, t.parseFmtpConfig = t.parseParams, t.parsePayloads = function ( e ) { return e.toString().split( " " ).map( Number ) }, t.parseRemoteCandidates = function ( e ) { for ( var t = [], n = e.split( " " ).map( r ), i = 0; i < n.length; i += 3 )t.push( { component: n[i], ip: n[i + 1], port: n[i + 2] } ); return t }, t.parseImageAttributes = function ( e ) { return e.split( " " ).map( ( function ( e ) { return e.substring( 1, e.length - 1 ).split( "," ).reduce( s, {} ) } ) ) }, t.parseSimulcastStreamList = function ( e ) { return e.split( ";" ).map( ( function ( e ) { return e.split( "," ).map( ( function ( e ) { var t, n = !1; return "~" !== e[0] ? t = r( e ) : ( t = r( e.substring( 1, e.length ) ), n = !0 ), { scid: t, paused: n } } ) ) } ) ) } }, function ( e, t, n ) { var r = n( 21 ), i = /%[sdv%]/g, o = function ( e ) { var t = 1, n = arguments, r = n.length; return e.replace( i, ( function ( e ) { if ( t >= r ) return e; var i = n[t]; switch ( t += 1, e ) { case "%%": return "%"; case "%s": return String( i ); case "%d": return Number( i ); case "%v": return "" } } ) ) }, u = function ( e, t, n ) { var r = [e + "=" + ( t.format instanceof Function ? t.format( t.push ? n : n[t.name] ) : t.format )]; if ( t.names ) for ( var i = 0; i < t.names.length; i += 1 ) { var u = t.names[i]; t.name ? r.push( n[t.name][u] ) : r.push( n[t.names[i]] ) } else r.push( n[t.name] ); return o.apply( null, r ) }, s = ["v", "o", "s", "i", "u", "e", "p", "c", "b", "t", "r", "z", "a"], l = ["i", "c", "b", "a"]; e.exports = function ( e, t ) { t = t || {}, null == e.version && ( e.version = 0 ), null == e.name && ( e.name = " " ), e.media.forEach( ( function ( e ) { null == e.payloads && ( e.payloads = "" ) } ) ); var n = t.outerOrder || s, i = t.innerOrder || l, o = []; return n.forEach( ( function ( t ) { r[t].forEach( ( function ( n ) { n.name in e && null != e[n.name] ? o.push( u( t, n, e ) ) : n.push in e && null != e[n.push] && e[n.push].forEach( ( function ( e ) { o.push( u( t, n, e ) ) } ) ) } ) ) } ) ), e.media.forEach( ( function ( e ) { o.push( u( "m", r.m[0], e ) ), i.forEach( ( function ( t ) { r[t].forEach( ( function ( n ) { n.name in e && null != e[n.name] ? o.push( u( t, n, e ) ) : n.push in e && null != e[n.push] && e[n.push].forEach( ( function ( e ) { o.push( u( t, n, e ) ) } ) ) } ) ) } ) ) } ) ), o.join( "\r\n" ) + "\r\n" } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 2 ), o = n( 3 ), u = new i( "DigestAuthentication" ); e.exports = function () { function e ( t ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._credentials = t, this._cnonce = null, this._nc = 0, this._ncHex = "00000000", this._algorithm = null, this._realm = null, this._nonce = null, this._opaque = null, this._stale = null, this._qop = null, this._method = null, this._uri = null, this._ha1 = null, this._response = null } var t, n, i; return t = e, ( n = [{ key: "get", value: function ( e ) { switch ( e ) { case "realm": return this._realm; case "ha1": return this._ha1; default: return void u.warn( 'get() | cannot get "%s" parameter', e ) } } }, { key: "authenticate", value: function ( e, t ) { var n = e.method, r = e.ruri, i = e.body, s = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null; if ( this._algorithm = t.algorithm, this._realm = t.realm, this._nonce = t.nonce, this._opaque = t.opaque, this._stale = t.stale, this._algorithm ) { if ( "MD5" !== this._algorithm ) return u.warn( 'authenticate() | challenge with Digest algorithm different than "MD5", authentication aborted' ), !1 } else this._algorithm = "MD5"; if ( !this._nonce ) return u.warn( "authenticate() | challenge without Digest nonce, authentication aborted" ), !1; if ( !this._realm ) return u.warn( "authenticate() | challenge without Digest realm, authentication aborted" ), !1; if ( !this._credentials.password ) { if ( !this._credentials.ha1 ) return u.warn( "authenticate() | no plain SIP password nor ha1 provided, authentication aborted" ), !1; if ( this._credentials.realm !== this._realm ) return u.warn( 'authenticate() | no plain SIP password, and stored `realm` does not match the given `realm`, cannot authenticate [stored:"%s", given:"%s"]', this._credentials.realm, this._realm ), !1 } if ( t.qop ) if ( t.qop.indexOf( "auth-int" ) > -1 ) this._qop = "auth-int"; else { if ( !( t.qop.indexOf( "auth" ) > -1 ) ) return u.warn( 'authenticate() | challenge without Digest qop different than "auth" or "auth-int", authentication aborted' ), !1; this._qop = "auth" } else this._qop = null; this._method = n, this._uri = r, this._cnonce = s || o.createRandomToken( 12 ), this._nc += 1; var l, a, c = Number( this._nc ).toString( 16 ); return this._ncHex = "00000000".substr( 0, 8 - c.length ) + c, 4294967296 === this._nc && ( this._nc = 1, this._ncHex = "00000001" ), this._credentials.password ? this._ha1 = o.calculateMD5( "".concat( this._credentials.username, ":" ).concat( this._realm, ":" ).concat( this._credentials.password ) ) : this._ha1 = this._credentials.ha1, "auth" === this._qop ? ( l = "".concat( this._method, ":" ).concat( this._uri ), a = o.calculateMD5( l ), u.debug( 'authenticate() | using qop=auth [a2:"%s"]', l ), this._response = o.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( this._ncHex, ":" ).concat( this._cnonce, ":auth:" ).concat( a ) ) ) : "auth-int" === this._qop ? ( l = "".concat( this._method, ":" ).concat( this._uri, ":" ).concat( o.calculateMD5( i || "" ) ), a = o.calculateMD5( l ), u.debug( 'authenticate() | using qop=auth-int [a2:"%s"]', l ), this._response = o.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( this._ncHex, ":" ).concat( this._cnonce, ":auth-int:" ).concat( a ) ) ) : null === this._qop && ( l = "".concat( this._method, ":" ).concat( this._uri ), a = o.calculateMD5( l ), u.debug( 'authenticate() | using qop=null [a2:"%s"]', l ), this._response = o.calculateMD5( "".concat( this._ha1, ":" ).concat( this._nonce, ":" ).concat( a ) ) ), u.debug( "authenticate() | response generated" ), !0 } }, { key: "toString", value: function () { var e = []; if ( !this._response ) throw new Error( "response field does not exist, cannot generate Authorization header" ); return e.push( "algorithm=".concat( this._algorithm ) ), e.push( 'username="'.concat( this._credentials.username, '"' ) ), e.push( 'realm="'.concat( this._realm, '"' ) ), e.push( 'nonce="'.concat( this._nonce, '"' ) ), e.push( 'uri="'.concat( this._uri, '"' ) ), e.push( 'response="'.concat( this._response, '"' ) ), this._opaque && e.push( 'opaque="'.concat( this._opaque, '"' ) ), this._qop && ( e.push( "qop=".concat( this._qop ) ), e.push( 'cnonce="'.concat( this._cnonce, '"' ) ), e.push( "nc=".concat( this._ncHex ) ) ), "Digest ".concat( e.join( ", " ) ) } }] ) && r( t.prototype, n ), i && r( t, i ), e }() }, function ( e, t, n ) { "use strict"; function r ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t, n ) { return t && i( e.prototype, t ), n && i( e, n ), e } var u = n( 2 ), s = n( 7 ), l = n( 1 ), a = n( 12 ), c = n( 38 ), f = n( 3 ), h = new u( "Dialog" ), d = { STATUS_EARLY: 1, STATUS_CONFIRMED: 2 }; e.exports = function () { function e ( t, n, i ) { var o = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : d.STATUS_CONFIRMED; if ( r( this, e ), this._owner = t, this._ua = t._ua, this._uac_pending_reply = !1, this._uas_pending_reply = !1, !n.hasHeader( "contact" ) ) return { error: "unable to create a Dialog without Contact header field" }; n instanceof s.IncomingResponse && ( o = n.status_code < 200 ? d.STATUS_EARLY : d.STATUS_CONFIRMED ); var u = n.parseHeader( "contact" ); "UAS" === i ? ( this._id = { call_id: n.call_id, local_tag: n.to_tag, remote_tag: n.from_tag, toString: function () { return this.call_id + this.local_tag + this.remote_tag } }, this._state = o, this._remote_seqnum = n.cseq, this._local_uri = n.parseHeader( "to" ).uri, this._remote_uri = n.parseHeader( "from" ).uri, this._remote_target = u.uri, this._route_set = n.getHeaders( "record-route" ), this._ack_seqnum = this._remote_seqnum ) : "UAC" === i && ( this._id = { call_id: n.call_id, local_tag: n.from_tag, remote_tag: n.to_tag, toString: function () { return this.call_id + this.local_tag + this.remote_tag } }, this._state = o, this._local_seqnum = n.cseq, this._local_uri = n.parseHeader( "from" ).uri, this._remote_uri = n.parseHeader( "to" ).uri, this._remote_target = u.uri, this._route_set = n.getHeaders( "record-route" ).reverse(), this._ack_seqnum = null ), this._ua.newDialog( this ), h.debug( "new ".concat( i, " dialog created with status " ).concat( this._state === d.STATUS_EARLY ? "EARLY" : "CONFIRMED" ) ) } return o( e, null, [{ key: "C", get: function () { return d } }] ), o( e, [{ key: "update", value: function ( e, t ) { this._state = d.STATUS_CONFIRMED, h.debug( "dialog ".concat( this._id.toString(), "  changed to CONFIRMED state" ) ), "UAC" === t && ( this._route_set = e.getHeaders( "record-route" ).reverse() ) } }, { key: "terminate", value: function () { h.debug( "dialog ".concat( this._id.toString(), " deleted" ) ), this._ua.destroyDialog( this ) } }, { key: "sendRequest", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, r = f.cloneArray( n.extraHeaders ), i = f.cloneObject( n.eventHandlers ), o = n.body || null, u = this._createRequest( e, r, o ); i.onAuthenticated = function () { t._local_seqnum += 1 }; var s = new c( this, u, i ); return s.send(), u } }, { key: "receiveRequest", value: function ( e ) { this._checkInDialogRequest( e ) && ( e.method === l.ACK && null !== this._ack_seqnum ? this._ack_seqnum = null : e.method === l.INVITE && ( this._ack_seqnum = e.cseq ), this._owner.receiveRequest( e ) ) } }, { key: "_createRequest", value: function ( e, t, n ) { t = f.cloneArray( t ), this._local_seqnum || ( this._local_seqnum = Math.floor( 1e4 * Math.random() ) ); var r = e === l.CANCEL || e === l.ACK ? this._local_seqnum : this._local_seqnum += 1; return new s.OutgoingRequest( e, this._remote_target, this._ua, { cseq: r, call_id: this._id.call_id, from_uri: this._local_uri, from_tag: this._id.local_tag, to_uri: this._remote_uri, to_tag: this._id.remote_tag, route_set: this._route_set }, t, n ) } }, { key: "_checkInDialogRequest", value: function ( e ) { var t = this; if ( this._remote_seqnum ) if ( e.cseq < this._remote_seqnum ) { if ( e.method !== l.ACK ) return e.reply( 500 ), !1; if ( null === this._ack_seqnum || e.cseq !== this._ack_seqnum ) return !1 } else e.cseq > this._remote_seqnum && ( this._remote_seqnum = e.cseq ); else this._remote_seqnum = e.cseq; if ( e.method === l.INVITE || e.method === l.UPDATE && e.body ) { if ( !0 === this._uac_pending_reply ) e.reply( 491 ); else { if ( !0 === this._uas_pending_reply ) { var n = 1 + ( 10 * Math.random() | 0 ); return e.reply( 500, null, ["Retry-After:".concat( n )] ), !1 } this._uas_pending_reply = !0; e.server_transaction.on( "stateChanged", ( function n () { e.server_transaction.state !== a.C.STATUS_ACCEPTED && e.server_transaction.state !== a.C.STATUS_COMPLETED && e.server_transaction.state !== a.C.STATUS_TERMINATED || ( e.server_transaction.removeListener( "stateChanged", n ), t._uas_pending_reply = !1 ) } ) ) } e.hasHeader( "contact" ) && e.server_transaction.on( "stateChanged", ( function () { e.server_transaction.state === a.C.STATUS_ACCEPTED && ( t._remote_target = e.parseHeader( "contact" ).uri ) } ) ) } else e.method === l.NOTIFY && e.hasHeader( "contact" ) && e.server_transaction.on( "stateChanged", ( function () { e.server_transaction.state === a.C.STATUS_COMPLETED && ( t._remote_target = e.parseHeader( "contact" ).uri ) } ) ); return !0 } }, { key: "id", get: function () { return this._id } }, { key: "local_seqnum", get: function () { return this._local_seqnum }, set: function ( e ) { this._local_seqnum = e } }, { key: "owner", get: function () { return this._owner } }, { key: "uac_pending_reply", get: function () { return this._uac_pending_reply }, set: function ( e ) { this._uac_pending_reply = e } }, { key: "uas_pending_reply", get: function () { return this._uas_pending_reply } }] ), e }() }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 1 ), o = n( 12 ), u = n( 23 ), s = n( 11 ), l = { onRequestTimeout: function () { }, onTransportError: function () { }, onSuccessResponse: function () { }, onErrorResponse: function () { }, onAuthenticated: function () { }, onDialogError: function () { } }; e.exports = function () { function e ( t, n, r ) { for ( var i in function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._dialog = t, this._ua = t._ua, this._request = n, this._eventHandlers = r, this._reattempt = !1, this._reattemptTimer = null, l ) Object.prototype.hasOwnProperty.call( l, i ) && ( this._eventHandlers[i] || ( this._eventHandlers[i] = l[i] ) ) } var t, n, a; return t = e, ( n = [{ key: "send", value: function () { var e = this, t = new s( this._ua, this._request, { onRequestTimeout: function () { e._eventHandlers.onRequestTimeout() }, onTransportError: function () { e._eventHandlers.onTransportError() }, onAuthenticated: function ( t ) { e._eventHandlers.onAuthenticated( t ) }, onReceiveResponse: function ( t ) { e._receiveResponse( t ) } } ); t.send(), ( this._request.method === i.INVITE || this._request.method === i.UPDATE && this._request.body ) && t.clientTransaction.state !== o.C.STATUS_TERMINATED && ( this._dialog.uac_pending_reply = !0, t.clientTransaction.on( "stateChanged", ( function n () { t.clientTransaction.state !== o.C.STATUS_ACCEPTED && t.clientTransaction.state !== o.C.STATUS_COMPLETED && t.clientTransaction.state !== o.C.STATUS_TERMINATED || ( t.clientTransaction.removeListener( "stateChanged", n ), e._dialog.uac_pending_reply = !1 ) } ) ) ) } }, { key: "_receiveResponse", value: function ( e ) { var t = this; 408 === e.status_code || 481 === e.status_code ? this._eventHandlers.onDialogError( e ) : e.method === i.INVITE && 491 === e.status_code ? this._reattempt ? e.status_code >= 200 && e.status_code < 300 ? this._eventHandlers.onSuccessResponse( e ) : e.status_code >= 300 && this._eventHandlers.onErrorResponse( e ) : ( this._request.cseq = this._dialog.local_seqnum += 1, this._reattemptTimer = setTimeout( ( function () { t._dialog.owner.status !== u.C.STATUS_TERMINATED && ( t._reattempt = !0, t._request_sender.send() ) } ), 1e3 ) ) : e.status_code >= 200 && e.status_code < 300 ? this._eventHandlers.onSuccessResponse( e ) : e.status_code >= 300 && this._eventHandlers.onErrorResponse( e ) } }, { key: "request", get: function () { return this._request } }] ) && r( t.prototype, n ), a && r( t, a ), e }() }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var a = n( 5 ).EventEmitter, c = n( 2 ), f = n( 1 ), h = n( 8 ), d = n( 3 ), _ = new c( "RTCSession:DTMF" ), p = { MIN_DURATION: 70, MAX_DURATION: 6e3, DEFAULT_DURATION: 100, MIN_INTER_TONE_GAP: 50, DEFAULT_INTER_TONE_GAP: 500 }; e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) }( l, e ); var t, n, r, s = u( l ); function l ( e ) { var t; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, l ), ( t = s.call( this ) )._session = e, t._direction = null, t._tone = null, t._duration = null, t._request = null, t } return t = l, ( n = [{ key: "send", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; if ( void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._direction = "outgoing", this._session.status !== this._session.C.STATUS_CONFIRMED && this._session.status !== this._session.C.STATUS_WAITING_FOR_ACK ) throw new h.InvalidStateError( this._session.status ); var r = d.cloneArray( n.extraHeaders ); if ( this.eventHandlers = d.cloneObject( n.eventHandlers ), "string" == typeof e ) e = e.toUpperCase(); else { if ( "number" != typeof e ) throw new TypeError( "Invalid tone: ".concat( e ) ); e = e.toString() } if ( !e.match( /^[0-9A-DR#*]$/ ) ) throw new TypeError( "Invalid tone: ".concat( e ) ); this._tone = e, this._duration = n.duration, r.push( "Content-Type: application/dtmf-relay" ); var i = "Signal=".concat( this._tone, "\r\n" ); i += "Duration=".concat( this._duration ), this._session.newDTMF( { originator: "local", dtmf: this, request: this._request } ), this._session.sendRequest( f.INFO, { extraHeaders: r, eventHandlers: { onSuccessResponse: function ( e ) { t.emit( "succeeded", { originator: "remote", response: e } ) }, onErrorResponse: function ( e ) { t.eventHandlers.onFailed && t.eventHandlers.onFailed(), t.emit( "failed", { originator: "remote", response: e } ) }, onRequestTimeout: function () { t._session.onRequestTimeout() }, onTransportError: function () { t._session.onTransportError() }, onDialogError: function () { t._session.onDialogError() } }, body: i } ) } }, { key: "init_incoming", value: function ( e ) { var t = /^(Signal\s*?=\s*?)([0-9A-D#*]{1})(\s)?.*/, n = /^(Duration\s?=\s?)([0-9]{1,4})(\s)?.*/; if ( this._direction = "incoming", this._request = e, e.reply( 200 ), e.body ) { var r = e.body.split( "\n" ); r.length >= 1 && t.test( r[0] ) && ( this._tone = r[0].replace( t, "$2" ) ), r.length >= 2 && n.test( r[1] ) && ( this._duration = parseInt( r[1].replace( n, "$2" ), 10 ) ) } this._duration || ( this._duration = p.DEFAULT_DURATION ), this._tone ? this._session.newDTMF( { originator: "remote", dtmf: this, request: e } ) : _.debug( "invalid INFO DTMF received, discarded" ) } }, { key: "tone", get: function () { return this._tone } }, { key: "duration", get: function () { return this._duration } }] ) && i( t.prototype, n ), r && i( t, r ), l }( a ), e.exports.C = p }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var a = n( 5 ).EventEmitter, c = n( 1 ), f = n( 8 ), h = n( 3 ); e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) }( l, e ); var t, n, r, s = u( l ); function l ( e ) { var t; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, l ), ( t = s.call( this ) )._session = e, t._direction = null, t._contentType = null, t._body = null, t } return t = l, ( n = [{ key: "send", value: function ( e, t ) { var n = this, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}; if ( this._direction = "outgoing", void 0 === e ) throw new TypeError( "Not enough arguments" ); if ( this._session.status !== this._session.C.STATUS_CONFIRMED && this._session.status !== this._session.C.STATUS_WAITING_FOR_ACK ) throw new f.InvalidStateError( this._session.status ); this._contentType = e, this._body = t; var i = h.cloneArray( r.extraHeaders ); i.push( "Content-Type: ".concat( e ) ), this._session.newInfo( { originator: "local", info: this, request: this.request } ), this._session.sendRequest( c.INFO, { extraHeaders: i, eventHandlers: { onSuccessResponse: function ( e ) { n.emit( "succeeded", { originator: "remote", response: e } ) }, onErrorResponse: function ( e ) { n.emit( "failed", { originator: "remote", response: e } ) }, onTransportError: function () { n._session.onTransportError() }, onRequestTimeout: function () { n._session.onRequestTimeout() }, onDialogError: function () { n._session.onDialogError() } }, body: t } ) } }, { key: "init_incoming", value: function ( e ) { this._direction = "incoming", this.request = e, e.reply( 200 ), this._contentType = e.hasHeader( "Content-Type" ) ? e.getHeader( "Content-Type" ).toLowerCase() : void 0, this._body = e.body, this._session.newInfo( { originator: "remote", info: this, request: e } ) } }, { key: "contentType", get: function () { return this._contentType } }, { key: "body", get: function () { return this._body } }] ) && i( t.prototype, n ), r && i( t, r ), l }( a ) }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 2 ), o = n( 1 ), u = new i( "RTCSession:ReferNotifier" ), s = "refer", l = "message/sipfrag;version=2.0", a = 300; e.exports = function () { function e ( t, n, r ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), this._session = t, this._id = n, this._expires = r || a, this._active = !0, this.notify( 100 ) } var t, n, i; return t = e, ( n = [{ key: "notify", value: function ( e, t ) { var n; u.debug( "notify()" ), !1 !== this._active && ( t = t || o.REASON_PHRASE[e] || "", n = e >= 200 ? "terminated;reason=noresource" : "active;expires=".concat( this._expires ), this._session.sendRequest( o.NOTIFY, { extraHeaders: ["Event: ".concat( s, ";id=" ).concat( this._id ), "Subscription-State: ".concat( n ), "Content-Type: ".concat( l )], body: "SIP/2.0 ".concat( e, " " ).concat( t ), eventHandlers: { onErrorResponse: function () { this._active = !1 } } } ) ) } }] ) && r( t.prototype, n ), i && r( t, i ), e }() }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var a = n( 5 ).EventEmitter, c = n( 2 ), f = n( 1 ), h = n( 6 ), d = n( 3 ), _ = new c( "RTCSession:ReferSubscriber" ); e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) }( l, e ); var t, n, r, s = u( l ); function l ( e ) { var t; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, l ), ( t = s.call( this ) )._id = null, t._session = e, t } return t = l, ( n = [{ key: "sendRefer", value: function ( e ) { var t = this, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; _.debug( "sendRefer()" ); var r = d.cloneArray( n.extraHeaders ), i = d.cloneObject( n.eventHandlers ); for ( var o in i ) Object.prototype.hasOwnProperty.call( i, o ) && this.on( o, i[o] ); var u = null; n.replaces && ( u = n.replaces._request.call_id, u += ";to-tag=".concat( n.replaces._to_tag ), u += ";from-tag=".concat( n.replaces._from_tag ), u = encodeURIComponent( u ) ); var s = "Refer-To: <".concat( e ).concat( u ? "?Replaces=".concat( u ) : "", ">" ); if ( r.push( s ), !r.some( ( function ( e ) { return e.toLowerCase().startsWith( "referred-by:" ) } ) ) ) { var l = "Referred-By: <".concat( this._session._ua._configuration.uri._scheme, ":" ).concat( this._session._ua._configuration.uri._user, "@" ).concat( this._session._ua._configuration.uri._host, ">" ); r.push( l ) } r.push( "Contact: ".concat( this._session.contact ) ); var a = this._session.sendRequest( f.REFER, { extraHeaders: r, eventHandlers: { onSuccessResponse: function ( e ) { t._requestSucceeded( e ) }, onErrorResponse: function ( e ) { t._requestFailed( e, f.causes.REJECTED ) }, onTransportError: function () { t._requestFailed( null, f.causes.CONNECTION_ERROR ) }, onRequestTimeout: function () { t._requestFailed( null, f.causes.REQUEST_TIMEOUT ) }, onDialogError: function () { t._requestFailed( null, f.causes.DIALOG_ERROR ) } } } ); this._id = a.cseq } }, { key: "receiveNotify", value: function ( e ) { if ( _.debug( "receiveNotify()" ), e.body ) { var t = h.parse( e.body.trim(), "Status_Line" ); if ( -1 !== t ) switch ( !0 ) { case /^100$/.test( t.status_code ): this.emit( "trying", { request: e, status_line: t } ); break; case /^1[0-9]{2}$/.test( t.status_code ): this.emit( "progress", { request: e, status_line: t } ); break; case /^2[0-9]{2}$/.test( t.status_code ): this.emit( "accepted", { request: e, status_line: t } ); break; default: this.emit( "failed", { request: e, status_line: t } ) } else _.debug( 'receiveNotify() | error parsing NOTIFY body: "'.concat( e.body, '"' ) ) } } }, { key: "_requestSucceeded", value: function ( e ) { _.debug( "REFER succeeded" ), _.debug( 'emit "requestSucceeded"' ), this.emit( "requestSucceeded", { response: e } ) } }, { key: "_requestFailed", value: function ( e, t ) { _.debug( "REFER failed" ), _.debug( 'emit "requestFailed"' ), this.emit( "requestFailed", { response: e || null, cause: t } ) } }, { key: "id", get: function () { return this._id } }] ) && i( t.prototype, n ), r && i( t, r ), l }( a ) }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var a = n( 5 ).EventEmitter, c = n( 2 ), f = n( 1 ), h = n( 7 ), d = n( 3 ), _ = n( 11 ), p = n( 8 ), v = n( 9 ), m = new c( "Message" ); e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) }( l, e ); var t, n, r, s = u( l ); function l ( e ) { var t; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, l ), ( t = s.call( this ) )._ua = e, t._request = null, t._closed = !1, t._direction = null, t._local_identity = null, t._remote_identity = null, t._is_replied = !1, t._data = {}, t } return t = l, ( n = [{ key: "send", value: function ( e, t ) { var n = this, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, i = e; if ( void 0 === e || void 0 === t ) throw new TypeError( "Not enough arguments" ); if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( i ) ); var o = d.cloneArray( r.extraHeaders ), u = d.cloneObject( r.eventHandlers ), s = r.contentType || "text/plain", l = {}; for ( var a in r.fromUserName && ( l.from_uri = new v( "sip", r.fromUserName, this._ua.configuration.uri.host ), o.push( "P-Preferred-Identity: ".concat( this._ua.configuration.uri.toString() ) ) ), r.fromDisplayName && ( l.from_display_name = r.fromDisplayName ), u ) Object.prototype.hasOwnProperty.call( u, a ) && this.on( a, u[a] ); o.push( "Content-Type: ".concat( s ) ), this._request = new h.OutgoingRequest( f.MESSAGE, e, this._ua, l, o ), t && ( this._request.body = t ); var c = new _( this._ua, this._request, { onRequestTimeout: function () { n._onRequestTimeout() }, onTransportError: function () { n._onTransportError() }, onReceiveResponse: function ( e ) { n._receiveResponse( e ) } } ); this._newMessage( "local", this._request ), c.send() } }, { key: "init_incoming", value: function ( e ) { this._request = e, this._newMessage( "remote", e ), this._is_replied || ( this._is_replied = !0, e.reply( 200 ) ), this._close() } }, { key: "accept", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = d.cloneArray( e.extraHeaders ), n = e.body; if ( "incoming" !== this._direction ) throw new p.NotSupportedError( '"accept" not supported for outgoing Message' ); if ( this._is_replied ) throw new Error( "incoming Message already replied" ); this._is_replied = !0, this._request.reply( 200, null, t, n ) } }, { key: "reject", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.status_code || 480, n = e.reason_phrase, r = d.cloneArray( e.extraHeaders ), i = e.body; if ( "incoming" !== this._direction ) throw new p.NotSupportedError( '"reject" not supported for outgoing Message' ); if ( this._is_replied ) throw new Error( "incoming Message already replied" ); if ( t < 300 || t >= 700 ) throw new TypeError( "Invalid status_code: ".concat( t ) ); this._is_replied = !0, this._request.reply( t, n, r, i ) } }, { key: "_receiveResponse", value: function ( e ) { if ( !this._closed ) switch ( !0 ) { case /^1[0-9]{2}$/.test( e.status_code ): break; case /^2[0-9]{2}$/.test( e.status_code ): this._succeeded( "remote", e ); break; default: var t = d.sipErrorCause( e.status_code ); this._failed( "remote", e, t ) } } }, { key: "_onRequestTimeout", value: function () { this._closed || this._failed( "system", null, f.causes.REQUEST_TIMEOUT ) } }, { key: "_onTransportError", value: function () { this._closed || this._failed( "system", null, f.causes.CONNECTION_ERROR ) } }, { key: "_close", value: function () { this._closed = !0, this._ua.destroyMessage( this ) } }, { key: "_newMessage", value: function ( e, t ) { "remote" === e ? ( this._direction = "incoming", this._local_identity = t.to, this._remote_identity = t.from ) : "local" === e && ( this._direction = "outgoing", this._local_identity = t.from, this._remote_identity = t.to ), this._ua.newMessage( this, { originator: e, message: this, request: t } ) } }, { key: "_failed", value: function ( e, t, n ) { m.debug( "MESSAGE failed" ), this._close(), m.debug( 'emit "failed"' ), this.emit( "failed", { originator: e, response: t || null, cause: n } ) } }, { key: "_succeeded", value: function ( e, t ) { m.debug( "MESSAGE succeeded" ), this._close(), m.debug( 'emit "succeeded"' ), this.emit( "succeeded", { originator: e, response: t } ) } }, { key: "direction", get: function () { return this._direction } }, { key: "local_identity", get: function () { return this._local_identity } }, { key: "remote_identity", get: function () { return this._remote_identity } }] ) && i( t.prototype, n ), r && i( t, r ), l }( a ) }, function ( e, t, n ) { "use strict"; function r ( e ) { return ( r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function ( e ) { return typeof e } : function ( e ) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e } )( e ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } function o ( e, t ) { return ( o = Object.setPrototypeOf || function ( e, t ) { return e.__proto__ = t, e } )( e, t ) } function u ( e ) { var t = function () { if ( "undefined" == typeof Reflect || !Reflect.construct ) return !1; if ( Reflect.construct.sham ) return !1; if ( "function" == typeof Proxy ) return !0; try { return Date.prototype.toString.call( Reflect.construct( Date, [], ( function () { } ) ) ), !0 } catch ( e ) { return !1 } }(); return function () { var n, r = l( e ); if ( t ) { var i = l( this ).constructor; n = Reflect.construct( r, arguments, i ) } else n = r.apply( this, arguments ); return s( this, n ) } } function s ( e, t ) { return !t || "object" !== r( t ) && "function" != typeof t ? function ( e ) { if ( void 0 === e ) throw new ReferenceError( "this hasn't been initialised - super() hasn't been called" ); return e }( e ) : t } function l ( e ) { return ( l = Object.setPrototypeOf ? Object.getPrototypeOf : function ( e ) { return e.__proto__ || Object.getPrototypeOf( e ) } )( e ) } var a = n( 5 ).EventEmitter, c = n( 2 ), f = n( 1 ), h = n( 7 ), d = n( 3 ), _ = n( 11 ), p = n( 8 ), v = new c( "Options" ); e.exports = function ( e ) { !function ( e, t ) { if ( "function" != typeof t && null !== t ) throw new TypeError( "Super expression must either be null or a function" ); e.prototype = Object.create( t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } } ), t && o( e, t ) }( l, e ); var t, n, r, s = u( l ); function l ( e ) { var t; return function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, l ), ( t = s.call( this ) )._ua = e, t._request = null, t._closed = !1, t._direction = null, t._local_identity = null, t._remote_identity = null, t._is_replied = !1, t._data = {}, t } return t = l, ( n = [{ key: "send", value: function ( e, t ) { var n = this, r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}, i = e; if ( void 0 === e ) throw new TypeError( "A target is required for OPTIONS" ); if ( !( e = this._ua.normalizeTarget( e ) ) ) throw new TypeError( "Invalid target: ".concat( i ) ); var o = d.cloneArray( r.extraHeaders ), u = d.cloneObject( r.eventHandlers ), s = r.contentType || "application/sdp"; for ( var l in u ) Object.prototype.hasOwnProperty.call( u, l ) && this.on( l, u[l] ); o.push( "Content-Type: ".concat( s ) ), this._request = new h.OutgoingRequest( f.OPTIONS, e, this._ua, null, o ), t && ( this._request.body = t ); var a = new _( this._ua, this._request, { onRequestTimeout: function () { n._onRequestTimeout() }, onTransportError: function () { n._onTransportError() }, onReceiveResponse: function ( e ) { n._receiveResponse( e ) } } ); this._newOptions( "local", this._request ), a.send() } }, { key: "init_incoming", value: function ( e ) { this._request = e, this._newOptions( "remote", e ), this._is_replied || ( this._is_replied = !0, e.reply( 200 ) ), this._close() } }, { key: "accept", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = d.cloneArray( e.extraHeaders ), n = e.body; if ( "incoming" !== this._direction ) throw new p.NotSupportedError( '"accept" not supported for outgoing Options' ); if ( this._is_replied ) throw new Error( "incoming Options already replied" ); this._is_replied = !0, this._request.reply( 200, null, t, n ) } }, { key: "reject", value: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.status_code || 480, n = e.reason_phrase, r = d.cloneArray( e.extraHeaders ), i = e.body; if ( "incoming" !== this._direction ) throw new p.NotSupportedError( '"reject" not supported for outgoing Options' ); if ( this._is_replied ) throw new Error( "incoming Options already replied" ); if ( t < 300 || t >= 700 ) throw new TypeError( "Invalid status_code: ".concat( t ) ); this._is_replied = !0, this._request.reply( t, n, r, i ) } }, { key: "_receiveResponse", value: function ( e ) { if ( !this._closed ) switch ( !0 ) { case /^1[0-9]{2}$/.test( e.status_code ): break; case /^2[0-9]{2}$/.test( e.status_code ): this._succeeded( "remote", e ); break; default: var t = d.sipErrorCause( e.status_code ); this._failed( "remote", e, t ) } } }, { key: "_onRequestTimeout", value: function () { this._closed || this._failed( "system", null, f.causes.REQUEST_TIMEOUT ) } }, { key: "_onTransportError", value: function () { this._closed || this._failed( "system", null, f.causes.CONNECTION_ERROR ) } }, { key: "_close", value: function () { this._closed = !0, this._ua.destroyMessage( this ) } }, { key: "_newOptions", value: function ( e, t ) { "remote" === e ? ( this._direction = "incoming", this._local_identity = t.to, this._remote_identity = t.from ) : "local" === e && ( this._direction = "outgoing", this._local_identity = t.from, this._remote_identity = t.to ), this._ua.newOptions( this, { originator: e, message: this, request: t } ) } }, { key: "_failed", value: function ( e, t, n ) { v.debug( "OPTIONS failed" ), this._close(), v.debug( 'emit "failed"' ), this.emit( "failed", { originator: e, response: t || null, cause: n } ) } }, { key: "_succeeded", value: function ( e, t ) { v.debug( "OPTIONS succeeded" ), this._close(), v.debug( 'emit "succeeded"' ), this.emit( "succeeded", { originator: e, response: t } ) } }, { key: "direction", get: function () { return this._direction } }, { key: "local_identity", get: function () { return this._local_identity } }, { key: "remote_identity", get: function () { return this._remote_identity } }] ) && i( t.prototype, n ), r && i( t, r ), l }( a ) }, function ( e, t, n ) { "use strict"; function r ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) } function i ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var o = n( 2 ), u = n( 24 ), s = n( 1 ), l = new o( "Transport" ), a = { STATUS_CONNECTED: 0, STATUS_CONNECTING: 1, STATUS_DISCONNECTED: 2, SOCKET_STATUS_READY: 0, SOCKET_STATUS_ERROR: 1, recovery_options: { min_interval: s.CONNECTION_RECOVERY_MIN_INTERVAL, max_interval: s.CONNECTION_RECOVERY_MAX_INTERVAL } }; e.exports = function () { function e ( t ) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : a.recovery_options; r( this, e ), l.debug( "new()" ), this.status = a.STATUS_DISCONNECTED, this.socket = null, this.sockets = [], this.recovery_options = n, this.recover_attempts = 0, this.recovery_timer = null, this.close_requested = !1; try { this.textDecoder = new TextDecoder( "utf8" ) } catch ( e ) { l.warn( "cannot use TextDecoder: ".concat( e ) ) } if ( void 0 === t ) throw new TypeError( "Invalid argument. undefined 'sockets' argument" ); t instanceof Array || ( t = [t] ), t.forEach( ( function ( e ) { if ( !u.isSocket( e.socket ) ) throw new TypeError( "Invalid argument. invalid 'JsSIP.Socket' instance" ); if ( e.weight && !Number( e.weight ) ) throw new TypeError( "Invalid argument. 'weight' attribute is not a number" ); this.sockets.push( { socket: e.socket, weight: e.weight || 0, status: a.SOCKET_STATUS_READY } ) } ), this ), this._getSocket() } var t, n, o; return t = e, ( n = [{ key: "connect", value: function () { l.debug( "connect()" ), this.isConnected() ? l.debug( "Transport is already connected" ) : this.isConnecting() ? l.debug( "Transport is connecting" ) : ( this.close_requested = !1, this.status = a.STATUS_CONNECTING, this.onconnecting( { socket: this.socket, attempts: this.recover_attempts } ), this.close_requested || ( this.socket.onconnect = this._onConnect.bind( this ), this.socket.ondisconnect = this._onDisconnect.bind( this ), this.socket.ondata = this._onData.bind( this ), this.socket.connect() ) ) } }, { key: "disconnect", value: function () { l.debug( "close()" ), this.close_requested = !0, this.recover_attempts = 0, this.status = a.STATUS_DISCONNECTED, null !== this.recovery_timer && ( clearTimeout( this.recovery_timer ), this.recovery_timer = null ), this.socket.onconnect = function () { }, this.socket.ondisconnect = function () { }, this.socket.ondata = function () { }, this.socket.disconnect(), this.ondisconnect( { socket: this.socket, error: !1 } ) } }, { key: "send", value: function ( e ) { if ( l.debug( "send()" ), !this.isConnected() ) return l.warn( "unable to send message, transport is not connected" ), !1; var t = e.toString(); return l.debug( "sending message:\n\n".concat( t, "\n" ) ), this.socket.send( t ) } }, { key: "isConnected", value: function () { return this.status === a.STATUS_CONNECTED } }, { key: "isConnecting", value: function () { return this.status === a.STATUS_CONNECTING } }, { key: "_reconnect", value: function () { var e = this; this.recover_attempts += 1; var t = Math.floor( Math.random() * Math.pow( 2, this.recover_attempts ) + 1 ); t < this.recovery_options.min_interval ? t = this.recovery_options.min_interval : t > this.recovery_options.max_interval && ( t = this.recovery_options.max_interval ), l.debug( "reconnection attempt: ".concat( this.recover_attempts, ". next connection attempt in " ).concat( t, " seconds" ) ), this.recovery_timer = setTimeout( ( function () { e.close_requested || e.isConnected() || e.isConnecting() || ( e._getSocket(), e.connect() ) } ), 1e3 * t ) } }, { key: "_getSocket", value: function () { var e = []; if ( this.sockets.forEach( ( function ( t ) { t.status !== a.SOCKET_STATUS_ERROR && ( 0 === e.length ? e.push( t ) : t.weight > e[0].weight ? e = [t] : t.weight === e[0].weight && e.push( t ) ) } ) ), 0 === e.length ) return this.sockets.forEach( ( function ( e ) { e.status = a.SOCKET_STATUS_READY } ) ), void this._getSocket(); var t = Math.floor( Math.random() * e.length ); this.socket = e[t].socket } }, { key: "_onConnect", value: function () { this.recover_attempts = 0, this.status = a.STATUS_CONNECTED, null !== this.recovery_timer && ( clearTimeout( this.recovery_timer ), this.recovery_timer = null ), this.onconnect( { socket: this } ) } }, { key: "_onDisconnect", value: function ( e, t, n ) { this.status = a.STATUS_DISCONNECTED, this.ondisconnect( { socket: this.socket, error: e, code: t, reason: n } ), this.close_requested || ( this.sockets.forEach( ( function ( e ) { this.socket === e.socket && ( e.status = a.SOCKET_STATUS_ERROR ) } ), this ), this._reconnect( e ) ) } }, { key: "_onData", value: function ( e ) { if ( "\r\n" !== e ) { if ( "string" != typeof e ) { try { e = this.textDecoder ? this.textDecoder.decode( e ) : String.fromCharCode.apply( null, new Uint8Array( e ) ) } catch ( e ) { return void l.debug( "received binary message failed to be converted into string, message discarded" ) } l.debug( "received binary message:\n\n".concat( e, "\n" ) ) } else l.debug( "received text message:\n\n".concat( e, "\n" ) ); this.ondata( { transport: this, message: e } ) } else l.debug( "received message with CRLF Keep Alive response" ) } }, { key: "via_transport", get: function () { return this.socket.via_transport } }, { key: "url", get: function () { return this.socket.url } }, { key: "sip_uri", get: function () { return this.socket.sip_uri } }] ) && i( t.prototype, n ), o && i( t, o ), e }() }, function ( e, t, n ) { "use strict"; function r ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return i( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return i( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, o = function () { }; return { s: o, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: o } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function i ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } var o = n( 2 ), u = n( 6 ), s = n( 7 ), l = new o( "Parser" ); function a ( e, t ) { var n = t, r = 0, i = 0; if ( e.substring( n, n + 2 ).match( /(^\r\n)/ ) ) return -2; for ( ; 0 === r; ) { if ( -1 === ( i = e.indexOf( "\r\n", n ) ) ) return i; !e.substring( i + 2, i + 4 ).match( /(^\r\n)/ ) && e.charAt( i + 2 ).match( /(^\s+)/ ) ? n = i + 2 : r = i } return r } function c ( e, t, n, i ) { var o, l = t.indexOf( ":", n ), a = t.substring( n, l ).trim(), c = t.substring( l + 1, i ).trim(); switch ( a.toLowerCase() ) { case "via": case "v": e.addHeader( "via", c ), 1 === e.getHeaders( "via" ).length ? ( o = e.parseHeader( "Via" ) ) && ( e.via = o, e.via_branch = o.branch ) : o = 0; break; case "from": case "f": e.setHeader( "from", c ), ( o = e.parseHeader( "from" ) ) && ( e.from = o, e.from_tag = o.getParam( "tag" ) ); break; case "to": case "t": e.setHeader( "to", c ), ( o = e.parseHeader( "to" ) ) && ( e.to = o, e.to_tag = o.getParam( "tag" ) ); break; case "record-route": if ( -1 === ( o = u.parse( c, "Record_Route" ) ) ) o = void 0; else { var f, h = r( o ); try { for ( h.s(); !( f = h.n() ).done; ) { var d = f.value; e.addHeader( "record-route", c.substring( d.possition, d.offset ) ), e.headers["Record-Route"][e.getHeaders( "record-route" ).length - 1].parsed = d.parsed } } catch ( e ) { h.e( e ) } finally { h.f() } } break; case "call-id": case "i": e.setHeader( "call-id", c ), ( o = e.parseHeader( "call-id" ) ) && ( e.call_id = c ); break; case "contact": case "m": if ( -1 === ( o = u.parse( c, "Contact" ) ) ) o = void 0; else { var _, p = r( o ); try { for ( p.s(); !( _ = p.n() ).done; ) { var v = _.value; e.addHeader( "contact", c.substring( v.possition, v.offset ) ), e.headers.Contact[e.getHeaders( "contact" ).length - 1].parsed = v.parsed } } catch ( e ) { p.e( e ) } finally { p.f() } } break; case "content-length": case "l": e.setHeader( "content-length", c ), o = e.parseHeader( "content-length" ); break; case "content-type": case "c": e.setHeader( "content-type", c ), o = e.parseHeader( "content-type" ); break; case "cseq": e.setHeader( "cseq", c ), ( o = e.parseHeader( "cseq" ) ) && ( e.cseq = o.value ), e instanceof s.IncomingResponse && ( e.method = o.method ); break; case "max-forwards": e.setHeader( "max-forwards", c ), o = e.parseHeader( "max-forwards" ); break; case "www-authenticate": e.setHeader( "www-authenticate", c ), o = e.parseHeader( "www-authenticate" ); break; case "proxy-authenticate": e.setHeader( "proxy-authenticate", c ), o = e.parseHeader( "proxy-authenticate" ); break; case "session-expires": case "x": e.setHeader( "session-expires", c ), ( o = e.parseHeader( "session-expires" ) ) && ( e.session_expires = o.expires, e.session_expires_refresher = o.refresher ); break; case "refer-to": case "r": e.setHeader( "refer-to", c ), ( o = e.parseHeader( "refer-to" ) ) && ( e.refer_to = o ); break; case "replaces": e.setHeader( "replaces", c ), ( o = e.parseHeader( "replaces" ) ) && ( e.replaces = o ); break; case "event": case "o": e.setHeader( "event", c ), ( o = e.parseHeader( "event" ) ) && ( e.event = o ); break; default: e.addHeader( a, c ), o = 0 }return void 0 !== o || { error: 'error parsing header "'.concat( a, '"' ) } } t.parseMessage = function ( e, t ) { var n, r, i = e.indexOf( "\r\n" ); if ( -1 !== i ) { var o = e.substring( 0, i ), f = u.parse( o, "Request_Response" ); if ( -1 !== f ) { f.status_code ? ( ( n = new s.IncomingResponse ).status_code = f.status_code, n.reason_phrase = f.reason_phrase ) : ( ( n = new s.IncomingRequest( t ) ).method = f.method, n.ruri = f.uri ), n.data = e; for ( var h = i + 2; ; ) { if ( -2 === ( i = a( e, h ) ) ) { r = h + 2; break } if ( -1 === i ) return void l.warn( "parseMessage() | malformed message" ); if ( !0 !== ( f = c( n, e, h, i ) ) ) return void l.warn( "parseMessage() |", f.error ); h = i + 2 } if ( n.hasHeader( "content-length" ) ) { var d = n.getHeader( "content-length" ); n.body = e.substr( r, d ) } else n.body = e.substring( r ); return n } l.warn( 'parseMessage() | error parsing first line of SIP message: "'.concat( o, '"' ) ) } else l.warn( "parseMessage() | no CRLF found, not a SIP message" ) } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return i( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return i( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, o = function () { }; return { s: o, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: o } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function i ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } var o, u, s, l = n( 2 ), a = n( 1 ), c = n( 7 ), f = n( 3 ), h = new l( "sanityCheck" ), d = [function () { for ( var e = 0, t = ["from", "to", "call_id", "cseq", "via"]; e < t.length; e++ ) { var n = t[e]; if ( !o.hasHeader( n ) ) return h.debug( "missing mandatory header field : ".concat( n, ", dropping the response" ) ), !1 } }], _ = [function () { if ( "sip" !== o.s( "to" ).uri.scheme ) return v( 416 ), !1 }, function () { if ( !o.to_tag && o.call_id.substr( 0, 5 ) === u.configuration.jssip_id ) return v( 482 ), !1 }, function () { var e = f.str_utf8_length( o.body ), t = o.getHeader( "content-length" ); if ( e < t ) return v( 400 ), !1 }, function () { var e, t = o.from_tag, n = o.call_id, r = o.cseq; if ( o.to_tag ) return; if ( o.method === a.INVITE ) { if ( u._transactions.ist[o.via_branch] ) return !1; for ( var i in u._transactions.ist ) if ( Object.prototype.hasOwnProperty.call( u._transactions.ist, i ) && ( e = u._transactions.ist[i] ).request.from_tag === t && e.request.call_id === n && e.request.cseq === r ) return v( 482 ), !1 } else { if ( u._transactions.nist[o.via_branch] ) return !1; for ( var s in u._transactions.nist ) if ( Object.prototype.hasOwnProperty.call( u._transactions.nist, s ) && ( e = u._transactions.nist[s] ).request.from_tag === t && e.request.call_id === n && e.request.cseq === r ) return v( 482 ), !1 } }], p = [function () { if ( o.getHeaders( "via" ).length > 1 ) return h.debug( "more than one Via header field present in the response, dropping the response" ), !1 }, function () { var e = f.str_utf8_length( o.body ), t = o.getHeader( "content-length" ); if ( e < t ) return h.debug( "message body length is lower than the value in Content-Length header field, dropping the response" ), !1 }]; function v ( e ) { var t, n, i = o.getHeaders( "via" ), u = "SIP/2.0 ".concat( e, " " ).concat( a.REASON_PHRASE[e], "\r\n" ), l = r( i ); try { for ( l.s(); !( n = l.n() ).done; ) { var c = n.value; u += "Via: ".concat( c, "\r\n" ) } } catch ( e ) { l.e( e ) } finally { l.f() } t = o.getHeader( "To" ), o.to_tag || ( t += ";tag=".concat( f.newTag() ) ), u += "To: ".concat( t, "\r\n" ), u += "From: ".concat( o.getHeader( "From" ), "\r\n" ), u += "Call-ID: ".concat( o.call_id, "\r\n" ), u += "CSeq: ".concat( o.cseq, " " ).concat( o.method, "\r\n" ), u += "\r\n", s.send( u ) } e.exports = function ( e, t, n ) { o = e, u = t, s = n; var i, l = r( d ); try { for ( l.s(); !( i = l.n() ).done; ) { if ( !1 === ( 0, i.value )() ) return !1 } } catch ( e ) { l.e( e ) } finally { l.f() } if ( o instanceof c.IncomingRequest ) { var a, f = r( _ ); try { for ( f.s(); !( a = f.n() ).done; ) { if ( !1 === ( 0, a.value )() ) return !1 } } catch ( e ) { f.e( e ) } finally { f.f() } } else if ( o instanceof c.IncomingResponse ) { var h, v = r( p ); try { for ( v.s(); !( h = v.n() ).done; ) { if ( !1 === ( 0, h.value )() ) return !1 } } catch ( e ) { v.e( e ) } finally { v.f() } } return !0 } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { var n; if ( "undefined" == typeof Symbol || null == e[Symbol.iterator] ) { if ( Array.isArray( e ) || ( n = function ( e, t ) { if ( !e ) return; if ( "string" == typeof e ) return i( e, t ); var n = Object.prototype.toString.call( e ).slice( 8, -1 ); "Object" === n && e.constructor && ( n = e.constructor.name ); if ( "Map" === n || "Set" === n ) return Array.from( e ); if ( "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test( n ) ) return i( e, t ) }( e ) ) || t && e && "number" == typeof e.length ) { n && ( e = n ); var r = 0, o = function () { }; return { s: o, n: function () { return r >= e.length ? { done: !0 } : { done: !1, value: e[r++] } }, e: function ( e ) { throw e }, f: o } } throw new TypeError( "Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method." ) } var u, s = !0, l = !1; return { s: function () { n = e[Symbol.iterator]() }, n: function () { var e = n.next(); return s = e.done, e }, e: function ( e ) { l = !0, u = e }, f: function () { try { s || null == n.return || n.return() } finally { if ( l ) throw u } } } } function i ( e, t ) { ( null == t || t > e.length ) && ( t = e.length ); for ( var n = 0, r = new Array( t ); n < t; n++ )r[n] = e[n]; return r } var o = n( 3 ), u = n( 1 ), s = n( 6 ), l = n( 9 ), a = n( 24 ), c = n( 8 ); t.settings = { authorization_user: null, password: null, realm: null, ha1: null, authorization_jwt: null, display_name: null, uri: null, contact_uri: null, instance_id: null, use_preloaded_route: !1, session_timers: !0, session_timers_refresh_method: u.UPDATE, session_timers_force_refresher: !1, no_answer_timeout: 60, register: !0, register_expires: 600, registrar_server: null, sockets: null, connection_recovery_max_interval: u.CONNECTION_RECOVERY_MAX_INTERVAL, connection_recovery_min_interval: u.CONNECTION_RECOVERY_MIN_INTERVAL, via_host: "".concat( o.createRandomToken( 12 ), ".invalid" ) }; var f = { mandatory: { sockets: function ( e ) { var t = []; if ( a.isSocket( e ) ) t.push( { socket: e } ); else { if ( !Array.isArray( e ) || !e.length ) return; var n, i = r( e ); try { for ( i.s(); !( n = i.n() ).done; ) { var o = n.value; Object.prototype.hasOwnProperty.call( o, "socket" ) && a.isSocket( o.socket ) ? t.push( o ) : a.isSocket( o ) && t.push( { socket: o } ) } } catch ( e ) { i.e( e ) } finally { i.f() } } return t }, uri: function ( e ) { /^sip:/i.test( e ) || ( e = "".concat( u.SIP, ":" ).concat( e ) ); var t = l.parse( e ); return t && t.user ? t : void 0 } }, optional: { authorization_user: function ( e ) { return -1 === s.parse( '"'.concat( e, '"' ), "quoted_string" ) ? void 0 : e }, authorization_jwt: function ( e ) { if ( "string" == typeof e ) return e }, user_agent: function ( e ) { if ( "string" == typeof e ) return e }, connection_recovery_max_interval: function ( e ) { if ( o.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, connection_recovery_min_interval: function ( e ) { if ( o.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, contact_uri: function ( e ) { if ( "string" == typeof e ) { var t = s.parse( e, "SIP_URI" ); if ( -1 !== t ) return t } }, display_name: function ( e ) { return e }, instance_id: function ( e ) { return /^uuid:/i.test( e ) && ( e = e.substr( 5 ) ), -1 === s.parse( e, "uuid" ) ? void 0 : e }, no_answer_timeout: function ( e ) { if ( o.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, session_timers: function ( e ) { if ( "boolean" == typeof e ) return e }, session_timers_refresh_method: function ( e ) { if ( "string" == typeof e && ( ( e = e.toUpperCase() ) === u.INVITE || e === u.UPDATE ) ) return e }, session_timers_force_refresher: function ( e ) { if ( "boolean" == typeof e ) return e }, password: function ( e ) { return String( e ) }, realm: function ( e ) { return String( e ) }, ha1: function ( e ) { return String( e ) }, register: function ( e ) { if ( "boolean" == typeof e ) return e }, register_expires: function ( e ) { if ( o.isDecimal( e ) ) { var t = Number( e ); if ( t > 0 ) return t } }, registrar_server: function ( e ) { /^sip:/i.test( e ) || ( e = "".concat( u.SIP, ":" ).concat( e ) ); var t = l.parse( e ); return t ? t.user ? void 0 : t : void 0 }, use_preloaded_route: function ( e ) { if ( "boolean" == typeof e ) return e } } }; t.load = function ( e, t ) { for ( var n in f.mandatory ) { if ( !t.hasOwnProperty( n ) ) throw new c.ConfigurationError( n ); var r = t[n], i = f.mandatory[n]( r ); if ( void 0 === i ) throw new c.ConfigurationError( n, r ); e[n] = i } for ( var u in f.optional ) if ( t.hasOwnProperty( u ) ) { var s = t[u]; if ( o.isEmpty( s ) ) continue; var l = f.optional[u]( s ); if ( void 0 === l ) throw new c.ConfigurationError( u, s ); e[u] = l } } }, function ( e, t, n ) { "use strict"; function r ( e, t ) { for ( var n = 0; n < t.length; n++ ) { var r = t[n]; r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && ( r.writable = !0 ), Object.defineProperty( e, r.key, r ) } } var i = n( 2 ), o = n( 6 ), u = new i( "WebSocketInterface" ); e.exports = function () { function e ( t ) { !function ( e, t ) { if ( !( e instanceof t ) ) throw new TypeError( "Cannot call a class as a function" ) }( this, e ), u.debug( 'new() [url:"%s"]', t ), this._url = t, this._sip_uri = null, this._via_transport = null, this._ws = null; var n = o.parse( t, "absoluteURI" ); if ( -1 === n ) throw u.warn( "invalid WebSocket URI: ".concat( t ) ), new TypeError( "Invalid argument: ".concat( t ) ); if ( "wss" !== n.scheme && "ws" !== n.scheme ) throw u.warn( "invalid WebSocket URI scheme: ".concat( n.scheme ) ), new TypeError( "Invalid argument: ".concat( t ) ); this._sip_uri = "sip:".concat( n.host ).concat( n.port ? ":".concat( n.port ) : "", ";transport=ws" ), this._via_transport = n.scheme.toUpperCase() } var t, n, i; return t = e, ( n = [{ key: "connect", value: function () { if ( u.debug( "connect()" ), this.isConnected() ) u.debug( "WebSocket ".concat( this._url, " is already connected" ) ); else if ( this.isConnecting() ) u.debug( "WebSocket ".concat( this._url, " is connecting" ) ); else { this._ws && this.disconnect(), u.debug( "connecting to WebSocket ".concat( this._url ) ); try { this._ws = new WebSocket( this._url, "sip" ), this._ws.binaryType = "arraybuffer", this._ws.onopen = this._onOpen.bind( this ), this._ws.onclose = this._onClose.bind( this ), this._ws.onmessage = this._onMessage.bind( this ), this._ws.onerror = this._onError.bind( this ) } catch ( e ) { this._onError( e ) } } } }, { key: "disconnect", value: function () { u.debug( "disconnect()" ), this._ws && ( this._ws.onopen = function () { }, this._ws.onclose = function () { }, this._ws.onmessage = function () { }, this._ws.onerror = function () { }, this._ws.close(), this._ws = null ) } }, { key: "send", value: function ( e ) { return u.debug( "send()" ), this.isConnected() ? ( this._ws.send( e ), !0 ) : ( u.warn( "unable to send message, WebSocket is not open" ), !1 ) } }, { key: "isConnected", value: function () { return this._ws && this._ws.readyState === this._ws.OPEN } }, { key: "isConnecting", value: function () { return this._ws && this._ws.readyState === this._ws.CONNECTING } }, { key: "_onOpen", value: function () { u.debug( "WebSocket ".concat( this._url, " connected" ) ), this.onconnect() } }, { key: "_onClose", value: function ( e ) { var t = e.wasClean, n = e.code, r = e.reason; u.debug( "WebSocket ".concat( this._url, " closed" ) ), !1 === t && u.debug( "WebSocket abrupt disconnection" ), this.ondisconnect( !t, n, r ) } }, { key: "_onMessage", value: function ( e ) { var t = e.data; u.debug( "received WebSocket message" ), this.ondata( t ) } }, { key: "_onError", value: function ( e ) { u.warn( "WebSocket ".concat( this._url, " error: " ), e ) } }, { key: "via_transport", get: function () { return this._via_transport }, set: function ( e ) { this._via_transport = e.toUpperCase() } }, { key: "sip_uri", get: function () { return this._sip_uri } }, { key: "url", get: function () { return this._url } }] ) && r( t.prototype, n ), i && r( t, i ), e }() }, function ( e ) { e.exports = JSON.parse( '{"name":"piopiyjs","title":"PIOPIY","version":"0.6.1","description":"PIOPIY javascript browser SDK","main":"index.js","directories":{"lib":"lib"},"scripts":{"test":"npm run test","build":"webpack","start":"webpack-dev-server --watch"},"repository":{"type":"git","url":"git+https://github.com/telecmi/piopiy_client_js.git"},"keywords":["piopiy","voice","sdk"],"author":"TeleCMI","license":"ISC","bugs":{"url":"https://github.com/telecmi/piopiy_client_js/issues"},"homepage":"https://github.com/telecmi/piopiy_client_js#readme","devDependencies":{"webpack":"^4.42.0","webpack-cli":"^3.3.11","webpack-dev-server":"^3.10.3"},"dependencies":{"jssip":"^3.9.0","lodash-es":"^4.17.21"}}' ) }, function ( e, t, n ) { "use strict"; n.r( t ); var r = n( 0 ), i = n.n( r ), o = n( 5 ); let u = {}; var s = Object.prototype; var l = function ( e ) { var t = e && e.constructor; return e === ( "function" == typeof t && t.prototype || s ) }; var a = function ( e, t ) { return function ( n ) { return e( t( n ) ) } }( Object.keys, Object ), c = Object.prototype.hasOwnProperty; var f = function ( e ) { if ( !l( e ) ) return a( e ); var t = []; for ( var n in Object( e ) ) c.call( e, n ) && "constructor" != n && t.push( n ); return t }, h = n( 4 ), d = h.a.Symbol, _ = Object.prototype, p = _.hasOwnProperty, v = _.toString, m = d ? d.toStringTag : void 0; var g = function ( e ) { var t = p.call( e, m ), n = e[m]; try { e[m] = void 0; var r = !0 } catch ( e ) { } var i = v.call( e ); return r && ( t ? e[m] = n : delete e[m] ), i }, y = Object.prototype.toString; var b = function ( e ) { return y.call( e ) }, T = d ? d.toStringTag : void 0; var S = function ( e ) { return null == e ? void 0 === e ? "[object Undefined]" : "[object Null]" : T && T in Object( e ) ? g( e ) : b( e ) }; var C = function ( e ) { var t = typeof e; return null != e && ( "object" == t || "function" == t ) }; var E, A = function ( e ) { if ( !C( e ) ) return !1; var t = S( e ); return "[object Function]" == t || "[object GeneratorFunction]" == t || "[object AsyncFunction]" == t || "[object Proxy]" == t }, w = h.a["__core-js_shared__"], R = ( E = /[^.]+$/.exec( w && w.keys && w.keys.IE_PROTO || "" ) ) ? "Symbol(src)_1." + E : ""; var I = function ( e ) { return !!R && R in e }, O = Function.prototype.toString; var k = function ( e ) { if ( null != e ) { try { return O.call( e ) } catch ( e ) { } try { return e + "" } catch ( e ) { } } return "" }, N = /^\[object .+?Constructor\]$/, x = Function.prototype, D = Object.prototype, P = x.toString, U = D.hasOwnProperty, j = RegExp( "^" + P.call( U ).replace( /[\\^$.*+?()[\]{}|]/g, "\\$&" ).replace( /hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?" ) + "$" ); var M = function ( e ) { return !( !C( e ) || I( e ) ) && ( A( e ) ? j : N ).test( k( e ) ) }; var q = function ( e, t ) { return null == e ? void 0 : e[t] }; var L = function ( e, t ) { var n = q( e, t ); return M( n ) ? n : void 0 }, F = L( h.a, "DataView" ), H = L( h.a, "Map" ), W = L( h.a, "Promise" ), G = L( h.a, "Set" ), B = L( h.a, "WeakMap" ), z = k( F ), V = k( H ), $ = k( W ), K = k( G ), Y = k( B ), J = S; ( F && "[object DataView]" != J( new F( new ArrayBuffer( 1 ) ) ) || H && "[object Map]" != J( new H ) || W && "[object Promise]" != J( W.resolve() ) || G && "[object Set]" != J( new G ) || B && "[object WeakMap]" != J( new B ) ) && ( J = function ( e ) { var t = S( e ), n = "[object Object]" == t ? e.constructor : void 0, r = n ? k( n ) : ""; if ( r ) switch ( r ) { case z: return "[object DataView]"; case V: return "[object Map]"; case $: return "[object Promise]"; case K: return "[object Set]"; case Y: return "[object WeakMap]" }return t } ); var X = J; var Q = function ( e ) { return null != e && "object" == typeof e }; var Z = function ( e ) { return Q( e ) && "[object Arguments]" == S( e ) }, ee = Object.prototype, te = ee.hasOwnProperty, ne = ee.propertyIsEnumerable, re = Z( function () { return arguments }() ) ? Z : function ( e ) { return Q( e ) && te.call( e, "callee" ) && !ne.call( e, "callee" ) }, ie = Array.isArray; var oe = function ( e ) { return "number" == typeof e && e > -1 && e % 1 == 0 && e <= 9007199254740991 }; var ue = function ( e ) { return null != e && oe( e.length ) && !A( e ) }, se = n( 25 ), le = {}; le["[object Float32Array]"] = le["[object Float64Array]"] = le["[object Int8Array]"] = le["[object Int16Array]"] = le["[object Int32Array]"] = le["[object Uint8Array]"] = le["[object Uint8ClampedArray]"] = le["[object Uint16Array]"] = le["[object Uint32Array]"] = !0, le["[object Arguments]"] = le["[object Array]"] = le["[object ArrayBuffer]"] = le["[object Boolean]"] = le["[object DataView]"] = le["[object Date]"] = le["[object Error]"] = le["[object Function]"] = le["[object Map]"] = le["[object Number]"] = le["[object Object]"] = le["[object RegExp]"] = le["[object Set]"] = le["[object String]"] = le["[object WeakMap]"] = !1; var ae = function ( e ) { return Q( e ) && oe( e.length ) && !!le[S( e )] }; var ce = function ( e ) { return function ( t ) { return e( t ) } }, fe = n( 16 ), he = fe.a && fe.a.isTypedArray, de = he ? ce( he ) : ae, _e = Object.prototype.hasOwnProperty; var pe = function ( e ) { if ( null == e ) return !0; if ( ue( e ) && ( ie( e ) || "string" == typeof e || "function" == typeof e.splice || Object( se.a )( e ) || de( e ) || re( e ) ) ) return !e.length; var t = X( e ); if ( "[object Map]" == t || "[object Set]" == t ) return !e.size; if ( l( e ) ) return !f( e ).length; for ( var n in e ) if ( _e.call( e, n ) ) return !1; return !0 }, ve = n( 10 ), me = n.n( ve ); let ge = {}, ye = new class { make ( e, t, n ) { i.a.isEmpty( t._sessions ) ? u = t.call( e, { mediaConstraints: { audio: !0, video: !1 }, pcConfig: { iceServers: n.ice_servers } } ) : n.emit( "error", { code: 1002, status: "already in call" } ) } invite ( e, t ) { u = e.session, "local" != e.originator && t.emit( "inComingCall", { from: e.request.from._display_name || "unknown" } ), this.initSession( u, t ) } answer ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEstablished() ? t.emit( "error", { code: 1002, status: "call already  answered" } ) : u.answer( { mediaConstraints: { audio: !0, video: !1 }, pcConfig: { iceServers: t.ice_servers } } ) } reject ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : u.terminate() } terminate ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : u.terminate() } hangup ( e, t ) { i.a.isEmpty( e.sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.bye() } terminate ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEnded() ? t.emit( "error", { code: 1002, status: "call already ended" } ) : u.terminate() } dtmf ( e, t, n ) { if ( i.a.isEmpty( t._sessions ) ) n.emit( "error", { code: 1002, status: "call not found" } ); else if ( u.isEstablished() ) { u.sendDTMF( e, { transportType: "RFC2833" } ) } else n.emit( "error", { code: 1002, status: "dtmf not allowed" } ) } hold ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEstablished() ? u.isOnHold().local ? t.emit( "error", { code: 1002, status: "call already in hold" } ) : u.hold() : t.emit( "error", { code: 1002, status: "hold not allowed" } ) } refer ( e, t, n ) { if ( i.a.isEmpty( t._sessions ) ) n.emit( "error", { code: 1002, status: "call not found" } ); else if ( u.isEstablished() ) { u.sendDTMF( "*1" + e + "#", { transportType: "RFC2833" } ) } else n.emit( "error", { code: 1002, status: "hold not allowed" } ) } merge ( e, t ) { if ( i.a.isEmpty( e._sessions ) ) t.emit( "error", { code: 1002, status: "call not found" } ); else if ( u.isEstablished() ) { u.sendDTMF( "0", { transportType: "RFC2833" } ) } else t.emit( "error", { code: 1002, status: "hold not allowed" } ) } cancel ( e, t ) { if ( i.a.isEmpty( e._sessions ) ) t.emit( "error", { code: 1002, status: "call not found" } ); else if ( u.isEstablished() ) { u.sendDTMF( "#", { transportType: "RFC2833" } ) } else t.emit( "error", { code: 1002, status: "hold not allowed" } ) } unhold ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEstablished() ? u.isOnHold().local ? u.unhold() : t.emit( "error", { code: 1002, status: "call not in hold" } ) : t.emit( "error", { code: 1002, status: "hold not allowed" } ) } mute ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEstablished() ? u.isMuted().audio ? t.emit( "error", { code: 1002, status: "call already in mute" } ) : u.mute() : t.emit( "error", { code: 1002, status: "mute not allowed" } ) } unmute ( e, t ) { i.a.isEmpty( e._sessions ) ? t.emit( "error", { code: 1002, status: "call not found" } ) : u.isEstablished() ? u.isMuted().audio ? u.unmute() : t.emit( "error", { code: 1002, status: "call not in mute" } ) : t.emit( "error", { code: 1002, status: "mute not allowed" } ) } onmute ( e, t ) { return !i.a.isEmpty( e._sessions ) && ( !!u.isEstablished() && u.isMuted().audio ) } onhold ( e, t ) { return !i.a.isEmpty( e._sessions ) && ( !!u.isEstablished() && u.isOnHold().local ) } initSession ( e, t ) { e.on( "failed", e => { "local" == e.originator ? t.emit( "hangup", { code: 200, status: "call hangup" } ) : t.emit( "ended", { code: 200, status: e.cause || "call ended" } ) } ), e._connection && ( e._connection.onaddstream = e => { if ( t.piopiyOption.autoplay && e.stream ) { var n = document.getElementById( "telecmi_audio_tag" ); n.srcObject = e.stream, n.play() } t.emit( "callStream", { code: 200, status: e.stream } ) } ), e.on( "sending", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "trying", { code: 100, status: "trying", type: n } ) } ), e.on( "peerconnection", e => { e.peerconnection.onaddstream = e => { if ( t.piopiyOption.autoplay && e.stream ) { var n = document.getElementById( "telecmi_audio_tag" ); n.srcObject = e.stream, n.play() } t.emit( "callStream", { code: 200, status: e.stream } ) } } ), e.on( "progress", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "ringing", { code: 183, status: "ringing", type: n } ) } ), e.on( "accepted", e => { if ( "local" != e.originator ) { e.originator; t.emit( "answered", { code: 200, status: "answered" } ) } } ), e.on( "confirmed", e => { if ( "local" != e.originator ) { e.originator; t.emit( "answered", { code: 200, status: "answered" } ) } } ), e.on( "getusermediafailed", e => { t.emit( "mediaFailed", { code: 200, status: e || "user media failed" } ) } ), e.on( "icecandidate", e => { "srflx" === e.candidate.type && null !== e.candidate.relatedAddress && null !== e.candidate.relatedPort && e.ready() } ), e.on( "newDTMF", e => { var n = "local" == e.originator ? "incoming" : "outgoing"; t.emit( "dtmf", { code: 200, dtmf: e.dtmf._tone, type: n } ) } ), e.on( "hold", e => { var n = "local" == e.originator ? "myself" : "other"; t.emit( "hold", { code: 200, status: "call on hold", whom: n } ) } ), e.on( "unhold", e => { var n = "local" == e.originator ? "myself" : "other"; t.emit( "unhold", { code: 200, status: "call on active", whom: n } ) } ), e.on( "ended", e => { "local" == e.originator ? t.emit( "hangup", { code: 200, status: "call hangup" } ) : t.emit( "ended", { code: 200, status: "call ended" } ) } ) } }, be = new class { start ( e ) { pe( e ) || ( pe( e._sessions ) || e.terminateSessions(), e.isRegistered() && ( e.unregister(), e.stop() ) ) } }, Te = new me.a.WebSocketInterface( "wss://sbcsg.telecmi.com" ); window.onbeforeunload = function () { be.start( ge ) }; var Se = n( 50 ); let Ce = new class { start ( e, t ) { if ( !i.a.isEmpty( ge ) ) { if ( ge.isRegistered() ) return void t.emit( "error", { code: 1001, status: "Please logout before you login" } ); ge.isConnected() && ge.stop() } !0 === e.debug ? me.a.debug.enable( "JsSIP:*" ) : me.a.debug.disable( "PIOPIY:*" ), e.region && ( Te = new me.a.WebSocketInterface( "wss://" + e.region ) ), e.sockets = [Te], e.user_agent = "PIOPIYJS", e.use_preloaded_route = !0, ge = new me.a.UA( e ), ge.on( "registered", e => { t.emit( "login", { code: 200, status: "login successfully" } ) } ), ge.on( "unregistered", e => { t.emit( "logout", { code: 200, status: "logout successfully" } ) } ), ge.on( "registrationFailed", e => { t.emit( "loginFailed", { code: 407, status: "invalid user" } ) } ), ge.on( "newRTCSession", e => { "local" != e.originator && !i.a.isEmpty( ge._sessions ) && Object.keys( ge._sessions ).length > 1 ? e.session.terminate() : ye.invite( e, t ) } ), ge.start() } stop ( e ) { if ( ge ) { if ( !ge.isRegistered() ) return void e.emit( "error", { code: 1002, status: "Please login" } ); ge.isRegistered() && ( ge.unregister(), ge.stop() ) } } make ( e, t ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.make( e, ge, t ) : t.emit( "error", { code: 1002, status: "Please login to call" } ) } refer ( e, t ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.refer( e, ge, t ) : t.emit( "error", { code: 1002, status: "Please login to call" } ) } merge ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.merge( ge, e ) : e.emit( "error", { code: 1002, status: "Please login to call" } ) } cancel ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.cancel( ge, e ) : e.emit( "error", { code: 1002, status: "Please login to call" } ) } terminate ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.terminate( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } hangup ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.hangup( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } answer ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.answer( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } reject ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.reject( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } dtmf ( e, t ) { i.a.isEmpty( ge ) || ge.isRegistered() ? !i.a.isEmpty( e ) || i.a.isNumber( e ) ? ye.dtmf( e, ge, t ) : t.emit( "error", { code: 1005, status: "invalid dtmf type " } ) : t.emit( "error", { code: 1002, status: "Please login " } ) } hold ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.hold( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } unhold ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.unhold( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } mute ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.mute( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } unmute ( e ) { i.a.isEmpty( ge ) || ge.isRegistered() ? ye.unmute( ge, e ) : e.emit( "error", { code: 1002, status: "Please login " } ) } islogedin ( e ) { return !( i.a.isEmpty( ge ) || !ge.isRegistered() ) } onmute ( e ) { if ( !i.a.isEmpty( ge ) ) return !!ge.isRegistered() && ye.onmute( ge, e ) } onhold ( e ) { if ( !i.a.isEmpty( ge ) ) return !!ge.isRegistered() && ye.onhold( ge, e ) } }, Ee = new class { audioTag () { var e = document.createElement( "AUDIO" ); e.setAttribute( "autoplay", !0 ), e.setAttribute( "hidden", !0 ), e.setAttribute( "id", "telecmi_audio_tag" ), document.body.appendChild( e ) } }; t.default = class extends o.EventEmitter { constructor( e ) { super(), this.piopiyOption = {}, this.ua = {}; let t = e || {}; o.EventEmitter.bind( this ), this.name = Se.name, this.version = Se.version, this.ice_servers = [{ urls: "stun:stunind.telecmi.com" }], this.piopiyOption.debug = !!i.a.isBoolean( t.debug ) && t.debug, this.piopiyOption.autoplay = !i.a.isBoolean( t.autoplay ) || t.autoplay, this.piopiyOption.autoReboot = !i.a.isBoolean( t.autoReboot ) || t.autoReboot, this.piopiyOption.ringTime = i.a.isNumber( t.ringTime ) ? t.ringTime : 60, this.piopiyOption.displayName = i.a.isString( t.name ) ? t.name : null, this.piopiyOption.autoplay && Ee.audioTag() } login ( e, t, n ) { let r = this, o = n || "sbcsg.telecmi.com"; if ( !i.a.isString( e ) || !i.a.isString( t ) ) throw new Error( "invalid user_id or password" ); var u = { uri: e + "@" + n, authorization_user: e, password: t, debug: this.piopiyOption.debug, display_name: this.piopiyOption.displayName, no_answer_timeout: this.piopiyOption.ringTime, register: !0, register_expires: 300, region: o, connection_recovery_min_interval: 2, connection_recovery_max_interval: 3, session_timers: !1 }; Ce.start( u, r ) } logout () { Ce.stop( this ) } call ( e ) { let t = this; i.a.isString( e ) ? Ce.make( e, t ) : t.emit( "error", { code: 1002, status: "Invalid type to call" } ) } transfer ( e ) { let t = this; i.a.isString( e ) ? Ce.refer( e, t ) : t.emit( "error", { code: 1002, status: "Invalid type to call" } ) } merge () { Ce.merge( this ) } cancel () { Ce.cancel( this ) } terminate () { Ce.terminate( this ) } answer () { Ce.answer( this ) } reject () { Ce.reject( this ) } sendDtmf ( e ) { Ce.dtmf( e, this ) } hold () { Ce.hold( this ) } unHold () { Ce.unhold( this ) } mute () { Ce.mute( this ) } unMute () { Ce.unmute( this ) } isLogedIn () { return Ce.islogedin( this ) } onHold () { return Ce.onhold( this ) } onMute () { return Ce.onmute( this ) } } }] );